function GenericObject(){this.classname="GenericObject";this.indentation=0;this.stringRepresentation="";this.matchExpression=null;this.immutableClassNames=["String","Character","Boolean","Byte","Short","Integer","Long","Float","Double"];this.immutableClasses=new Array()}GenericObject.prototype.SEMICOLON=";";GenericObject.prototype.COLON=":";GenericObject.prototype.COMMA=",";GenericObject.prototype.SLASH="/";GenericObject.prototype.SP=" ";GenericObject.prototype.EQUALS="=";GenericObject.prototype.STAR="*";GenericObject.prototype.NEWLINE="\r\n";GenericObject.prototype.RETURN="\n";GenericObject.prototype.LESS_THAN="<";GenericObject.prototype.GREATER_THAN=">";GenericObject.prototype.AT="@";GenericObject.prototype.DOT=".";GenericObject.prototype.QUESTION="?";GenericObject.prototype.POUND="#";GenericObject.prototype.AND="&";GenericObject.prototype.LPAREN="(";GenericObject.prototype.RPAREN=")";GenericObject.prototype.DOUBLE_QUOTE='"';GenericObject.prototype.QUOTE="'";GenericObject.prototype.HT="\t";GenericObject.prototype.PERCENT="%";GenericObject.prototype.setMatcher=function(a){this.matchExpression=a};GenericObject.prototype.getMatcher=function(){return this.matchExpression};GenericObject.prototype.getClassFromName=function(b){function c(d){return new Function("return new "+d)()}var a=c(b);return a};GenericObject.prototype.isMySubclass=function(a){if((typeof a)!="object"||a instanceof Array){return false}else{var b=0;if(Object.getPrototypeOf(a).classname=="GenericObject"){return true}else{O=Object.getPrototypeOf(a);for(;O.classname!=undefined;){if(Object.getPrototypeOf(O).classname=="GenericObject"){b=1;O=Object.getPrototypeOf(O)}else{O=Object.getPrototypeOf(O)}}if(b==1){return true}else{return false}}}};GenericObject.prototype.encode=function(){};GenericObject.prototype.encode=function(a){return a+this.encode()};GenericObject.prototype.equals=function(a){};GenericObject.prototype.match=function(a){};GenericObject.prototype.merge=function(a){};GenericObject.prototype.clone=function(){var b;if(this.constructor==Object){b=new this.constructor()}else{b=new this.constructor(this.valueOf())}for(var a in this){if(b[a]!=this[a]){if(typeof(this[a])=="object"){b[a]=this[a].clone()}else{b[a]=this[a]}}}b.toString=this.toString;b.valueOf=this.valueOf;return b};function GenericObjectList(){this.classname="GenericObjectList"}GenericObjectList.prototype.isMySubclass=function(a){if((typeof a)!="object"||a instanceof Array){return false}else{var b=0;if(Object.getPrototypeOf(a).classname=="GenericObjectList"){return true}else{O=Object.getPrototypeOf(a);for(;O.classname!=undefined;){if(Object.getPrototypeOf(O).classname=="GenericObjectList"){b=1;O=Object.getPrototypeOf(O)}else{O=Object.getPrototypeOf(O)}}if(b==1){return true}else{return false}}}};function NameValue(c,b,a){this.classname="NameValue";this.serialVersionUID="-1857729012596437950L";this.isQuotedString=null;this.isFlagParameter=a;this.separator=this.EQUALS;this.quotes="";this.name=c;this.value=b;if(c==null){this.name=null}if(b==null){this.value=null}if(a==null){this.isFlagParameter=false}}NameValue.prototype=new GenericObject();NameValue.prototype.constructor=NameValue;NameValue.prototype.EQUALS="=";NameValue.prototype.DOUBLE_QUOTE='"';NameValue.prototype.setSeparator=function(a){this.separator=a};NameValue.prototype.setQuotedValue=function(){this.isQuotedString=true;this.quotes=this.DOUBLE_QUOTE};NameValue.prototype.isValueQuoted=function(){return this.isQuotedString};NameValue.prototype.getName=function(){return this.name};NameValue.prototype.getValueAsObject=function(){return this.isFlagParameter?"":this.value};NameValue.prototype.setName=function(a){this.name=a};NameValue.prototype.setValueAsObject=function(a){this.value=a};NameValue.prototype.encode=function(){return this.encodeBuffer("").toString()};NameValue.prototype.encodeBuffer=function(a){var b=new GenericObject();var c=new GenericObjectList();if(this.name!=null&&this.value!=null&&!this.isFlagParameter){if(b.isMySubclass(this.value)){a=a+this.name+this.separator+this.quotes;a=this.value.encodeBuffer(a);a=a+this.quotes;return a}else{if(c.isMySubclass(this.value)){a=a+this.name+this.separator+this.value.encode();return a}else{if(this.value.toString().length==0){if(this.isQuotedString){a=a+this.name+this.separator+this.quotes+this.quotes;return a}else{if(this.name=="lr"){a=a+this.name;return a}else{a=a+this.name+this.separator;return a}}}else{a=a+this.name+this.separator+this.quotes+this.value.toString()+this.quotes;return a}}}}else{if(this.name==null&&this.value!=null){if(b.isMySubclass(this.value)){this.value.encodeBuffer(a);return a}else{if(c.isMySubclass(this.value)){a=a+this.value.encode();return a}else{a=a+this.quotes+this.value.toString()+this.quotes;return a}}}else{if(this.name!=null&&(this.value==null||this.isFlagParameter)){a=a+this.name;return a}else{return a}}}};NameValue.prototype.equals=function(a){if(a==null){return false}if(a.classname!=this.classname){return false}var b=a;if(this==b){return true}if(this.name==null&&b.name!=null||this.name!=null&&b.name==null){return false}if(this.name!=null&&b.name!=null&&this.name.compareToIgnoreCase(b.name)!=0){return false}if(this.value!=null&&b.value==null||this.value==null&&b.value!=null){return false}if(this.value==b.value){return true}if(this.value instanceof String){if(this.isQuotedString){if(this.value==b.value){return true}else{return false}}var d=this.value;var c=b.value;if(d.toLowerCase()==c.toLowerCase()){return true}else{return false}}else{if(this.value==b.value){return true}else{return false}}};NameValue.prototype.getKey=function(){return this.name};NameValue.prototype.getValue=function(){return this.value==null?null:this.value.toString()};NameValue.prototype.setValue=function(b){var a=this.value==null?null:b;this.value=b;return a};NameValue.prototype.hashCode=function(){var d=0;var a=this.encode().toLowerCase();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};function NameValueList(a){this.classname="NameValueList";this.serialVersionUID="-6998271876574260243L";this.hmap=new Array();this.separator=";"}NameValueList.prototype.setSeparator=function(a){this.separator=a};NameValueList.prototype.encode=function(){return this.encodeBuffer("").toString()};NameValueList.prototype.encodeBuffer=function(a){if(this.hmap.length!=0){for(var b=0;b<this.hmap.length;b++){var d=this.hmap[b][1];if(d instanceof GenericObject){var c=d;a=c.encodeBuffer(a)}else{a=a+d.toString()}if(b!=this.hmap.length-1){a=a+this.separator}}}return a};NameValueList.prototype.toString=function(){return this.encode()};NameValueList.prototype.set_nv=function(b){var g=0;for(var e=0;e<this.hmap.length;e++){var d=this.hmap[e][0];if(d==b.getName().toLowerCase()){g=1;var a=new Array();a[0]=d;a[1]=b;this.hmap[e]=a}}if(g==0){var f=this.hmap.length;a=new Array();a[0]=b.getName().toLowerCase();a[1]=b;this.hmap[f]=a}};NameValueList.prototype.set_name_value=function(d,g){var b=new NameValue(d,g);d=d.toLowerCase();g=b;var j=0;for(var f=0;f<this.hmap.length;f++){var e=this.hmap[f][0];if(e==d.toLowerCase()){j=1;var a=new Array();a[0]=e;a[1]=g;this.hmap[f]=a}}if(j==0){var h=this.hmap.length;a=new Array();a[0]=d.toLowerCase();a[1]=g;this.hmap[h]=a}};NameValueList.prototype.equals=function(e){if(e==null){return false}if(e.classname!=this.classname){return false}var a=e;if(this.hmap.length!=a.hmap.length){return false}var d=new Array();var h=0;for(var b=0;b<this.hmap.length;b++){d[h]=this.hmap[b][0];h++}for(b=0;b<d.length;b++){k=d[b];var g=new NameValue();var f=new NameValue();g=this.getNameValue(k);f=a.getNameValue(k);if(f==null){return false}else{if(!f.equals(g)){return false}}}return true};NameValueList.prototype.getValue=function(b){var a=new NameValue();a=this.getNameValue(b.toLowerCase());if(a!=null){return a.getValueAsObject()}else{return null}};NameValueList.prototype.getNameValue=function(b){var a=null;for(var c=0;c<this.hmap.length;c++){if(b.toLowerCase()==this.hmap[c][0]){a=this.hmap[c][1]}}return a};NameValueList.prototype.hasNameValue=function(a){var d=0;for(var b=0;b<this.hmap.length;b++){if(a.toLowerCase()==this.hmap[b][0]){d=1}}if(d==1){return true}else{return false}};NameValueList.prototype.delet=function(a){var e=0;var d=0;for(var b=0;b<this.hmap.length;b++){if(a.toLowerCase()==this.hmap[b][0]){e=1;d=b}}if(e==1){this.hmap.splice(d,1);return true}else{return false}};NameValueList.prototype.size=function(){return this.hmap.length};NameValueList.prototype.isEmpty=function(){if(this.hmap.length==0){return true}else{return false}};NameValueList.prototype.iterator=function(){return this.hmap};NameValueList.prototype.getNames=function(){var a=new Array();var b=0;for(i=0;i<this.hmap.length;i++){a[b]=this.hmap[i][0];b++}if(a.length!=0){return a}else{return null}};NameValueList.prototype.getParameter=function(a){var b=this.getValue(a);if(b==null){return null}if(b instanceof GenericObject){return b.encode()}else{return b.toString()}};NameValueList.prototype.clear=function(){this.hmap=null};NameValueList.prototype.containsKey=function(b){var d=0;for(var a=0;a<this.hmap.length;a++){if(this.hmap[a][0]==b.toString().toLowerCase()){d=1}}if(d==1){return true}else{return false}};NameValueList.prototype.containsValue=function(b){var d=0;for(var a=0;a<this.hmap.length;a++){if(this.hmap[a][1]==b){d=1}}if(d==1){return true}else{return false}};NameValueList.prototype.entrySet=function(){return this.hmap};NameValueList.prototype.get=function(b){var a=new NameValue();a=this.getNameValue(b.toString().toLowerCase());if(a!=null){return a.getValueAsObject()}else{return null}};NameValueList.prototype.keySet=function(){var a=new Array();var b=0;for(i=0;i<this.hmap.length;i++){a[b]=this.hmap[i][0];b++}return a};NameValueList.prototype.put=function(d,b){var c=new NameValue();var g=0;for(var f=0;f<this.hmap.length;f++){var e=this.hmap[f][0];if(e==d){g=1;c=this.hmap[f][1];var a=new Array();a[0]=d;a[1]=b;this.hmap[f]=a}}if(g!=0){return c}else{return null}};NameValueList.prototype.putAll=function(b){for(var a=0;a<b.length;a++){this.put(b[a][0],b[a][1])}};NameValueList.prototype.remove=function(d){var f=0;var e=0;var a=new NameValue();for(var b=0;b<this.hmap.length;b++){if(d.toString().toLowerCase()==this.hmap[b][0]){f=1;e=b}}if(f==1){a=this.hmap[e][1];this.hmap.splice(e,1);return a}else{return null}};NameValueList.prototype.values=function(){var a=new Array();var b=0;for(i=0;i<this.hmap.length;i++){a[b]=this.hmap[i][1];b++}return a};NameValueList.prototype.hashCode=function(){var d=0;var a=this.keySet();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};function DuplicateNameValueList(){this.serialVersionUID="-5611332957903796952L";this.classname="DuplicateNameValueList";this.nameValueMap=new Array();this.separator=";"}DuplicateNameValueList.prototype.setSeparator=function(a){this.separator=a};DuplicateNameValueList.prototype.encode=function(){return this.encodeBuffer("").toString()};DuplicateNameValueList.prototype.encodeBuffer=function(a){if(this.nameValueMap.length!=0){for(var c=0;c<this.nameValueMap.length;c++){var e=this.nameValueMap[c][1];for(var b=0;b<this.nameValueMap[c][1].length;b++){e=this.nameValueMap[c][1][b];if(e instanceof GenericObject){var d=e;a=d.encodeBuffer(a)}else{a=a+e.toString()}if(c!=this.nameValueMap.length-1){a=a+this.separator}}}}return a};DuplicateNameValueList.prototype.toString=function(){return this.encode()};DuplicateNameValueList.prototype.set_nv=function(f){var a=null;var b=0;for(var d=0;d<this.nameValueMap.length;d++){var j=this.nameValueMap[d][0];if(j==f.getName().toLowerCase()){a=this.nameValueMap[d][1];var l=a.length;b=1;var e=d}}if(a==null){if(b==1){a=new Array();a[0]=f;this.nameValueMap[e][1]=a}else{var g=this.nameValueMap.length;a=new Array();var h=new Array();h[0]=f.getName().toLowerCase();h[1]=a;this.nameValueMap[g]=h;l=0;e=g}}a[l]=f;this.nameValueMap[e][1]=a};DuplicateNameValueList.prototype.set_name_value=function(a,l){var g=new NameValue(a,l);var b=null;var d=0;for(var e=0;e<this.nameValueMap.length;e++){var m=this.nameValueMap[e][0];if(m==g.getName().toLowerCase()){b=this.nameValueMap[e][1];var n=b.length;d=1;var f=e}}if(b==null){if(d==1){b=new Array();b[0]=g;this.nameValueMap[f][1]=b}else{var h=this.nameValueMap.length;b=new Array();var j=new Array();j[0]=g.getName().toLowerCase();j[1]=b;this.nameValueMap[h]=j;n=0;f=h}}b[n]=g;this.nameValueMap[f][1]=b};DuplicateNameValueList.prototype.equals=function(d){if(d==null){return false}if(d.classname==this.classname){return false}var a=d;if(this.nameValueMap.length!=a.nameValueMap.length){return false}for(var c;c<this.nameValueMap.length;c++){var b=this.nameValueMap[c][0];var f=this.getNameValue(b);var e=a.nameValueMap.get(b);if(e==null){return false}else{if(e!=f){return false}}}return true};DuplicateNameValueList.prototype.getValue=function(b){var a=this.getNameValue(b.toLowerCase());if(a!=null){return a}else{return null}};DuplicateNameValueList.prototype.getNameValue=function(b){var a=new Array();for(var d=0;d<this.nameValueMap.length;d++){var c=this.nameValueMap[d][0];if(c==b){a=this.nameValueMap[d][1]}}return a};DuplicateNameValueList.prototype.hasNameValue=function(a){var d=0;for(var c=0;c<this.nameValueMap.length;c++){var b=this.nameValueMap[c][0];if(b==a.toLowerCase()){d=1}}if(d==1){return true}else{return false}};DuplicateNameValueList.prototype.delet=function(a){var e=a.toLowerCase();var d=0;var f=0;for(var c=0;c<this.nameValueMap.length;c++){var b=this.nameValueMap[c][0];if(b==e){d=1;f=c}}if(d==1){this.nameValueMap.splice(f,1);return true}else{return false}};DuplicateNameValueList.prototype.iterator=function(){return this.nameValueMap};DuplicateNameValueList.prototype.getNames=function(){var b=new Array();var d=0;for(var a=0;a<this.nameValueMap.length;a++){b[d]=this.nameValueMap[a][0];d++}if(b.length!=0){return b}else{return null}};DuplicateNameValueList.prototype.getParameter=function(b){var d=this.getValue(b);if(d==null){return null}var a="";for(var c=0;c<d.length;c++){if(d[c] instanceof GenericObject){a=a+d[c].encode()}else{a=a+d[c].toString()}if(c!=d.length-1){a=a+";  "}}return a};DuplicateNameValueList.prototype.clear=function(){this.nameValueMap=new Array()};DuplicateNameValueList.prototype.isEmpty=function(){if(this.nameValueMap.length!=0){return true}else{return false}};DuplicateNameValueList.prototype.put=function(e,f){var c=new NameValue();var g=0;for(var d=0;d<this.nameValueMap.length;d++){var b=this.nameValueMap[d][0];if(b==e){g=1;c=this.nameValueMap[d][1];var a=new Array();a[0]=e;a[1]=f;this.nameValueMap[d]=a}}if(g!=0){return c}else{return null}};DuplicateNameValueList.prototype.remove=function(d){var f=0;var e=0;var a=new NameValue();for(var b=0;b<this.nameValueMap.length;b++){if(d.toString().toLowerCase()==this.nameValueMap[b][0]){f=1;e=b}}if(f==1){a=this.nameValueMap[e][1];this.nameValueMap.splice(e,1);return a}else{return null}};DuplicateNameValueList.prototype.size=function(){var b=0;for(var a=0;a<this.nameValueMap.length;a++){b=b+this.nameValueMap[a][1].length}return b};DuplicateNameValueList.prototype.values=function(){var a=new Array();var d=0;for(var b=0;b<this.nameValueMap.length;b++){a[d]=this.nameValueMap[b][1];d++}return a};DuplicateNameValueList.prototype.hashCode=function(){var f=0;var d=new Array();var h=0;for(var b=0;b<this.nameValueMap.length;b++){d[h]=this.nameValueMap[b][0];h++}var a=d;if(!(a==null||a.value=="")){for(b=0;b<a.length;b++){f=f*31+a.charCodeAt(b);var e=2147483647;var g=-2147483648;if(f>e||f<g){f&=4294967295}}}return f};function HostPort(){this.classname="HostPort";this.serialVersionUID="-7103412227431884523L";this.port=-1;this.host=new Host()}HostPort.prototype=new GenericObject();HostPort.prototype.constructor=HostPort;HostPort.prototype.COLON=":";HostPort.prototype.encode=function(){return this.encodeBuffer("")};HostPort.prototype.encodeBuffer=function(a){a=this.host.encodeBuffer(a);if(this.port!=-1){a=a+this.COLON+this.port}return a};HostPort.prototype.equals=function(a){if(a==null){return false}if(this.classname==a.classname){return false}var b=a;if(this.port==b.port&&this.host.equals(b.host)){return true}else{return false}};HostPort.prototype.getHost=function(){return this.host};HostPort.prototype.getPort=function(){return this.port};HostPort.prototype.hasPort=function(){if(this.port!=-1){return true}else{return false}};HostPort.prototype.removePort=function(){this.port=-1};HostPort.prototype.setHost=function(a){this.host=a};HostPort.prototype.setPort=function(a){this.port=a};HostPort.prototype.getInetAddress=function(){if(this.host==null){return null}else{return this.host.getInetAddress()}};HostPort.prototype.merge=function(a){var b=new GenericObject();b.merge(a);if(this.port==-1){this.port=a.port}};HostPort.prototype.toString=function(){return this.encode()};HostPort.prototype.hashCode=function(){return this.host.hashCode()+this.port};function Host(b,a){this.serialVersionUID="-7233564517978323344L";this.stripAddressScopeZones=false;this.hostname=null;this.addressType=null;this.inetAddress=null;this.classname="Host";if(b==null&&a==null){this.addressType=this.HOSTNAME}else{if(a==null&&b!=null){this.setHost(b,this.IPV4ADDRESS)}else{this.setHost(b,a)}}}Host.prototype=new GenericObject();Host.prototype.constructor=Host;Host.prototype.HOSTNAME=1;Host.prototype.IPV4ADDRESS=2;Host.prototype.IPV6ADDRESS=3;Host.prototype.encode=function(){return this.encodeBuffer("").toString()};Host.prototype.encodeBuffer=function(a){var b=null;if(this.addressType==this.IPV6ADDRESS&&!this.isIPv6Reference(this.hostname)){b=a+"["+this.hostname+"]"}else{b=a+this.hostname}return b};Host.prototype.equals=function(b){if(b==null){return false}if(this.classname!=b.classname){return false}var a=new Host();if(a.hostname==this.hostname){return true}else{return false}};Host.prototype.getHostname=function(){return this.hostname};Host.prototype.getAddress=function(){return this.hostname};Host.prototype.getIpAddress=function(){var a=null;if(this.hostname==null){return null}if(this.addressType==this.HOSTNAME){if(this.inetAddress==null){}}else{a=this.hostname}return a};Host.prototype.setHostname=function(a){this.setHost(a,this.HOSTNAME)};Host.prototype.setHostAddress=function(a){this.setHost(a,this.IPV4ADDRESS)};Host.prototype.setHost=function(c,b){this.inetAddress=null;if(b==null){b=2}if(this.isIPv6Address(c)){this.addressType=this.IPV6ADDRESS}else{this.addressType=b}if(c!=null){this.hostname=c.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"");if(this.addressType==this.HOSTNAME){this.hostname=this.hostname.toLowerCase()}var a=-1;if(this.addressType==this.IPV6ADDRESS&&this.stripAddressScopeZones&&(a=this.hostname.indexOf("%"))!=-1){this.hostname=this.hostname.substring(0,a)}}};Host.prototype.setAddress=function(a){this.setHostAddress(a)};Host.prototype.isHostname=function(){if(this.addressType==this.HOSTNAME){return true}else{return false}};Host.prototype.isIPAddress=function(){if(this.addressType!=this.HOSTNAME){return true}else{return false}};Host.prototype.getInetAddress=function(){if(this.hostname==null){return null}if(this.inetAddress!=null){return this.inetAddress}return this.inetAddress};Host.prototype.isIPv6Address=function(a){if(a!=null&&a.indexOf(":")!=-1){return true}else{return false}};Host.prototype.isIPv6Reference=function(a){if(a.charAt(0)=="["&&a.charAt(a.length()-1)=="]"){return true}else{return false}};Host.prototype.hashCode=function(){var d=0;var a=this.getHostname();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};function Token(){this.classname="Token";this.tokenValue=null;this.tokenType=null}Token.prototype.getTokenValue=function(){return this.tokenValue};Token.prototype.getTokenType=function(){return this.tokenType};Token.prototype.toString=function(){return"tokenValue = "+this.tokenValue+"/tokenType = "+this.tokenType};function StringTokenizer(a){this.classname="StringTokenizer";this.buffer=null;this.bufferLen=null;this.ptr=null;this.savedPtr=null;if(a!=null){this.buffer=a;this.bufferLen=a.length;this.ptr=0}}StringTokenizer.prototype.nextToken=function(){var a=this.ptr;while(this.ptr<this.bufferLen){var b=this.buffer.charAt(this.ptr);this.ptr++;if(b=="\n"){break}}return this.buffer.substring(a,this.ptr)};StringTokenizer.prototype.hasMoreChars=function(){if(this.ptr<this.bufferLen&&this.buffer.charAt(this.ptr)!="\r"){return true}else{return false}};StringTokenizer.prototype.isHexDigit=function(a){if((a>="A"&&a<="F")||(a>="a"&&a<="f")||this.isDigit(a)){return true}else{return false}};StringTokenizer.prototype.isAlpha=function(a){if(a.charCodeAt(0)<=127){if((a>="a"&&a<="z")||(a>="A"&&a<="Z")){return true}else{return false}}else{if(a==a.toLowerCase()||a==a.toUpperCase()){return true}else{return false}}};StringTokenizer.prototype.isDigit=function(a){if(a.charCodeAt(0)<=127){if(a<="9"&&a>="0"){return true}else{return false}}else{if(typeof a=="number"){return true}else{return false}}};StringTokenizer.prototype.isAlphaDigit=function(a){if(a.charCodeAt(0)<=127){if((a>="a"&&a<="z")||(a>="A"&&a<="Z")||(a<="9"&&a>="0")){return true}else{return false}}else{if((a==a.toLowerCase())||(a==a.toUpperCase())||(typeof a=="number")){return true}else{return false}}};StringTokenizer.prototype.getLine=function(){var a=this.ptr;while(this.ptr<this.bufferLen&&this.buffer.charAt(this.ptr)!="\n"){this.ptr++}if(this.ptr<this.bufferLen&&this.buffer.charAt(this.ptr)=="\n"){this.ptr++}return this.buffer.substring(a,this.ptr)};StringTokenizer.prototype.peekLine=function(){var b=this.ptr;var a=this.getLine();this.ptr=b;return a};StringTokenizer.prototype.lookAhead=function(a){if(a==null){a=0}return this.buffer.charAt(this.ptr+a)};StringTokenizer.prototype.getNextChar=function(){if(this.ptr>=this.bufferLen){console.error("StringTokenizer:getNextChar(): end of buffer:"+this.ptr);throw"StringTokenizer:getNextChar(): end of buffer"}else{return this.buffer.charAt(this.ptr++)}};StringTokenizer.prototype.consume=function(a){if(a==null){this.ptr=this.savedPtr}else{this.ptr+=a}};StringTokenizer.prototype.getLines=function(){var a=new Array();while(this.hasMoreChars()){var b=this.getLine();a.push(b)}return a};StringTokenizer.prototype.getNextToken=function(c){var a=this.ptr;while(true){var b=this.lookAhead(0);if(b==c){break}else{if(b=="\0"){console.error("StringTokenizer:getNextToken(): EOL reached");throw"StringTokenizer:getNextToken(): EOL reached"}}this.consume(1)}return this.buffer.substring(a,this.ptr)};StringTokenizer.prototype.getSDPFieldName=function(a){if(a==null){return null}var c=null;var b=a.indexOf("=");c=a.substring(0,b);return c};function LexerCore(){this.classname="LexerCore";this.globalSymbolTable=new Array();this.lexerTables=new Array();this.currentLexer=null;this.currentLexerName=null;this.currentMatch=new Token();if(arguments.length==0){this.currentLexer=new Array();this.currentLexerName="charLexer"}else{var b=arguments[0];var a=arguments[1];this.buffer=a;this.bufferLen=a.length;this.ptr=0;this.currentLexer=new Array();this.currentLexerName=b}}LexerCore.prototype=new StringTokenizer();LexerCore.prototype.constructor=LexerCore;LexerCore.prototype.START=2048;LexerCore.prototype.END=LexerCore.prototype.START+2048;LexerCore.prototype.ID=LexerCore.prototype.END-1;LexerCore.prototype.SAFE=LexerCore.prototype.END-2;LexerCore.prototype.WHITESPACE=LexerCore.prototype.END+1;LexerCore.prototype.DIGIT=LexerCore.prototype.END+2;LexerCore.prototype.ALPHA=LexerCore.prototype.END+3;LexerCore.prototype.BACKSLASH="\\".charCodeAt(0);LexerCore.prototype.QUOTE="'".charCodeAt(0);LexerCore.prototype.AT="@".charCodeAt(0);LexerCore.prototype.SP=" ".charCodeAt(0);LexerCore.prototype.HT="\t".charCodeAt(0);LexerCore.prototype.COLON=":".charCodeAt(0);LexerCore.prototype.STAR="*".charCodeAt(0);LexerCore.prototype.DOLLAR="$".charCodeAt(0);LexerCore.prototype.PLUS="+".charCodeAt(0);LexerCore.prototype.POUND="#".charCodeAt(0);LexerCore.prototype.MINUS="-".charCodeAt(0);LexerCore.prototype.DOUBLEQUOTE='"'.charCodeAt(0);LexerCore.prototype.TILDE="~".charCodeAt(0);LexerCore.prototype.BACK_QUOTE="`".charCodeAt(0);LexerCore.prototype.NULL="\0".charCodeAt(0);LexerCore.prototype.EQUALS="=".charCodeAt(0);LexerCore.prototype.SEMICOLON=";".charCodeAt(0);LexerCore.prototype.SLASH="/".charCodeAt(0);LexerCore.prototype.L_SQUARE_BRACKET="[".charCodeAt(0);LexerCore.prototype.R_SQUARE_BRACKET="]".charCodeAt(0);LexerCore.prototype.R_CURLY="}".charCodeAt(0);LexerCore.prototype.L_CURLY="{".charCodeAt(0);LexerCore.prototype.HAT="^".charCodeAt(0);LexerCore.prototype.BAR="|".charCodeAt(0);LexerCore.prototype.DOT=".".charCodeAt(0);LexerCore.prototype.EXCLAMATION="!".charCodeAt(0);LexerCore.prototype.LPAREN="(".charCodeAt(0);LexerCore.prototype.RPAREN=")".charCodeAt(0);LexerCore.prototype.GREATER_THAN=">".charCodeAt(0);LexerCore.prototype.LESS_THAN="<".charCodeAt(0);LexerCore.prototype.PERCENT="%".charCodeAt(0);LexerCore.prototype.QUESTION="?".charCodeAt(0);LexerCore.prototype.AND="&".charCodeAt(0);LexerCore.prototype.UNDERSCORE="_".charCodeAt(0);LexerCore.prototype.ALPHA_VALID_CHARS=String.fromCharCode(65535);LexerCore.prototype.DIGIT_VALID_CHARS=String.fromCharCode(65534);LexerCore.prototype.ALPHADIGIT_VALID_CHARS=String.fromCharCode(65533);LexerCore.prototype.addKeyword=function(b,d){var e=d;this.currentLexer=this.put(this.currentLexer,b,e);var a=null;for(var c=0;c<this.globalSymbolTable.length;c++){if(this.globalSymbolTable[c]==e){a=0}}if(a==null){this.globalSymbolTable=this.put(this.globalSymbolTable,e,b)}};LexerCore.prototype.lookupToken=function(c){var a=null;if(c>this.START){for(var b=0;b<this.globalSymbolTable.length;b++){if(this.globalSymbolTable[b][0]==c){a=this.globalSymbolTable[b][1]}}return a}else{return c}};LexerCore.prototype.addLexer=function(c){var a=null;for(var b=0;b<this.lexerTables.length;b++){if(this.lexerTables[b][0]==c){a=this.lexerTables[b][1]}}this.currentLexer=a;if(this.currentLexer==null){this.currentLexer=new Array();this.lexerTables=this.put(this.lexerTables,c,this.currentLexer)}return this.currentLexer};LexerCore.prototype.selectLexer=function(a){this.currentLexerName=a};LexerCore.prototype.peekNextId=function(){var b=this.ptr;var a=this.ttoken();this.savedPtr=this.ptr;this.ptr=b;return a};LexerCore.prototype.getNextId=function(){return this.ttoken()};LexerCore.prototype.getNextToken=function(){if(arguments.length!=0){var c=arguments[0];var a=this.ptr;while(true){var b=this.lookAhead(0);if(b==c){break}else{if(b=="\0"){console.error("LexerCore:getNextToken(): EOL reached");throw"LexerCore:getNextToken(): EOL reached"}}this.consume(1)}return this.buffer.substring(a,this.ptr)}else{return this.currentMatch}};LexerCore.prototype.peekNextToken=function(m){if(m==null){m=1;return this.peekNextToken(m)[0]}else{var e=this.ptr;var c=new Array();for(var h=0;h<m;h++){var p=new Token();if(this.startsId()){var b=this.ttoken();p.tokenValue=b;var a=b.toUpperCase();var g=null;for(var f=0;f<this.currentLexer.length;f++){if(this.currentLexer[f][0]==a){g=f}}if(g!=null){var n=this.currentLexer[g][1];p.tokenType=n}else{p.tokenType=this.ID}}else{var d=this.getNextChar();p.tokenValue=d;if(this.isAlpha(d)){p.tokenType=this.ALPHA}else{if(this.isDigit(d)){p.tokenType=this.DIGIT}else{p.tokenType=d}}}c[h]=p}this.savedPtr=this.ptr;this.ptr=e;return c}};LexerCore.prototype.match=function(b){if(b>this.START&&b<this.END){if(b==this.ID){if(!this.startsId()){console.error("LexerCore:match(): "+this.buffer+"\nID expected",this.ptr);throw"LexerCore:match(): ID expected"}var h=this.getNextId();this.currentMatch=new Token();this.currentMatch.tokenValue=h;this.currentMatch.tokenType=this.ID}else{if(b==this.SAFE){if(!this.startsSafeToken()){console.error("LexerCore:match(): "+this.buffer+"\nID expected",this.ptr);throw"LexerCore:match(): ID expected"}h=this.ttokenSafe();this.currentMatch=new Token();this.currentMatch.tokenValue=h;this.currentMatch.tokenType=this.SAFE}else{var a=this.getNextId();var g=null;for(var c=0;c<this.currentLexer.length;c++){if(this.currentLexer[c][0]==a.toUpperCase()){g=c}}if(g==null){var f=null}else{f=this.currentLexer[g][1]}if(f==null||f!=b){console.error("LexerCore:match(): "+this.buffer+"\nUnexpected Token : "+a);throw"LexerCore:match(): unexpected Token"}this.currentMatch=new Token();this.currentMatch.tokenValue=a;this.currentMatch.tokenType=b}}}else{if(b>this.END){var e=this.lookAhead(0);if(b==this.DIGIT){if(!this.isDigit(e)){console.error("LexerCore:match(): "+this.buffer+"\nExpecting DIGIT",this.ptr);throw"LexerCore:match(): Expecting DIGIT"}this.currentMatch=new Token();this.currentMatch.tokenValue=e;this.currentMatch.tokenType=b;this.consume(1)}else{if(b==this.ALPHA){if(!this.isAlpha(e)){console.error("LexerCore:match(): "+this.buffer+"\nExpecting ALPHA",this.ptr);throw"LexerCore:match(): Expecting ALPHA"}this.currentMatch=new Token();this.currentMatch.tokenValue=e;this.currentMatch.tokenType=b;this.consume(1)}}}else{var d=b;e=this.lookAhead(0);if(e==d){this.consume(1)}else{console.error("LexerCore:match(): "+this.buffer+"\nExpecting  >>>"+d+"<<< got >>>"+e+"<<<");throw"LexerCore:match(): expecting  >>>"+d+"<<< got >>>"+e+"<<<"}}}return this.currentMatch};LexerCore.prototype.SPorHT=function(){var a=this.lookAhead(0);while(a==" "||a=="\t"){this.consume(1);a=this.lookAhead(0)}};LexerCore.prototype.isTokenChar=function(a){if(this.isAlphaDigit(a)){return true}else{switch(a){case"-":case".":case"!":case"%":case"*":case"_":case"+":case"`":case"'":case"~":return true;default:return false}}};LexerCore.prototype.startsId=function(){var a=this.lookAhead(0);return this.isTokenChar(a)};LexerCore.prototype.startsSafeToken=function(){var a=lookAhead(0);if(this.isAlphaDigit(a)){return true}else{switch(a){case"_":case"+":case"-":case"!":case"`":case"'":case".":case"/":case"}":case"{":case"]":case"[":case"^":case"|":case"~":case"%":case"#":case"@":case"$":case":":case";":case"?":case'"':case"*":case"=":return true;default:return false}}};LexerCore.prototype.ttoken=function(){var a=this.ptr;while(this.hasMoreChars()){var b=this.lookAhead(0);if(this.isTokenChar(b)){this.consume(1)}else{break}}return this.buffer.substring(a,this.ptr)};LexerCore.prototype.ttokenSafe=function(){var a=this.ptr;while(this.hasMoreChars()){var c=this.lookAhead(0);if(this.isAlphaDigit(c)){this.consume(1)}else{var b=false;switch(c){case"_":case"+":case"-":case"!":case"`":case"'":case".":case"/":case"}":case"{":case"]":case"[":case"^":case"|":case"~":case"%":case"#":case"@":case"$":case":":case";":case"?":case'"':case"*":b=true}if(b){this.consume(1)}else{break}}}return this.buffer.substring(a,this.ptr)};LexerCore.prototype.consumeValidChars=function(a){var d=a.length;while(this.hasMoreChars()){var f=this.lookAhead(0);var e=false;for(var c=0;c<d;c++){var b=a[c];switch(b){case this.ALPHA_VALID_CHARS:e=this.isAlpha(f);break;case this.DIGIT_VALID_CHARS:e=this.isDigit(f);break;case this.ALPHADIGIT_VALID_CHARS:e=this.isAlphaDigit(f);break;default:e=f==b}if(e){break}}if(e){this.consume(1)}else{break}}};LexerCore.prototype.quotedString=function(){var a=this.ptr+1;if(this.lookAhead(0)!='"'){return null}this.consume(1);while(true){var b=this.getNextChar();if(b=='"'){break}else{if(b=="\0"){console.error("LexerCore:quotedString(): "+this.buffer+" :unexpected EOL",this.ptr);throw"LexerCore:quotedString(): unexpected EOL"}else{if(b=="\\"){this.consume(1)}}}}return this.buffer.substring(a,this.ptr-1)};LexerCore.prototype.comment=function(){var a="";if(this.lookAhead(0)!="("){return null}this.consume(1);while(true){var b=this.getNextChar();if(b==")"){break}else{if(b=="\0"){console.error("LexerCore:comment(): "+this.buffer+" :unexpected EOL",this.ptr);throw"LexerCore:comment(): unexpected EOL"}else{if(b=="\\"){a=a+b;b=this.getNextChar();if(b=="\0"){console.error("LexerCore:comment(): "+this.buffer+" :unexpected EOL",this.ptr);throw"LexerCore:comment(): unexpected EOL"}a=a+b}else{a=a+b}}}}return a.toString()};LexerCore.prototype.byteStringNoSemicolon=function(){var a="";while(true){var b=this.lookAhead(0);if(b=="\0"||b=="\n"||b==";"||b==","){break}else{this.consume(1);a=a+b}}return a.toString()};LexerCore.prototype.byteStringNoWhiteSpace=function(){var a="";while(true){var b=this.lookAhead(0);if(b=="\0"||b=="\n"||b==" "){break}else{this.consume(1);a=a+b}}return a.toString()};LexerCore.prototype.byteStringNoSlash=function(){var a="";while(true){var b=this.lookAhead(0);if(b=="\0"||b=="\n"||b=="/"){break}else{this.consume(1);a=a+b}}return a.toString()};LexerCore.prototype.byteStringNoComma=function(){var a="";while(true){var b=this.lookAhead(0);if(b=="\n"||b==","){break}else{this.consume(1);a=a+b}}return a.toString()};LexerCore.prototype.charAsString=function(){if(typeof arguments[0]=="string"){var a=arguments[0];return a}else{if(typeof arguments[0]=="number"){var b=arguments[0];return this.buffer.substring(this.ptr,this.ptr+b)}}};LexerCore.prototype.number=function(){var a=this.ptr;if(!this.isDigit(this.lookAhead(0))){console.error(this.buffer+"LexerCore:number(): Unexpected token at "+this.lookAhead(0),this.ptr);throw"LexerCore:number(): Unexpected token at "+this.lookAhead(0)}this.consume(1);while(true){var b=this.lookAhead(0);if(this.isDigit(b)){this.consume(1)}else{break}}return this.buffer.substring(a,this.ptr)};LexerCore.prototype.markInputPosition=function(){return this.ptr};LexerCore.prototype.rewindInputPosition=function(a){this.ptr=a};LexerCore.prototype.getRest=function(){if(this.ptr>=this.buffer.length){return null}else{return this.buffer.substring(this.ptr)}};LexerCore.prototype.getString=function(e){var b="";while(true){var d=this.lookAhead(0);if(d=="\0"){console.error(this.buffer+"LexerCore:getString(): unexpected EOL",this.ptr);throw"LexerCore:getString(): unexpected EOL"}else{if(d==e){this.consume(1);break}else{if(d=="\\"){this.consume(1);var a=this.lookAhead(0);if(a=="\0"){console.error(this.buffer+"LexerCore:getString(): unexpected EOL",this.ptr);throw"LexerCore:getString(): unexpected EOL"}else{this.consume(1);b=b+a}}else{this.consume(1);b=b+d}}}}return b.toString()};LexerCore.prototype.getPtr=function(){return this.ptr};LexerCore.prototype.getBuffer=function(){return this.buffer};LexerCore.prototype.put=function(e,b,f){var g=0;for(var d=0;d<e.length;d++){var c=e[d][0];if(c==b){g=1;var a=new Array();a[0]=c;a[1]=f;e[d]=a}}if(g==0){a=new Array();a[0]=b;a[1]=f;e.push(a)}return e};function ParserCore(){this.classname="ParserCore";this.nesting_level=null;this.lexer=new LexerCore()}ParserCore.prototype.nameValue=function(e){if(e==null){var f=this.nameValue("=");return f}else{this.lexer.match(LexerCore.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();try{var d=false;var b=this.lexer.lookAhead(0);if(b==e){this.lexer.consume(1);this.lexer.SPorHT();var h=null;var c=false;if(this.lexer.lookAhead(0)=='"'){h=this.lexer.quotedString();d=true}else{this.lexer.match(LexerCore.prototype.ID);var j=this.lexer.getNextToken();h=j.tokenValue;if(h==null){h="";c=true}}var f=new NameValue(a.tokenValue,h,c);if(d){f.setQuotedValue()}return f}else{f=new NameValue(a.tokenValue,"",true);return f}}catch(g){console.error("ParserCore:nameValue(): catched exception:"+g);f=new NameValue(a.tokenValue,null,false);return f}}return f};function HostNameParser(){this.classname="HostNameParser";this.Lexer=null;this.stripAddressScopeZones=false;if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new LexerCore("charLexer",a)}else{if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("charLexer")}}}HostNameParser.prototype=new ParserCore();HostNameParser.prototype.constructor=HostNameParser;HostNameParser.prototype.VALID_DOMAIN_LABEL_CHAR=[LexerCore.prototype.ALPHADIGIT_VALID_CHARS,"-","."];HostNameParser.prototype.consumeDomainLabel=function(){this.lexer.consumeValidChars(this.VALID_DOMAIN_LABEL_CHAR)};HostNameParser.prototype.ipv6Reference=function(){};HostNameParser.prototype.host=function(){var a;if(this.lexer.lookAhead(0)=="["){a=this.ipv6Reference()}else{var b=this.lexer.getPtr();this.consumeDomainLabel();a=this.lexer.getBuffer().substring(b,this.lexer.getPtr())}if(a.length==0){console.error("Parser:host():"+this.lexer.getBuffer()+" missing host name",this.lexer.getPtr());throw"Parser:host(): Missing host name"}else{return new Host(a)}};HostNameParser.prototype.isIPv6Address=function(){};HostNameParser.prototype.hostPort=function(f){var c=this.host();var d=new HostPort();d.setHost(c);if(f){this.lexer.SPorHT()}if(this.lexer.hasMoreChars()){var e=this.lexer.lookAhead(0);switch(e){case":":this.lexer.consume(1);if(f){this.lexer.SPorHT()}try{var a=this.lexer.number();d.setPort(a)}catch(b){console.error("Parser:hostPort():"+this.lexer.getBuffer()+" : error parsing port ",this.lexer.getPtr());throw"Parser:hostPort(): error parsing port"}break;case",":case";":case"?":case">":case" ":case"\t":case"\r":case"\n":case"/":break;case"%":if(this.stripAddressScopeZones){break}default:if(!f){console.error("Parser:hostPort(): "+this.lexer.getBuffer()+" illegal character in hostname:"+this.lexer.lookAhead(0),this.lexer.getPtr());throw"Parser:hostPort(): error parsing port"}}}return d};function MessageDigestAlgorithm(){this.classname="MessageDigestAlgorithm";this.toHex=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];this.hexcase=0}MessageDigestAlgorithm.prototype.calculateResponse=function(f,e,b,g,m,p,a,l,h,j){var d=null;d=f+":"+e+":"+b;var c=null;if(j==null||j.length==0||j=="auth"){c=a+":"+l}else{if(h==null){h=""}c=a+":"+l+":"+this.H(h)}var n=null;if(p!=null&&j!=null&&m!=null&&(j=="auth"||j=="auth-int")){n=this.KD(this.H(d),g+":"+m+":"+p+":"+j+":"+this.H(c))}else{n=this.KD(this.H(d),g+":"+this.H(c))}return n};MessageDigestAlgorithm.prototype.H=function(a){return this.md5(a)};MessageDigestAlgorithm.prototype.KD=function(a,b){return this.H(a+":"+b)};MessageDigestAlgorithm.prototype.toHexString=function(d){var g=0;var a="";var f=new Array();for(var e=0;e<d.length;e++){f[g++]=this.toHex[(d[e]>>4)&15];a=a+f[g];f[g++]=this.toHex[d[e]&15];a=a+f[g]}return a};MessageDigestAlgorithm.prototype.md5=function(a){return this.hex_md5(a)};MessageDigestAlgorithm.prototype.hex_md5=function(a){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(a)))};MessageDigestAlgorithm.prototype.rstr_md5=function(a){return this.binl2rstr(this.binl_md5(this.rstr2binl(a),a.length*8))};MessageDigestAlgorithm.prototype.rstr2hex=function(c){var e=this.hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=e.charAt((a>>>4)&15)+e.charAt(a&15)}return b};MessageDigestAlgorithm.prototype.str2rstr_utf8=function(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b};MessageDigestAlgorithm.prototype.rstr2binl=function(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a};MessageDigestAlgorithm.prototype.binl2rstr=function(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a};MessageDigestAlgorithm.prototype.binl_md5=function(r,l){r[l>>5]|=128<<((l)%32);r[(((l+64)>>>9)<<4)+14]=l;var q=1732584193;var p=-271733879;var n=-1732584194;var m=271733878;for(var g=0;g<r.length;g+=16){var j=q;var h=p;var f=n;var e=m;q=this.md5_ff(q,p,n,m,r[g+0],7,-680876936);m=this.md5_ff(m,q,p,n,r[g+1],12,-389564586);n=this.md5_ff(n,m,q,p,r[g+2],17,606105819);p=this.md5_ff(p,n,m,q,r[g+3],22,-1044525330);q=this.md5_ff(q,p,n,m,r[g+4],7,-176418897);m=this.md5_ff(m,q,p,n,r[g+5],12,1200080426);n=this.md5_ff(n,m,q,p,r[g+6],17,-1473231341);p=this.md5_ff(p,n,m,q,r[g+7],22,-45705983);q=this.md5_ff(q,p,n,m,r[g+8],7,1770035416);m=this.md5_ff(m,q,p,n,r[g+9],12,-1958414417);n=this.md5_ff(n,m,q,p,r[g+10],17,-42063);p=this.md5_ff(p,n,m,q,r[g+11],22,-1990404162);q=this.md5_ff(q,p,n,m,r[g+12],7,1804603682);m=this.md5_ff(m,q,p,n,r[g+13],12,-40341101);n=this.md5_ff(n,m,q,p,r[g+14],17,-1502002290);p=this.md5_ff(p,n,m,q,r[g+15],22,1236535329);q=this.md5_gg(q,p,n,m,r[g+1],5,-165796510);m=this.md5_gg(m,q,p,n,r[g+6],9,-1069501632);n=this.md5_gg(n,m,q,p,r[g+11],14,643717713);p=this.md5_gg(p,n,m,q,r[g+0],20,-373897302);q=this.md5_gg(q,p,n,m,r[g+5],5,-701558691);m=this.md5_gg(m,q,p,n,r[g+10],9,38016083);n=this.md5_gg(n,m,q,p,r[g+15],14,-660478335);p=this.md5_gg(p,n,m,q,r[g+4],20,-405537848);q=this.md5_gg(q,p,n,m,r[g+9],5,568446438);m=this.md5_gg(m,q,p,n,r[g+14],9,-1019803690);n=this.md5_gg(n,m,q,p,r[g+3],14,-187363961);p=this.md5_gg(p,n,m,q,r[g+8],20,1163531501);q=this.md5_gg(q,p,n,m,r[g+13],5,-1444681467);m=this.md5_gg(m,q,p,n,r[g+2],9,-51403784);n=this.md5_gg(n,m,q,p,r[g+7],14,1735328473);p=this.md5_gg(p,n,m,q,r[g+12],20,-1926607734);q=this.md5_hh(q,p,n,m,r[g+5],4,-378558);m=this.md5_hh(m,q,p,n,r[g+8],11,-2022574463);n=this.md5_hh(n,m,q,p,r[g+11],16,1839030562);p=this.md5_hh(p,n,m,q,r[g+14],23,-35309556);q=this.md5_hh(q,p,n,m,r[g+1],4,-1530992060);m=this.md5_hh(m,q,p,n,r[g+4],11,1272893353);n=this.md5_hh(n,m,q,p,r[g+7],16,-155497632);p=this.md5_hh(p,n,m,q,r[g+10],23,-1094730640);q=this.md5_hh(q,p,n,m,r[g+13],4,681279174);m=this.md5_hh(m,q,p,n,r[g+0],11,-358537222);n=this.md5_hh(n,m,q,p,r[g+3],16,-722521979);p=this.md5_hh(p,n,m,q,r[g+6],23,76029189);q=this.md5_hh(q,p,n,m,r[g+9],4,-640364487);m=this.md5_hh(m,q,p,n,r[g+12],11,-421815835);n=this.md5_hh(n,m,q,p,r[g+15],16,530742520);p=this.md5_hh(p,n,m,q,r[g+2],23,-995338651);q=this.md5_ii(q,p,n,m,r[g+0],6,-198630844);m=this.md5_ii(m,q,p,n,r[g+7],10,1126891415);n=this.md5_ii(n,m,q,p,r[g+14],15,-1416354905);p=this.md5_ii(p,n,m,q,r[g+5],21,-57434055);q=this.md5_ii(q,p,n,m,r[g+12],6,1700485571);m=this.md5_ii(m,q,p,n,r[g+3],10,-1894986606);n=this.md5_ii(n,m,q,p,r[g+10],15,-1051523);p=this.md5_ii(p,n,m,q,r[g+1],21,-2054922799);q=this.md5_ii(q,p,n,m,r[g+8],6,1873313359);m=this.md5_ii(m,q,p,n,r[g+15],10,-30611744);n=this.md5_ii(n,m,q,p,r[g+6],15,-1560198380);p=this.md5_ii(p,n,m,q,r[g+13],21,1309151649);q=this.md5_ii(q,p,n,m,r[g+4],6,-145523070);m=this.md5_ii(m,q,p,n,r[g+11],10,-1120210379);n=this.md5_ii(n,m,q,p,r[g+2],15,718787259);p=this.md5_ii(p,n,m,q,r[g+9],21,-343485551);q=this.safe_add(q,j);p=this.safe_add(p,h);n=this.safe_add(n,f);m=this.safe_add(m,e)}return Array(q,p,n,m)};MessageDigestAlgorithm.prototype.md5_cmn=function(h,e,d,c,g,f){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,h),this.safe_add(c,f)),g),d)};MessageDigestAlgorithm.prototype.md5_ff=function(g,f,m,l,e,j,h){return this.md5_cmn((f&m)|((~f)&l),g,f,e,j,h)};MessageDigestAlgorithm.prototype.md5_gg=function(g,f,m,l,e,j,h){return this.md5_cmn((f&l)|(m&(~l)),g,f,e,j,h)};MessageDigestAlgorithm.prototype.md5_hh=function(g,f,m,l,e,j,h){return this.md5_cmn(f^m^l,g,f,e,j,h)};MessageDigestAlgorithm.prototype.md5_ii=function(g,f,m,l,e,j,h){return this.md5_cmn(m^(f|(~l)),g,f,e,j,h)};MessageDigestAlgorithm.prototype.safe_add=function(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)};MessageDigestAlgorithm.prototype.bit_rol=function(a,b){return(a<<b)|(a>>>(32-b))};function GenericURI(b){this.classname="GenericURI";this.serialVersionUID="3237685256878068790L";this.uriString=null;this.scheme=null;if(b!=null){this.uriString=b;var a=b.indexOf(":");this.scheme=b.substring(0,a)}}GenericURI.prototype.SIP="sip";GenericURI.prototype.SIPS="sips";GenericURI.prototype.POSTDIAL="postdial";GenericURI.prototype.PHONE_CONTEXT_TAG="context-tag";GenericURI.prototype.ISUB="isub";GenericURI.prototype.PROVIDER_TAG="provider-tag";GenericURI.prototype.TEL="tel";GenericURI.prototype.encode=function(){return this.uriString};GenericURI.prototype.encodeBuffer=function(a){a=a+this.uriString;return a};GenericURI.prototype.toString=function(){return this.encode()};GenericURI.prototype.getScheme=function(){return this.scheme};GenericURI.prototype.isSipURI=function(){if(this instanceof SipUri){return true}else{return false}};GenericURI.prototype.equals=function(a){if(this==a){return true}else{if(a instanceof URI){var b=a;if(this.toString().toLowerCase()==b.toString().toLowerCase()){return true}else{return false}}}return false};GenericURI.prototype.hashCode=function(){var d=0;var a=this.toString();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};function UserInfo(){this.serialVersionUID="7268593273924256144L";this.user=null;this.password=null;this.userType=null;this.classname="UserInfo"}UserInfo.prototype.TELEPHONE_SUBSCRIBER=1;UserInfo.prototype.USER=2;UserInfo.prototype.COLON=":";UserInfo.prototype.POUND="#";UserInfo.prototype.SEMICOLON=";";UserInfo.prototype.equals=function(b){if(b.classname!="UserInfo"){return false}var a=new UserInfo();a=b;if(this.userType!=a.userType){return false}if(this.user!=a.user){return false}if(this.password!=null&&a.password==null){return false}if(a.password!=null&&this.password==null){return false}return this.password==a.password};UserInfo.prototype.encode=function(){return this.encodeBuffer("").toString()};UserInfo.prototype.encodeBuffer=function(a){var b=null;if(this.password!=null){b=a+this.user+this.COLON+this.password}else{b=a+this.user}return b};UserInfo.prototype.clearPassword=function(){this.password=null};UserInfo.prototype.getUserType=function(){return this.userType};UserInfo.prototype.getUser=function(){return this.user};UserInfo.prototype.setUser=function(a){this.user=a;if(a!=null&&(a.indexOf(this.POUND)>=0||a.indexOf(this.SEMICOLON)>=0)){this.setUserType(this.TELEPHONE_SUBSCRIBER)}else{this.setUserType(this.USER)}};UserInfo.prototype.getPassword=function(){return this.password};UserInfo.prototype.setPassword=function(a){this.password=a};UserInfo.prototype.setUserType=function(a){if(a!=this.USER&&a!=this.TELEPHONE_SUBSCRIBER){console.error("UserInfo:setUserType(): parameter not in range");throw"UserInfo:setUserType(): parameter not in range"}this.userType=a};function Authority(){this.classname="Authority";this.serialVersionUID="-3570349777347017894L";this.userInfo=null;this.hostPort=new HostPort()}Authority.prototype.AT="@";Authority.prototype.encode=function(){return this.encodeBuffer("")};Authority.prototype.encodeBuffer=function(a){if(this.userInfo!=null){a=this.userInfo.encodeBuffer(a);a=a+this.AT;a=this.hostPort.encodeBuffer(a)}else{a=this.hostPort.encodeBuffer(a)}return a};Authority.prototype.equals=function(a){if(a==null){return false}if(a.classname!=this.classname){return false}var b=a;if(this.hostPort!=b.hostPort){return false}if(this.userInfo!=null&&b.userInfo!=null){if(this.userInfo!=b.userInfo){return false}}return true};Authority.prototype.getHostPort=function(){return this.hostPort};Authority.prototype.getUserInfo=function(){return this.userInfo};Authority.prototype.getPassword=function(){if(this.userInfo==null){return null}else{return this.userInfo.password}};Authority.prototype.getUser=function(){return this.userInfo!=null?this.userInfo.user:null};Authority.prototype.getHost=function(){if(this.hostPort==null){return null}else{return this.hostPort.getHost()}};Authority.prototype.getPort=function(){if(this.hostPort==null){return -1}else{return this.hostPort.getPort()}};Authority.prototype.removePort=function(){if(this.hostPort!=null){this.hostPort.removePort()}};Authority.prototype.setPassword=function(a){if(this.userInfo==null){this.userInfo=new UserInfo()}this.userInfo.setPassword(a)};Authority.prototype.setUser=function(a){if(this.userInfo==null){this.userInfo=new UserInfo()}this.userInfo.setUser(a)};Authority.prototype.setHost=function(a){if(this.hostPort==null){this.hostPort=new HostPort()}this.hostPort.setHost(a)};Authority.prototype.setPort=function(a){if(this.hostPort==null){this.hostPort=new HostPort()}this.hostPort.setPort(a)};Authority.prototype.setHostPort=function(a){this.hostPort=a};Authority.prototype.setUserInfo=function(a){this.userInfo=a};Authority.prototype.removeUserInfo=function(){this.userInfo=null};Authority.prototype.hashCode=function(){if(this.hostPort==null){console.error("Authority:hashCode(): null hostPort cannot compute hashcode");throw"Authority:hashCode(): null hostPort cannot compute hashcode"}return this.hostPort.encode().hashCode()};function TelURLImpl(){this.serialVersionUID="5873527320305915954L";this.classname="TelURLImpl";this.telephoneNumber=new TelephoneNumber();this.scheme="tel"}TelURLImpl.prototype=new GenericURI();TelURLImpl.prototype.constructor=TelURLImpl;TelURLImpl.prototype.setTelephoneNumber=function(a){this.telephoneNumber=a};TelURLImpl.prototype.getIsdnSubAddress=function(){return this.telephoneNumber.getIsdnSubaddress()};TelURLImpl.prototype.getPostDial=function(){return this.telephoneNumber.getPostDial()};TelURLImpl.prototype.getScheme=function(){return this.scheme};TelURLImpl.prototype.isGlobal=function(){return this.telephoneNumber.isGlobal()};TelURLImpl.prototype.isSipURI=function(){return false};TelURLImpl.prototype.setGlobal=function(a){this.telephoneNumber.setGlobal(a)};TelURLImpl.prototype.setIsdnSubAddress=function(a){this.telephoneNumber.setIsdnSubaddress(a)};TelURLImpl.prototype.setPostDial=function(a){this.telephoneNumber.setPostDial(a)};TelURLImpl.prototype.setPhoneNumber=function(a){this.telephoneNumber.setPhoneNumber(a)};TelURLImpl.prototype.getPhoneNumber=function(){return this.telephoneNumber.getPhoneNumber()};TelURLImpl.prototype.toString=function(){return this.scheme+":"+this.telephoneNumber.encode()};TelURLImpl.prototype.encode=function(){return this.encodeBuffer("").toString()};TelURLImpl.prototype.encodeBuffer=function(a){a=a+this.scheme+":";a=this.telephoneNumber.encodeBuffer(a);return a};TelURLImpl.prototype.getParameter=function(a){return this.telephoneNumber.getParameter(a)};TelURLImpl.prototype.setParameter=function(a,b){this.telephoneNumber.setParameter(a,b)};TelURLImpl.prototype.getParameterNames=function(){return this.telephoneNumber.getParameterNames()};TelURLImpl.prototype.getParameters=function(){return this.telephoneNumber.getParameters()};TelURLImpl.prototype.removeParameter=function(a){this.telephoneNumber.removeParameter(a)};TelURLImpl.prototype.setPhoneContext=function(a){if(a==null){this.removeParameter("phone-context")}else{this.setParameter("phone-context",a)}};TelURLImpl.prototype.getPhoneContext=function(){return this.getParameter("phone-context")};function TelephoneNumber(){this.classname="TelephoneNumber";this.isglobal=null;this.phoneNumber=null;this.parameters=new NameValueList()}TelephoneNumber.prototype.POSTDIAL="postdial";TelephoneNumber.prototype.PHONE_CONTEXT_TAG="context-tag";TelephoneNumber.prototype.ISUB="isub";TelephoneNumber.prototype.PROVIDER_TAG="provider-tag";TelephoneNumber.prototype.SEMICOLON=";";TelephoneNumber.prototype.deleteParm=function(a){this.parameters.delet(a)};TelephoneNumber.prototype.getPhoneNumber=function(){return this.phoneNumber};TelephoneNumber.prototype.getPostDial=function(){return this.parameters.getValue(this.POSTDIAL)};TelephoneNumber.prototype.getIsdnSubaddress=function(){return this.parameters.getValue(this.ISUB)};TelephoneNumber.prototype.hasPostDial=function(){if(this.parameters.getValue(this.POSTDIAL)!=null){return true}else{return false}};TelephoneNumber.prototype.hasParm=function(a){if(this.parameters.hasNameValue(a)){return true}else{return false}};TelephoneNumber.prototype.hasIsdnSubaddress=function(){if(this.hasParm(this.ISUB)){return true}else{return false}};TelephoneNumber.prototype.isGlobal=function(){return this.isglobal};TelephoneNumber.prototype.removePostDial=function(){this.parameters.delet(this.POSTDIAL)};TelephoneNumber.prototype.removeIsdnSubaddress=function(){this.deleteParm(this.ISUB)};TelephoneNumber.prototype.setParameters=function(a){this.parameters=a};TelephoneNumber.prototype.setGlobal=function(a){this.isglobal=a};TelephoneNumber.prototype.setPostDial=function(b){var a=new NameValue(this.POSTDIAL,b);this.parameters.set_nv(a)};TelephoneNumber.prototype.setParm=function(b,c){var a=new NameValue(b,c);this.parameters.set_nv(a)};TelephoneNumber.prototype.setIsdnSubaddress=function(a){this.setParm(this.ISUB,a)};TelephoneNumber.prototype.setPhoneNumber=function(a){this.phoneNumber=a};TelephoneNumber.prototype.encode=function(){return this.encodeBuffer("").toString()};TelephoneNumber.prototype.encodeBuffer=function(a){if(this.isglobal){a=a+"+"}a=a+this.phoneNumber;if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};TelephoneNumber.prototype.getParameter=function(a){var b=this.parameters.getValue(a);if(b==null){return null}if(b instanceof GenericObject){return b.encode()}else{return b.toString()}};TelephoneNumber.prototype.getParameterNames=function(){return this.parameters.getNames()};TelephoneNumber.prototype.removeParameter=function(a){this.parameters.delet(a)};TelephoneNumber.prototype.setParameter=function(b,c){var a=new NameValue(b,c);this.parameters.set_nv(a)};TelephoneNumber.prototype.getParameters=function(){return this.parameters};function SipUri(){this.serialVersionUID="7749781076218987044L";this.classname="SipUri";this.authority=new Authority();this.uriParms=new NameValueList();this.qheaders=new NameValueList;this.telephoneSubscriber=new TelephoneNumber();this.scheme="sip";this.qheaders.setSeparator("&")}SipUri.prototype=new GenericURI();SipUri.prototype.constructor=SipUri;SipUri.prototype.SIP="sip";SipUri.prototype.SIPS="sips";SipUri.prototype.COLON=":";SipUri.prototype.SEMICOLON=";";SipUri.prototype.QUESTION="?";SipUri.prototype.AT="@";SipUri.prototype.METHOD="method";SipUri.prototype.USER="user";SipUri.prototype.PHONE="phone";SipUri.prototype.TTL="ttl";SipUri.prototype.MADDR="maddr";SipUri.prototype.TRANSPORT="transport";SipUri.prototype.LR="lr";SipUri.prototype.GRUU="gr";SipUri.prototype.setScheme=function(a){if(a.toLowerCase()!=this.SIP&&a.toLowerCase()!=this.SIPS){console.error("SipUri:setScheme(): bad scheme "+a);throw"SipUri:setScheme(): bad scheme "+a}this.scheme=a.toLowerCase()};SipUri.prototype.getScheme=function(){return this.scheme};SipUri.prototype.clearUriParms=function(){this.uriParms=new NameValueList()};SipUri.prototype.clearPassword=function(){if(this.authority!=null){var a=this.authority.getUserInfo();if(a!=null){a.clearPassword()}}};SipUri.prototype.getAuthority=function(){return this.authority};SipUri.prototype.clearQheaders=function(){this.qheaders=new NameValueList()};SipUri.prototype.equals=function(l){if(l==this){return true}if(l instanceof SipUri){var r=this;var q=l;if(r.isSecure()^q.isSecure()){return false}if(r.getUser()==null^q.getUser()==null){return false}if(r.getUserPassword()==null^q.getUserPassword()==null){return false}if(r.getUser()!=null&&(r.getUser()!=q.getUser())){return false}if(r.getUserPassword()!=null&&(r.getUserPassword()!=q.getUserPassword())){return false}if(r.getHost()==null^q.getHost()==null){return false}if(r.getHost()!=null&&!r.getHost().equalsIgnoreCase(q.getHost())){return false}if(r.getPort()!=q.getPort()){return false}var m=r.getParameterNames();for(var g=0;g<m.length;g++){var f=m[g];var v=r.getParameter(f);var t=q.getParameter(f);if(v!=null&&t!=null&&(v!=t)){return false}}if(r.getTransportParam()==null^q.getTransportParam()==null){return false}if(r.getUserParam()==null^q.getUserParam()==null){return false}if(r.getTTLParam()==-1^q.getTTLParam()==-1){return false}if(r.getMethodParam()==null^q.getMethodParam()==null){return false}if(r.getMAddrParam()==null^q.getMAddrParam()==null){return false}var u=r.getHeaderNames();var s=q.getHeaderNames();if(u[0]&&!s[0]){return false}if(!u[0]&&s[0]){return false}if(u[0]&&s[0]){var j=new SipFactory();var h=null;h=j.createHeaderFactory();for(g=0;g<u.length;g++){var d=u[g];var p=r.getHeader(d);var n=q.getHeader(d);if(p==null&&n!=null){return false}if(n==null&&p!=null){return false}if(p==null&&n==null){continue}var e=h.createHeader(d,RFC2396UrlDecoder.decode(p));var c=h.createHeader(d,RFC2396UrlDecoder.decode(n));if(e!=c){return false}}}return true}return false};SipUri.prototype.encode=function(){return this.encodeBuffer("")};SipUri.prototype.encodeBuffer=function(a){a=a+this.scheme+this.COLON;if(this.authority!=null){a=this.authority.encodeBuffer(a)}if(this.uriParms.hmap.length!=0){a=a+this.SEMICOLON;a=this.uriParms.encodeBuffer(a)}if(this.qheaders.hmap.length!=0){a=a+this.QUESTION;a=this.qheaders.encodeBuffer(a)}return a};SipUri.prototype.encodeWithoutScheme=function(){var a="";if(this.authority!=null){a=this.authority.encodeBuffer(a)}if(this.uriParms.hmap.length!=0){a=a+this.SEMICOLON;a=this.uriParms.encodeBuffer(a)}if(this.qheaders.hmap.length!=0){a=a+this.QUESTION;a=this.qheaders.encodeBuffer(a)}return a};SipUri.prototype.toString=function(){return this.encode()};SipUri.prototype.getUserAtHost=function(){var a="";if(this.authority.getUserInfo()!=null){a=this.authority.getUserInfo().getUser()}var c=this.authority.getHost().encode();var b=null;if(a==""){b=null}else{b=":"+this.AT}b=b+c;return b};SipUri.prototype.getUserAtHostPort=function(){var b="";if(this.authority.getUserInfo()!=null){b=this.authority.getUserInfo().getUser()}var d=this.authority.getHost().encode();var a=this.authority.getPort();var c=null;if(b==""){c=null}else{c=":"+this.AT}if(a!=-1){c=c+d+this.COLON+a;return c}else{c=c+d;return c}};SipUri.prototype.getParm=function(a){var b=this.uriParms.getValue(a);return b};SipUri.prototype.getMethod=function(){return this.getParm(this.METHOD)};SipUri.prototype.getParameters=function(){return this.uriParms};SipUri.prototype.removeParameters=function(){this.uriParms=new NameValueList()};SipUri.prototype.getQheaders=function(){return this.qheaders};SipUri.prototype.getUserType=function(){return this.uriParms.getValue(this.USER)};SipUri.prototype.getUserPassword=function(){if(this.authority==null){return null}return this.authority.getPassword()};SipUri.prototype.setUserPassword=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setPassword(a)};SipUri.prototype.getTelephoneSubscriber=function(){if(this.telephoneSubscriber==null){this.telephoneSubscriber=new TelephoneNumber()}return this.telephoneSubscriber};SipUri.prototype.getHostPort=function(){if(this.authority==null||this.authority.getHost()==null){return null}else{return this.authority.getHostPort()}};SipUri.prototype.getPort=function(){var a=this.getHostPort();if(a==null){return -1}return a.getPort()};SipUri.prototype.getHost=function(){if(this.authority==null){return null}else{if(this.authority.getHost()==null){return null}else{return this.authority.getHost().encode()}}};SipUri.prototype.isUserTelephoneSubscriber=function(){var a=this.uriParms.getValue(this.USER);if(a==null){return false}if(a.toLowerCase()==this.PHONE){return true}else{return false}};SipUri.prototype.removeTTL=function(){if(this.uriParms!=null){this.uriParms.delet(this.TTL)}};SipUri.prototype.removeMAddr=function(){if(this.uriParms!=null){this.uriParms.delet(this.MADDR)}};SipUri.prototype.removeTransport=function(){if(this.uriParms!=null){this.uriParms.delet(this.TRANSPORT)}};SipUri.prototype.removeHeader=function(a){if(this.uriParms!=null){this.uriParms.delet(a)}};SipUri.prototype.removeHeaders=function(){this.qheaders=new NameValueList()};SipUri.prototype.removeUserType=function(){if(this.uriParms!=null){this.uriParms.delet(this.USER)}};SipUri.prototype.removePort=function(){this.authority.removePort()};SipUri.prototype.removeMethod=function(){if(this.uriParms!=null){this.uriParms.delet(this.METHOD)}};SipUri.prototype.setUser=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setUser(a)};SipUri.prototype.removeUser=function(){this.authority.removeUserInfo()};SipUri.prototype.setDefaultParm=function(b,c){if(this.uriParms.getValue(b)==null){var a=new NameValue(b,c);this.uriParms.set_nv(a)}};SipUri.prototype.setAuthority=function(a){this.authority=a};SipUri.prototype.setHost_Host=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setHost(a)};SipUri.prototype.setUriParms=function(a){this.uriParms=a};SipUri.prototype.setUriParm=function(b,c){var a=new NameValue(b,c);this.uriParms.set_nv(a)};SipUri.prototype.setQheaders=function(a){this.qheaders=a};SipUri.prototype.setMAddr=function(b){var a=this.uriParms.getNameValue(this.MADDR);var c=new Host();c.setAddress(b);if(a!=null){a.setValueAsObject(c)}else{a=new NameValue(this.MADDR,c);this.uriParms.set_nv(a)}};SipUri.prototype.setUserParam=function(a){this.uriParms.set_name_value(this.USER,a)};SipUri.prototype.setMethod=function(a){this.uriParms.set_name_value(this.METHOD,a)};SipUri.prototype.setIsdnSubAddress=function(a){if(this.telephoneSubscriber==null){this.telephoneSubscriber=new TelephoneNumber()}this.telephoneSubscriber.setIsdnSubaddress(a)};SipUri.prototype.setTelephoneSubscriber=function(a){this.telephoneSubscriber=a};SipUri.prototype.setPort=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setPort(a)};SipUri.prototype.hasParameter=function(a){if(this.uriParms.getValue(a)!=null){return true}else{return false}};SipUri.prototype.setQHeader=function(a){this.qheaders.set_nv(a)};SipUri.prototype.setUriParameter=function(a){this.uriParms.set_nv(a)};SipUri.prototype.hasTransport=function(){if(this.hasParameter(this.TRANSPORT)){return true}else{return false}};SipUri.prototype.removeParameter=function(a){this.uriParms.delet(a)};SipUri.prototype.setHostPort=function(a){if(this.authority==null){this.authority=new Authority()}this.authority.setHostPort(a)};SipUri.prototype.getHeader=function(a){return this.qheaders.getValue(a)!=null?this.qheaders.getValue(a):null};SipUri.prototype.getHeaderNames=function(){return this.qheaders.getNames()};SipUri.prototype.getLrParam=function(){var a=this.hasParameter(this.LR);return a?"true":null};SipUri.prototype.getMAddrParam=function(){var a=this.uriParms.getNameValue(this.MADDR);if(a==null){return null}var b=a.getValueAsObject();if(typeof b=="object"){b=b.encode()}return b};SipUri.prototype.getMethodParam=function(){return this.getParameter(this.METHOD)};SipUri.prototype.getParameter=function(a){var b=this.uriParms.getValue(a);if(b==null){return null}if(b instanceof GenericObject){return b.encode()}else{return b}};SipUri.prototype.getParameterNames=function(){return this.uriParms.getNames()};SipUri.prototype.getTTLParam=function(){var a=this.uriParms.getValue("ttl");if(a!=null){a=a-0;return a}else{return -1}};SipUri.prototype.getTransportParam=function(){if(this.uriParms!=null){return this.uriParms.getValue(this.TRANSPORT)}else{return null}};SipUri.prototype.getUser=function(){return this.authority.getUser()};SipUri.prototype.isSecure=function(){if(this.getScheme().toLowerCase()==this.SIPS){return true}else{return false}};SipUri.prototype.isSipURI=function(){return true};SipUri.prototype.setHeader=function(b,c){var a=new NameValue(b,c);this.qheaders.set_nv(a)};SipUri.prototype.setHost_String=function(b){var a=new Host(b);this.setHost_Host(a)};SipUri.prototype.setLrParam=function(){this.uriParms.set_name_value("lr",null)};SipUri.prototype.setMAddrParam=function(a){if(a==null){console.error("SipUri:setMAddrParam(): bad maddr");throw"SipUri:setMAddrParam(): bad maddr"}this.setParameter("maddr",a)};SipUri.prototype.setMethodParam=function(a){this.setParameter("method",a)};SipUri.prototype.setParameter=function(a,b){if(a.toLowerCase()=="ttl"){b=b-0}this.uriParms.set_name_value(a,b)};SipUri.prototype.setSecure=function(a){if(a){this.scheme=this.SIPS}else{this.scheme=this.SIP}};SipUri.prototype.setTTLParam=function(a){if(a<=0){console.error("SipUri:setTTLParam(): Bad ttl value");throw"SipUri:setTTLParam(): Bad ttl value"}if(this.uriParms!=null){var b=new NameValue("ttl",a.valueOf());this.uriParms.set_nv(b)}};SipUri.prototype.setTransportParam=function(b){if(b==null){console.error("SipUri:setTransportParam():  null transport arg");throw"SipUri:setTransportParam(): null transport arg"}if(b=="UDP"==0||b=="TLS"==0||b=="TCP"==0||b=="SCTP"==0||b=="WS"==0){var a=new NameValue(this.TRANSPORT,b.toLowerCase());this.uriParms.set_nv(a)}else{console.error("SipUri:setTransportParam():  bad transport "+b);throw"SipUri:setTransportParam(): bad transport "+b}};SipUri.prototype.getUserParam=function(){return this.getParameter("user")};SipUri.prototype.hasLrParam=function(){if(this.uriParms.getNameValue("lr")!=null){return true}else{return false}};SipUri.prototype.hasGrParam=function(){if(this.uriParms.getNameValue(this.GRUU)!=null){return true}else{return false}};SipUri.prototype.setGrParam=function(a){this.uriParms.set_name_value(this.GRUU,a)};SipUri.prototype.getGrParam=function(){return this.uriParms.getValue(this.GRUU)};function AddressImpl(){this.serialVersionUID="429592779568617259L";this.classname="AddressImpl";this.addressType=1;this.displayName=null;this.address=new GenericURI()}AddressImpl.prototype.NAME_ADDR=1;AddressImpl.prototype.ADDRESS_SPEC=2;AddressImpl.prototype.WILD_CARD=3;AddressImpl.prototype.DOUBLE_QUOTE='"';AddressImpl.prototype.SP=" ";AddressImpl.prototype.LESS_THAN="<";AddressImpl.prototype.GREATER_THAN=">";AddressImpl.prototype.match=function(a){if(a==null){return true}if(!(a instanceof AddressImpl)){return false}else{var b=a;if(b.getMatcher()!=null){if(b.getMatcher().match(this.encode())){return true}else{return false}}else{if(b.displayName!=null&&this.displayName==null){return false}else{if(b.displayName==null){if(this.address.match(b.address)){return true}else{return false}}else{if(this.displayName.toLowerCase()==b.displayName&&this.address.match(b.address)){return true}else{return false}}}}}};AddressImpl.prototype.getHostPort=function(){if(!(this.address instanceof SipUri)){console.error("AddressImpl:getHostPort(): address is not a SipUri");throw"AddressImpl:getHostPort(): address is not a SipUri"}var a=this.address;return a.getHostPort()};AddressImpl.prototype.getPort=function(){if(!(this.address instanceof SipUri)){console.error("AddressImpl:getPort(): address is not a SipUri");throw"AddressImpl:getPort(): address is not a SipUri"}var a=this.address;return a.getHostPort().getPort()};AddressImpl.prototype.getUserAtHostPort=function(){if(this.address instanceof SipUri){var a=this.address;return a.getUserAtHostPort()}else{return this.address}};AddressImpl.prototype.getHost=function(){if(!(this.address instanceof SipUri)){console.error("AddressImpl:getHost(): address is not a SipUri");throw"AddressImpl:getHost(): address is not a SipUri"}var a=this.address;return a.getHostPort().getHost().getHostname()};AddressImpl.prototype.removeParameter=function(a){if(!(this.address instanceof SipUri)){console.error("AddressImpl:removeParameter(): address is not a SipUri");throw"AddressImpl:removeParameter(): address is not a SipUri"}var b=this.address;b.removeParameter(a)};AddressImpl.prototype.encode=function(){return this.encodeBuffer("")};AddressImpl.prototype.encodeBuffer=function(a){if(this.addressType==this.WILD_CARD){a=a+"*"}else{if(this.displayName!=null){a=a+this.DOUBLE_QUOTE+this.displayName+this.DOUBLE_QUOTE+this.SP}if(this.address!=null){if(this.addressType==this.NAME_ADDR||this.displayName!=null){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.addressType==this.NAME_ADDR||this.displayName!=null){a=a+this.GREATER_THAN}}}return a};AddressImpl.prototype.getAddressType=function(){return this.addressType};AddressImpl.prototype.setAddressType=function(a){this.addressType=a};AddressImpl.prototype.getDisplayName=function(){return this.displayName};AddressImpl.prototype.setDisplayName=function(a){this.displayName=a;this.addressType=this.NAME_ADDR};AddressImpl.prototype.setAddress=function(a){this.address=a};AddressImpl.prototype.hashCode=function(){var d=0;var a=this.address;if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};AddressImpl.prototype.equals=function(a){if(this==a){return true}if(a instanceof AddressImpl){var b=a;if(this.getURI()==b.getURI()){return true}else{return false}}return false};AddressImpl.prototype.hasDisplayName=function(){if(this.displayName!=null){return true}else{return false}};AddressImpl.prototype.removeDisplayName=function(){this.displayName=null};AddressImpl.prototype.isSIPAddress=function(){if(address instanceof SipUri){return true}else{return false}};AddressImpl.prototype.getURI=function(){return this.address};AddressImpl.prototype.isWildcard=function(){if(this.addressType==this.WILD_CARD){return true}else{return false}};AddressImpl.prototype.setURI=function(a){this.address=a};AddressImpl.prototype.setUser=function(a){if(this.address instanceof SipUri){this.address.setUser(a)}else{this.address=new SipUri();this.address.setUser(a)}};AddressImpl.prototype.setWildCardFlag=function(){this.addressType=this.WILD_CARD;this.address=new SipUri();this.address.setUser("*")};function AddressFactoryImpl(){this.classname="AddressFactoryImpl"}AddressFactoryImpl.prototype.createAddress=function(){if(arguments.length==0){var a=new AddressImpl();return a}else{if(arguments.length==1){if(typeof arguments[0]=="string"){var c=arguments[0];var e=this.createAddress_address(c);return e}else{if(typeof arguments[0]=="object"){var d=arguments[0];var a=this.createAddress_uri(d);return a}}}else{if(arguments.length==2){var b=arguments[0];d=arguments[1];a=this.createAddress_name_uri(b,d);return a}else{console.error("AddressFactoryImpl:createAddress():  too many arg");throw"AddressFactoryImpl:createAddress():  too many arg"}}}};AddressFactoryImpl.prototype.createAddress_name_uri=function(b,c){if(c==null){console.error("AddressFactoryImpl:createAddress_name_uri():  null uri arg");throw"AddressFactoryImpl:createAddress_name_uri():  null uri arg"}var a=new AddressImpl();if(b!=null){a.setDisplayName(b)}a.setURI(c);return a};AddressFactoryImpl.prototype.createSipURI=function(){if(arguments.length==0){console.error("AddressFactoryImpl:createSipURI(): missing uri arg");throw"AddressFactoryImpl:createSipURI():  missing uri arg"}else{if(arguments.length==1){var c=arguments[0];if(c==null){console.error("AddressFactoryImpl:createSipURI():  null uri arg");throw"AddressFactoryImpl:createSipURI():  null uri arg"}var e=new StringMsgParser();var d=e.parseSIPUrl(c);return d}else{if(arguments.length==2){var a=arguments[0];var b=arguments[1];d=this.createSipURI_user_host(a,b);return d}}}};AddressFactoryImpl.prototype.createSipURI_user_host=function(a,b){if(b==null){console.error("AddressFactoryImpl:createSipURI_user_host(): null host arg");throw"AddressFactoryImpl:createSipURI_user_host():  null host arg"}var e="sip:";if(a!=null){e=e+a+"@"}if(b.indexOf(":")!=b.lastIndexOf(":")&&b.trim().charAt(0)!="["){b="["+b+"]"}e=e+b;var d=new StringMsgParser();var c=d.parseSIPUrl(e.toString());return c};AddressFactoryImpl.prototype.createTelURL=function(b){if(b==null){console.error("AddressFactoryImpl:createTelURL(): null uri arg");throw"AddressFactoryImpl:createTelURL():  null uri arg"}var a="tel:"+b;var d=new StringMsgParser();var c=d.parseUrl(a);return c};AddressFactoryImpl.prototype.createAddress_uri=function(b){if(b==null){console.error("AddressFactoryImpl:createAddress_uri(): null uri arg");throw"AddressFactoryImpl:createAddress_uri():  null uri arg"}var a=new AddressImpl();a.setURI(b);return a};AddressFactoryImpl.prototype.createAddress_address=function(b){if(b==null){console.error("AddressFactoryImpl:createAddress_address(): null address arg");throw"AddressFactoryImpl:createAddress_address():  null address arg"}if(b.equals("*")){var a=new AddressImpl();a.setAddressType(a.wild_card);var c=new SipUri();c.setUser("*");a.setURI(c);return a}else{var d=new gov.nist.js.parser.StringMsgParser();return d.parseAddress(b)}};AddressFactoryImpl.prototype.createURI=function(c){if(c==null){console.error("AddressFactoryImpl:createURI(): null uri arg");throw"AddressFactoryImpl:createURI():  null uri arg"}var b=new URLParser(c);var a=b.peekScheme();if(a==null){console.error("AddressFactoryImpl:createURI(): bad scheme");throw"AddressFactoryImpl:createURI():  bad scheme"}if(a.toLowerCase()=="sip"){return b.sipURL(true)}else{if(a.toLowerCase()=="sips"){return b.sipURL(true)}else{if(a.toLowerCase()=="tel"){return b.telURL(true)}}}return new GenericURI(c)};function SIPObject(){this.classname="SIPObject"}SIPObject.prototype=new GenericObject();SIPObject.prototype.constructor=SIPObject;function SIPHeader(a){this.serialVersionUID="7749781076218987044L";this.classname="SIPHeader";this.headerName=null;if(a!=null){this.headerName=a}}SIPHeader.prototype.COLON=":";SIPHeader.prototype.SP=" ";SIPHeader.prototype.NEWLINE="\r\n";SIPHeader.prototype.getHeaderName=function(){return this.headerName};SIPHeader.prototype.getName=function(){return this.headerName};SIPHeader.prototype.setHeaderName=function(a){this.headerName=a};SIPHeader.prototype.getHeaderValue=function(){var b=null;b=this.encode();var a=b;while(a.length>0&&a.charAt(0)!=":"){a=a.substring(1)}if(a.length>0){a=a.substring(1)}return a.toString().replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"")};SIPHeader.prototype.isHeaderList=function(){return false};SIPHeader.prototype.encode=function(){return this.encodeBuffer("").toString()};SIPHeader.prototype.encodeBuffer=function(a){a=a+this.headerName+this.COLON+this.SP;a=this.encodeBodyBuffer(a);a=a+this.NEWLINE;return a};SIPHeader.prototype.encodeBody=function(){};SIPHeader.prototype.encodeBodyBuffer=function(a){a=a+this.encodeBody();return a};SIPHeader.prototype.getValue=function(){return this.getHeaderValue()};SIPHeader.prototype.hashCode=function(){var d=0;var a=this.headerName;if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};SIPHeader.prototype.toString=function(){return this.encode()};function SIPHeaderList(){this.classname="SIPHeaderList";this.prettyEncode=false;this.hlist=new Array();this.myClass=null;if(arguments.length!=0){var b=arguments[0];var a=arguments[1];this.headerName=a;this.myClass=b}}SIPHeaderList.prototype=new SIPHeader();SIPHeaderList.prototype.constructor=SIPHeaderList;SIPHeaderList.prototype.NEWLINE="\r\n";SIPHeaderList.prototype.WWW_AUTHENTICATE="WWW-Authenticate";SIPHeaderList.prototype.PROXY_AUTHENTICATE="Proxy-Authenticate";SIPHeaderList.prototype.AUTHORIZATION="Authorization";SIPHeaderList.prototype.PROXY_AUTHORIZATION="Proxy-Authorization";SIPHeaderList.prototype.ROUTE="Route";SIPHeaderList.prototype.RECORD_ROUTE="Record-Route";SIPHeaderList.prototype.VIA="Via";SIPHeaderList.prototype.COLON=":";SIPHeaderList.prototype.SP=" ";SIPHeaderList.prototype.COMMA=",";SIPHeaderList.prototype.SEMICOLON=";";SIPHeaderList.prototype.getName=function(){return this.headerName};SIPHeaderList.prototype.add=function(){if(arguments.length==1){var j=arguments[0];var d=null;for(var e=0;e<this.hlist.length;e++){if(j==this.hlist[e]){d=e}}if(d==null){this.hlist.push(j)}}else{if(typeof arguments[0]=="object"){var c=arguments[0];var g=arguments[1];if(g){this.addFirst(c)}else{this.add(c)}}else{if(typeof arguments[0]=="number"){var f=arguments[0];var b=arguments[1];if(this.hlist[f]!=null){var h=this.hlist.slice(f);this.hlist[f]=b;for(e=0;e<h.length;e++){var a=f+e+1;this.hlist[a]=h[e]}}else{this.hlist[f]=b}}}}};SIPHeaderList.prototype.addFirst=function(a){this.hlist.unshift(a)};SIPHeaderList.prototype.concatenate=function(a,b){if(!b){this.addAll(a)}else{this.addAll(0,a)}};SIPHeaderList.prototype.encode=function(){return this.encodeBuffer("").toString()};SIPHeaderList.prototype.encodeBuffer=function(b){if(this.hlist.length==0){b=b+this.headerName+":"+this.NEWLINE}else{if(this.headerName==this.WWW_AUTHENTICATE||this.headerName==this.PROXY_AUTHENTICATE||this.headerName==this.AUTHORIZATION||this.headerName==this.PROXY_AUTHORIZATION||(this.prettyEncode&&(this.headerName==this.VIA||this.headerName==this.ROUTE||this.headerName==this.RECORD_ROUTE))||this.classname=="ExtensionHeaderList"){for(var c=0;c<this.hlist.length;c++){var a=this.hlist[c];b=a.encodeBuffer(b)}}else{b=b+this.headerName+this.COLON+this.SP;b=this.encodeBodyBuffer(b);b=b+this.NEWLINE}}return b};SIPHeaderList.prototype.getHeadersAsEncodedStrings=function(){var b=new Array();for(var c=0;c<this.hlist.length;c++){var a=this.hlist[c];b[c]=a.toString()}return b};SIPHeaderList.prototype.getFirst=function(){if(this.hlist==null||this.hlist.length==0){return null}else{return this.hlist[0]}};SIPHeaderList.prototype.getLast=function(){if(this.hlist==null||this.hlist.length==0){return null}var a=this.hlist.length;return this.hlist[a-1]};SIPHeaderList.prototype.getMyClass=function(){return this.myClass};SIPHeaderList.prototype.isEmpty=function(){if(this.hlist==0){return true}else{return false}};SIPHeaderList.prototype.listIterator=function(){if(arguments.length==0){return this.hlist}else{var a=arguments[0];var b=this.hlist;return b.slice(a)}};SIPHeaderList.prototype.getHeaderList=function(){return this.hlist};SIPHeaderList.prototype.removeFirst=function(){if(this.hlist.length!=0){this.hlist.splice(0,1)}};SIPHeaderList.prototype.removeLast=function(){if(this.hlist.length!=0){var a=this.hlist.length-1;this.hlist.splice(a,1)}};SIPHeaderList.prototype.remove=function(d){if(typeof d=="number"){var a=this.hlist[d];this.hlist.splice(d,1);return a}else{if(typeof d=="object"){if(this.hlist.length==0){return false}else{var b=null;for(var c=0;c<this.hlist.length;c++){if(this.hlist[c]==d){b=c}}if(b!=null){this.hlist.splice(b,1);return true}else{return false}}}}return false};SIPHeaderList.prototype.setMyClass=function(a){this.myClass=a};SIPHeaderList.prototype.toArray=function(){return this.hlist};SIPHeaderList.prototype.indexOf=function(c){var a=null;for(var b=0;b<this.hlist.length;b++){if(this.hlist[b].classname.toLowerCase()==c.toLowerCase()){a=b}}if(a!=null){return a}else{return -1}};SIPHeaderList.prototype.size=function(){return this.hlist.length};SIPHeaderList.prototype.isHeaderList=function(){return true};SIPHeaderList.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};SIPHeaderList.prototype.encodeBodyBuffer=function(a){for(var b=0;b<this.hlist.length;b++){var c=this.hlist[b];if(c.classname=="SIPHeaderList"){console.error("SIPHeaderList:encodeBodyBuffer(): unexpected circularity in SipHeaderList");throw"SIPHeaderList:encodeBodyBuffer(): unexpected circularity in SipHeaderList"}a=c.encodeBodyBuffer(a);if(b!=this.hlist.length-1){if(this.headerName!="Privacy"){a=a+this.COMMA}else{a=a+this.SEMICOLON}}}return a};SIPHeaderList.prototype.addAll=function(){if(arguments.length==1){var e=arguments[0];var d=this.hlist.length;for(var c=0;c<e.length;c++){var f=c+d;this.hlist[f]=e[c]}if(this.hlist.length!=d){return true}else{return false}}else{if(arguments.length==2){var b=arguments[0];e=arguments[1];if(this.hlist[b]!=null){var a=this.hlist.slice(b);d=this.hlist.length;for(c=0;c<e.length;c++){f=c+b;this.hlist[f]=e[c]}for(c=0;c<a.length;c++){f=b+c+e.length;this.hlist[f]=a[c]}if(this.hlist.length!=d){return true}else{return false}}else{b=arguments[0];e=arguments[1];d=this.hlist.length;for(c=0;c<e.length;c++){f=c+b;this.hlist[f]=e[c]}if(this.hlist.length!=d){return true}else{return false}}}}return false};SIPHeaderList.prototype.containsAll=function(b){var e=0;for(var a=0;a<b.length;a++){for(var d=0;d<this.hlist.length;d++){if(this.hlist[d].classname==b[a].classname){e=e+1}}}if(e==b.length){return true}else{return false}};SIPHeaderList.prototype.clear=function(){this.hlist=new Array()};SIPHeaderList.prototype.contains=function(d){var b=0;for(var a=0;a<this.hlist.length;a++){if(this.hlist[a].classname==d){b=1}}if(b==1){return true}else{return false}};SIPHeaderList.prototype.get=function(a){return this.hlist[a]};SIPHeaderList.prototype.iterator=function(){return this.hlist};SIPHeaderList.prototype.lastIndexOf=function(a){var d=null;for(var b=0;b<this.hlist.length;b++){if(this.hlist[b].classname==a){d=b}}if(d==null){return d}else{return -1}};SIPHeaderList.prototype.removeAll=function(e){var b=new Array();var g=0;var a=0;for(var d=0;d<this.hlist.length;d++){for(var f=0;f<e.length;f++){if((this.hlist[d].classname!=e[f].classname)&&(e[f].classname!=null)){a=a+1}}if(a==e.length){b[g]=this.hlist[d];g=g+1}a=0}if(this.hlist.length!=b.length){this.hlist=b;return true}else{return false}};SIPHeaderList.prototype.retainAll=function(d){var a=new Array();var f=0;for(var b=0;b<this.hlist.length;b++){for(var e=0;e<d.length;e++){if((this.hlist[b].classname==d[e].classname)){a[f]=this.hlist[b];f=f+1}}}if(this.hlist.length!=a.length){this.hlist=a;return true}else{return false}};SIPHeaderList.prototype.subList=function(b,a){return this.hlist.slice(b,a)};SIPHeaderList.prototype.hashCode=function(){var c=0;var e=this.headerName;if(!(e==null||e.value=="")){for(var a=0;a<e.length;a++){c=c*31+e.charCodeAt(a);var b=2147483647;var d=-2147483648;if(c>b||c<d){c&=4294967295}}}return c};SIPHeaderList.prototype.set=function(b,c){var a=this.hlist[b];this.hlist[b]=c;return a};SIPHeaderList.prototype.setPrettyEncode=function(a){this.prettyEncode=a};function ParametersHeader(a,b){this.classname="ParametersHeader";this.parameters=null;this.duplicates=null;this.headerName=null;if(a==null&&b==null){this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{if(a!=null&&b==null){this.headerName=a;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{if(a!=null&&b!=null){this.headerName=a;this.parameters=new NameValueList(b);this.duplicates=new DuplicateNameValueList()}}}}ParametersHeader.prototype=new SIPHeader();ParametersHeader.prototype.constructor=ParametersHeader;ParametersHeader.prototype.getParameter=function(a){return this.parameters.getParameter(a)};ParametersHeader.prototype.getParameterValue=function(a){return this.parameters.getValue(a)};ParametersHeader.prototype.getParameterNames=function(){return this.parameters.getNames()};ParametersHeader.prototype.hasParameters=function(){if(this.parameters!=null&&this.parameters.hmap.length!=0){return true}else{return false}};ParametersHeader.prototype.removeParameter=function(a){this.parameters.delet(a)};ParametersHeader.prototype.setQuotedParameter=function(b,c){var a=this.parameters.getNameValue(b);if(a!=null){a.setValueAsObject(c);a.setQuotedValue()}else{a=new NameValue(b,c);a.setQuotedValue();this.parameters.set_nv(a)}};ParametersHeader.prototype.setParameter=function(b,d){if(typeof d=="object"){this.parameters.set_name_value(b,e)}else{if(typeof d=="boolean"){var e=new Boolean(d);this.parameters.set_name_value(b,e)}else{if(typeof d=="number"){var c=d-[d];if(c==0){e=new Number(d);this.parameters.set_name_value(b,e)}else{e=new Number(d);var a=this.parameters.getNameValue(b);if(a!=null){a.setValueAsObject(e)}else{a=new NameValue(b,e);this.parameters.set_nv(a)}}}else{if(typeof d=="string"){a=this.parameters.getNameValue(b);if(a!=null){a.setValueAsObject(d)}else{a=new NameValue(b,d);this.parameters.set_nv(a)}}}}}};ParametersHeader.prototype.hasParameter=function(a){return this.parameters.hasNameValue(a)};ParametersHeader.prototype.removeParameters=function(){this.parameters=new NameValueList()};ParametersHeader.prototype.getParameters=function(){return this.parameters};ParametersHeader.prototype.setParameter_nv=function(a){this.parameters.set_nv(a)};ParametersHeader.prototype.setParameters=function(a){this.parameters=a};ParametersHeader.prototype.getParameterAsNumber=function(a){if(this.getParameterValue(a)!=null){return this.getParameterValue(a)-0}else{return -1}};ParametersHeader.prototype.getParameterAsURI=function(a){var b=this.getParameterValue(a);if(b instanceof GenericURI){return b}else{return new GenericURI(b)}};ParametersHeader.prototype.getParameterAsBoolean=function(b){var c=this.getParameterValue(b);if(c==null){return false}else{if(c instanceof Boolean){return c}else{if(c instanceof String){var a=new Boolean(c);return a}else{return false}}}};ParametersHeader.prototype.getNameValue=function(a){return this.parameters.getNameValue(a)};ParametersHeader.prototype.setMultiParameter_name_value=function(b,c){var a=new NameValue();a.setName(b);a.setValue(c);this.duplicates.set_nv(a)};ParametersHeader.prototype.setMultiParameter_nv=function(a){this.duplicates.set_nv(a)};ParametersHeader.prototype.getMultiParameter=function(a){return this.duplicates.getParameter(a)};ParametersHeader.prototype.getMultiParameters=function(){return this.duplicates};ParametersHeader.prototype.getMultiParameterValue=function(a){return this.duplicates.getValue(a)};ParametersHeader.prototype.getMultiParameterNames=function(){return this.duplicates.getNames()};ParametersHeader.prototype.hasMultiParameters=function(){if(this.duplicates!=null&&this.duplicates.length!=o){return true}else{return false}};ParametersHeader.prototype.removeMultiParameter=function(a){this.duplicates.delet(a)};ParametersHeader.prototype.hasMultiParameter=function(a){return this.duplicates.hasNameValue(a)};ParametersHeader.prototype.removeMultiParameters=function(){this.duplicates=new DuplicateNameValueList()};ParametersHeader.prototype.equalParameters=function(a){if(this==a){return true}var d=this.getParameterNames();for(var c=0;c<d.length;c++){var b=d[c];var f=this.getParameter(b);var e=a.getParameter(b);if(f==null^e==null){return false}else{if(f!=null&&f.toLowerCase()!=e){return false}}}d=a.getParameterNames();for(c=0;c<d.length;c++){b=d[c];f=a.getParameter(b);e=this.getParameter(b);if(f==null^e==null){return false}else{if(f!=null&&f.toLowerCase()!=e){return false}}}return true};ParametersHeader.prototype.encodeBody=function(){};function RequestLine(a,b){this.serialVersionUID="-3286426172326043129L";this.classname="RequestLine";this.uri=new GenericURI();this.method=null;this.sipVersion="SIP/2.0";if(a!=null&&b!=null){this.uri=a;this.method=b}}RequestLine.prototype=new SIPObject();RequestLine.prototype.constructor=RequestLine;RequestLine.prototype.SP=" ";RequestLine.prototype.NEWLINE="\r\n";RequestLine.prototype.encode=function(){return this.encodeBuffer("").toString()};RequestLine.prototype.encodeBuffer=function(a){if(this.method!=null){a=a+this.method+this.SP}if(this.uri!=null){a=this.uri.encodeBuffer(a);a=a+this.SP}a=a+this.sipVersion+this.NEWLINE;return a};RequestLine.prototype.getUri=function(){return this.uri};RequestLine.prototype.getMethod=function(){return this.method};RequestLine.prototype.getSipVersion=function(){return this.sipVersion};RequestLine.prototype.setUri=function(a){return this.uri=a};RequestLine.prototype.setMethod=function(a){this.method=a};RequestLine.prototype.setSipVersion=function(a){this.sipVersion=a};RequestLine.prototype.getVersionMajor=function(){if(this.sipVersion==null){return null}var a=null;var c=false;for(var b=0;b<this.sipVersion.length;b++){if(this.sipVersion.charAt(b)=="."){break}if(c){if(a==null){a=""+this.sipVersion.charAt(b)}else{a+=this.sipVersion.charAt(b)}}if(this.sipVersion.charAt(b)=="/"){c=true}}return a};RequestLine.prototype.getVersionMinor=function(){if(this.sipVersion==null){return null}var c=null;var a=false;for(var b=0;b<this.sipVersion.length;b++){if(this.sipVersion.charAt(b)=="."){break}if(a){if(c==null){c=""+this.sipVersion.charAt(b)}else{c+=this.sipVersion.charAt(b)}}if(this.sipVersion.charAt(b)=="/"){a=true}}return c};function UserAgent(){this.serialVersionUID="4561239179796364295L";this.classname="UserAgent";this.productTokens=new Array();this.headerName=this.NAME}UserAgent.prototype=new SIPHeader();UserAgent.prototype.constructor=UserAgent;UserAgent.prototype.NAME="User-Agent";UserAgent.prototype.encodeProduct=function(){var b="";for(var a=0;a<this.productTokens.length;a++){b=b+this.productTokens[a]}return b.toString()};UserAgent.prototype.addProductToken=function(b){var a=this.productTokens.length;this.productTokens[a]=b};UserAgent.prototype.encodeBody=function(){return this.encodeProduct()};UserAgent.prototype.getProduct=function(){if(this.productTokens==null||this.productTokens.length==0){return null}else{return this.productTokens}};UserAgent.prototype.setProduct=function(a){if(a==null){console.error("UserAgent:setProduct(): the product parameter is null");throw"UserAgent:setProduct(): the product parameter is null"}this.productTokens=a};function ContentLength(a){this.serialVersionUID="1187190542411037027L";this.classname="ContentLength";this.headerName=this.NAME;this.contentLength=null;if(a==null){this.headerName=this.NAME}else{this.headerName=this.NAME;this.contentLength=a}}ContentLength.prototype=new SIPHeader();ContentLength.prototype.constructor=ContentLength;ContentLength.prototype.NAME="Content-Length";ContentLength.prototype.getContentLength=function(){var a=this.contentLength-0;return a};ContentLength.prototype.setContentLength=function(a){if(a<0){console.error("ContentLength:setContentLength(): the contentLength parameter is < 0");throw"ContentLength:setContentLength(): the contentLength parameter is < 0"}this.contentLength=a};ContentLength.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};ContentLength.prototype.encodeBodyBuffer=function(a){if(this.contentLength==null){a=a+"0"}else{a=a+this.contentLength.toString()}return a};ContentLength.prototype.match=function(a){if(a instanceof ContentLength){return true}else{return false}};function ExtensionHeaderImpl(a){this.classname="ExtensionHeaderImpl";this.serialVersionUID="-8693922839612081849L";this.value=null;if(a!=null){this.headerName=a}}ExtensionHeaderImpl.prototype=new SIPHeader();ExtensionHeaderImpl.prototype.constructor=ExtensionHeaderImpl;ExtensionHeaderImpl.prototype.COLON=":";ExtensionHeaderImpl.prototype.SP=" ";ExtensionHeaderImpl.prototype.NEWLINE="\r\n";ExtensionHeaderImpl.prototype.setName=function(a){this.headerName=a};ExtensionHeaderImpl.prototype.setValue=function(a){this.value=a};ExtensionHeaderImpl.prototype.getHeaderValue=function(){if(this.value!=null){return this.value}else{var d=null;try{d=this.encode()}catch(e){console.error("ExtensionHeaderImpl:getHeaderValue(): catched exception:"+e);return null}var c=d;var b=0;var a=c.substring(b);while(a.length>0&&c.charAt(0)!=":"){b=b+1;a=c.substring(b)}b=b+1;a=c.substring(b);this.value=a.toString().replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"");return this.value}};ExtensionHeaderImpl.prototype.encode=function(){var a="";a=a+this.headerName+this.COLON+this.SP+this.value+this.NEWLINE;return a};ExtensionHeaderImpl.prototype.encodeBody=function(){return this.getHeaderValue()};function Server(a){this.serialVersionUID="-3587764149383342973L";this.classname="Server";this.productTokens=new Array();this.headerName=this.NAME}Server.prototype=new SIPHeader();Server.prototype.constructor=Server;Server.prototype.NAME="Server";Server.prototype.encodeProduct=function(){var b="";for(var a=0;a<this.productTokens.length;a++){b=b+this.productTokens[a];if(a!=this.productTokens.length-1){b=b+"/"}else{break}}return b.toString()};Server.prototype.addProductToken=function(a){this.productTokens.push(a)};Server.prototype.encodeBody=function(){return this.encodeProduct()};Server.prototype.getProduct=function(){if(this.productTokens==null||this.productTokens.length==0){return null}else{return this.productTokens}};Server.prototype.setProduct=function(a){if(a==null){console.error("Server:setProduct(): the product parameter is null");throw"Server:setProduct(): the product parameter is null"}this.productTokens=a};function AddressParametersHeader(a,b){this.classname="AddressParametersHeader";this.address=new AddressImpl();this.headerName=null;if(a!=null&&b==null){this.headerName=a;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{if(a!=null&&b!=null){this.headerName=a;this.parameters=new NameValueList(b);this.duplicates=new DuplicateNameValueList()}}}AddressParametersHeader.prototype=new ParametersHeader();AddressParametersHeader.prototype.constructor=AddressParametersHeader;AddressParametersHeader.prototype.getAddress=function(){return this.address};AddressParametersHeader.prototype.setAddress=function(a){this.address=a};AddressParametersHeader.prototype.equals=function(a){if(this==a){return true}if(a instanceof ParametersHeader){var b=a;if(this.getAddress().equals(b.getAddress())&&this.equalParameters(b)){return true}else{return false}}return false};function From(a){this.serialVersionUID="-6312727234330643892L";this.classname="From";this.parameters=null;this.duplicates=null;this.address=new AddressImpl();if(a==null){this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.headerName=this.NAME;this.address=a.address;this.parameters=a.parameters}}From.prototype=new AddressParametersHeader();From.prototype.constructor=From;From.prototype.NAME="From";From.prototype.ADDRESS_SPEC=2;From.prototype.LESS_THAN="<";From.prototype.GREATER_THAN=">";From.prototype.SEMICOLON=";";From.prototype.TAG="tag";From.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};From.prototype.encodeBodyBuffer=function(a){if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.GREATER_THAN}if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};From.prototype.getHostPort=function(){return this.address.getHostPort()};From.prototype.getDisplayName=function(){return this.address.getDisplayName()};From.prototype.getTag=function(){if(this.parameters==null){return null}return this.getParameter(this.TAG)};From.prototype.hasTag=function(){return this.hasParameter(this.TAG)};From.prototype.removeTag=function(){this.parameters.delet(this.TAG)};From.prototype.setAddress=function(a){this.address=a};From.prototype.setTag=function(a){var b=new Parser();b.checkToken(a);this.setParameter(this.TAG,a)};From.prototype.getUserAtHostPort=function(){return this.address.getUserAtHostPort()};From.prototype.equals=function(a){if((a instanceof From)&&Object.getPrototypeOf(this).equals(a)){return true}else{return false}};From.prototype.getAddress=function(){return this.address};function To(a){this.serialVersionUID="-4057413800584586316L";this.classname="To";if(a==null){this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.setAddress(a.address);this.setParameters(a.parameters)}}To.prototype=new AddressParametersHeader();To.prototype.constructor=To;To.prototype.NAME="To";To.prototype.ADDRESS_SPEC=2;To.prototype.LESS_THAN="<";To.prototype.GREATER_THAN=">";To.prototype.SEMICOLON=";";To.prototype.TAG="tag";To.prototype.COLON=":";To.prototype.SP=" ";To.prototype.NEWLINE="\r\n";To.prototype.encode=function(){return this.headerName+this.COLON+this.SP+this.encodeBody()+this.NEWLINE};To.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};To.prototype.encodeBodyBuffer=function(a){if(this.address!=null){if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.GREATER_THAN}if(!this.parameters.isEmpty()){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}}return a};To.prototype.getHostPort=function(){if(this.address==null){return null}return this.address.getHostPort()};To.prototype.getDisplayName=function(){if(this.address==null){return null}return this.address.getDisplayName()};To.prototype.getTag=function(){if(this.parameters==null){return null}return this.getParameter(this.TAG)};To.prototype.hasTag=function(){if(this.parameters==null){return false}return this.hasParameter(this.TAG)};To.prototype.removeTag=function(){if(this.parameters!=null){this.parameters.delet(this.TAG)}};To.prototype.setTag=function(a){var b=new Parser();b.checkToken(a);this.setParameter(this.TAG,a)};To.prototype.getUserAtHostPort=function(){if(this.address==null){return null}return this.address.getUserAtHostPort()};function Reason(){this.serialVersionUID="-8903376965568297388L";this.classname="Reason";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.protocol=null}Reason.prototype=new ParametersHeader();Reason.prototype.constructor=Reason;Reason.prototype.NAME="Reason";Reason.prototype.TEXT="text";Reason.prototype.CAUSE="cause";Reason.prototype.SEMICOLON=";";Reason.prototype.getCause=function(){return this.getParameterAsNumber(this.CAUSE)};Reason.prototype.setCause=function(a){this.parameters.set_name_value("cause",a)};Reason.prototype.setProtocol=function(a){this.protocol=a};Reason.prototype.getProtocol=function(){return this.protocol};Reason.prototype.setText=function(b){if(b.charAt(0)!='"'){var a=new Utils();b=a.getQuotedString(b)}this.parameters.set_name_value("text",b)};Reason.prototype.getText=function(){return this.parameters.getParameter("text")};Reason.prototype.getName=function(){return this.NAME};Reason.prototype.encodeBody=function(){var a="";a=a+this.protocol;if(this.parameters!=null&&this.parameters.hmap.length!=0){a=a+this.SEMICOLON+this.parameters.encode()}return a.toString()};function ReasonList(){this.serialVersionUID="7459989997463160670L";this.classname="ReasonList";this.headerName=this.NAME;this.myClass="Reason"}ReasonList.prototype=new SIPHeaderList();ReasonList.prototype.constructor=ReasonList;ReasonList.prototype.NAME="Reason";ReasonList.prototype.clone=function(){};function Protocol(){this.serialVersionUID="2216758055974073280L";this.classname="Protocol";this.protocolName="SIP";this.protocolVersion="2.0";this.transport="WS"}Protocol.prototype=new SIPObject();Protocol.prototype.constructor=Protocol;Protocol.prototype.SLASH="/";Protocol.prototype.encode=function(){return this.encodeBuffer("").toString()};Protocol.prototype.encodeBuffer=function(a){a=a+this.protocolName.toUpperCase()+this.SLASH+this.protocolVersion+this.SLASH+this.transport.toUpperCase();return a};Protocol.prototype.getProtocolName=function(){return this.protocolName};Protocol.prototype.getProtocolVersion=function(){return this.protocolVersion};Protocol.prototype.getProtocol=function(){return this.protocolName+"/"+this.protocolVersion};Protocol.prototype.setProtocol=function(b){var a=b.indexOf("/");if(a>0){this.protocolName=b.substring(0,a);this.protocolVersion=b.substring(a+1)}else{console.error("Event:setProtocol(): missing '/' in protocol",0);throw"Event:setProtocol(): missing '/' in protocol"}};Protocol.prototype.getTransport=function(){return this.transport};Protocol.prototype.setProtocolName=function(a){this.protocolName=a};Protocol.prototype.setProtocolVersion=function(a){this.protocolVersion=a};Protocol.prototype.setTransport=function(a){this.transport=a};function Via(){this.serialVersionUID="5281728373401351378L";this.classname="Via";this.sentProtocol=new Protocol();this.sentBy=new HostPort();this.comment=null;this.rPortFlag=true;this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}Via.prototype=new ParametersHeader();Via.prototype.constructor=Via;Via.prototype.NAME="Via";Via.prototype.BRANCH="branch";Via.prototype.RECEIVED="received";Via.prototype.MADDR="maddr";Via.prototype.TTL="ttl";Via.prototype.RPORT="rport";Via.prototype.SP=" ";Via.prototype.SEMICOLON=";";Via.prototype.LPAREN="(";Via.prototype.RPAREN=")";Via.prototype.getProtocolVersion=function(){if(this.sentProtocol==null){return null}else{return this.sentProtocol.getProtocolVersion()}};Via.prototype.getSentProtocol=function(){return this.sentProtocol};Via.prototype.getSentBy=function(){return this.sentBy};Via.prototype.getHop=function(){var a=new HopImpl(this.sentBy.getHost().getHostname());return a};Via.prototype.getViaParms=function(){return this.parameters};Via.prototype.hasPort=function(){return this.getSentBy().hasPort()};Via.prototype.hasComment=function(){if(this.comment!=null){return true}else{return false}};Via.prototype.removePort=function(){this.sentBy.removePort()};Via.prototype.removeComment=function(){this.comment=null};Via.prototype.setProtocolVersion=function(){if(this.sentProtocol==null){this.sentProtocol=new Protocol()}this.sentProtocol.setProtocolVersion(this.protocolVersion)};Via.prototype.setHost=function(b){if(typeof b=="object"){if(this.sentBy==null){this.sentBy=new HostPort()}this.sentBy.setHost(b)}else{if(typeof b=="string"){if(this.sentBy==null){this.sentBy=new HostPort()}var a=new Host(b);this.sentBy.setHost(a)}}};Via.prototype.setSentProtocol=function(a){this.sentProtocol=a};Via.prototype.setSentBy=function(a){this.sentBy=a};Via.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};Via.prototype.encodeBodyBuffer=function(a){a=this.sentProtocol.encodeBuffer(a);a=a+this.SP;a=this.sentBy.encodeBuffer(a);if(this.parameters.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}if(this.comment!=null){a=a+this.SP+this.LPAREN+this.comment+this.RPAREN}if(this.rPortFlag){a=a+";rport"}return a};Via.prototype.getHost=function(){if(this.sentBy==null){return null}else{var a=this.sentBy.getHost();if(a==null){return null}else{return a.getHostname()}}};Via.prototype.setPort=function(a){if(a!=-1&&(a<1||a>65535)){console.error("Via:setPort(): port value out of range -1, [1..65535]");throw"Via:setPort(): port value out of range -1, [1..65535]"}if(this.sentBy==null){this.sentBy=new HostPort()}this.sentBy.setPort(a)};Via.prototype.setRPort=function(){this.rPortFlag=true};Via.prototype.getPort=function(){if(this.sentBy==null){return -1}return this.sentBy.getPort()};Via.prototype.getRPort=function(){var b=this.getParameter(this.RPORT);if(b!=null&&!b.equals("")){var a=b-0;return a}else{return -1}};Via.prototype.getTransport=function(){if(this.sentProtocol==null){return null}return this.sentProtocol.getTransport()};Via.prototype.setTransport=function(a){if(a==null){console.error("Via:setTransport(): the transport parameter is null");throw"Via:setTransport(): the transport parameter is null"}if(this.sentProtocol==null){this.sentProtocol=new Protocol()}this.sentProtocol.setTransport(a)};Via.prototype.getProtocol=function(){if(this.sentProtocol==null){return null}return this.sentProtocol.getProtocol()};Via.prototype.setProtocol=function(a){if(a==null){console.error("Via:setProtocol(): the transport parameter is null");throw"Via:setProtocol(): the protocol parameter is null"}if(this.sentProtocol==null){this.sentProtocol=new Protocol()}this.sentProtocol.setProtocol(a)};Via.prototype.getTTL=function(){var a=this.getParameterAsNumber(this.TTL);return a};Via.prototype.setTTL=function(a){if(a<0&&a!=-1){console.error("Via:setTTL():  the ttl parameter is < 0");throw"Via:setTTL(): the ttl parameter is < 0"}a=a-0;this.setParameter_nv(new NameValue(this.TTL,a))};Via.prototype.getMAddr=function(){return this.getParameter(this.MADDR)};Via.prototype.setMAddr=function(b){if(b==null){console.error("Via:setMAddr():  the mAddr parameter is < 0");throw"Via:setMAddr(): the mAddr parameter is < 0"}var c=new Host();c.setAddress(b);var a=new NameValue(this.MADDR,c);this.setParameter_nv(a)};Via.prototype.getReceived=function(){return this.getParameter(this.RECEIVED)};Via.prototype.setReceived=function(a){if(a==null){console.error("Via:setReceived():  the received parameter is < 0");throw"Via:setReceived(): the received parameter is < 0"}this.setParameter(this.RECEIVED,a)};Via.prototype.getBranch=function(){return this.getParameter(this.BRANCH)};Via.prototype.setBranch=function(a){if(a==null||a.length==0){console.error("Via:setBranch():  branch parameter is null or length 0");throw"Via:setBranch(): branch parameter is null or length 0"}this.setParameter(this.BRANCH,a)};Via.prototype.getSentByField=function(){if(this.sentBy!=null){return this.sentBy.encode()}return null};Via.prototype.getSentProtocolField=function(){if(this.sentProtocol!=null){return this.sentProtocol.encode()}return null};function Contact(){this.serialVersionUID="1677294871695706288L";this.classname="Contact";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.address=new AddressImpl();this.Q=this.Q;this.contactList=new ContactList();this.wildCardFlag=null}Contact.prototype=new AddressParametersHeader();Contact.prototype.constructor=Contact;Contact.prototype.NAME="Contact";Contact.prototype.ACTION="action";Contact.prototype.PROXY="proxy";Contact.prototype.REDIRECT="redirect";Contact.prototype.EXPIRES="expires";Contact.prototype.Q="q";Contact.prototype.NAME_ADDR=1;Contact.prototype.SEMICOLON=";";Contact.prototype.SIP_INSTANCE="+sip.instance";Contact.prototype.PUB_GRUU="pub-gruu";Contact.prototype.TEMP_GRUU="temp-gruu";Contact.prototype.setParameter=function(b,c){var a=this.parameters.getNameValue(b);if(a!=null){a.setValueAsObject(c)}else{a=new NameValue(b,c);if(b.toLowerCase()=="methods"){a.setQuotedValue()}this.parameters.set_nv(a)}};Contact.prototype.encodeBody=function(){return this.encodeBodyBuffer("")};Contact.prototype.encodeBodyBuffer=function(a){if(this.wildCardFlag){a=a+"*"}else{if(this.address.getAddressType()==this.NAME_ADDR){a=this.address.encodeBuffer(a)}else{a=a+"<";a=this.address.encodeBuffer(a);a=a+">"}if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}}return a};Contact.prototype.getContactList=function(){return this.contactList};Contact.prototype.getWildCardFlag=function(){return this.wildCardFlag};Contact.prototype.getAddress=function(){return this.address};Contact.prototype.getContactParms=function(){return this.parameters};Contact.prototype.getExpires=function(){return this.getParameterAsNumber(this.EXPIRES)};Contact.prototype.setExpires=function(b){var a=b-0;this.parameters.set_name_value(this.EXPIRES,a)};Contact.prototype.getQValue=function(){return this.getParameterAsNumber(Q)};Contact.prototype.setContactList=function(a){this.contactList=a};Contact.prototype.setWildCardFlag=function(a){this.wildCardFlag=true;this.address=new AddressImpl();this.address.setWildCardFlag()};Contact.prototype.setAddress=function(a){if(a==null){console.error("CSeq:setAddress(): the address parameter is null");throw"CSeq:setAddress(): the address parameter is null"}this.address=a;this.wildCardFlag=false};Contact.prototype.setQValue=function(a){if(a!=-1&&(a<0||a>1)){console.error("CSeq:setQValue(): the qValue is not between 0 and 1");throw"CSeq:setQValue(): Jthe qValue is not between 0 and 1"}var b=new Number(a);this.parameters.set_name_value(Q,b)};Contact.prototype.setWildCard=function(){this.setWildCardFlag(true)};Contact.prototype.isWildCard=function(){return this.address.isWildcard()};Contact.prototype.removeSipInstanceParam=function(){if(this.parameters!=null){this.parameters.delet(this.SIP_INSTANCE)}};Contact.prototype.getSipInstanceParam=function(){return this.parameters.getValue(this.SIP_INSTANCE)};Contact.prototype.setSipInstanceParam=function(a){this.parameters.set_name_value(this.SIP_INSTANCE,a)};Contact.prototype.removePubGruuParam=function(){if(this.parameters!=null){this.parameters.delet(this.PUB_GRUU)}};Contact.prototype.getPubGruuParam=function(){return this.parameters.getValue(this.PUB_GRUU)};Contact.prototype.setPubGruuParam=function(a){this.parameters.set_name_value(this.PUB_GRUU,a)};Contact.prototype.removeTempGruuParam=function(){if(this.parameters!=null){this.parameters.delet(this.TEMP_GRUU)}};Contact.prototype.getTempGruuParam=function(){return this.parameters.getValue(this.TEMP_GRUU)};Contact.prototype.setTempGruuParam=function(a){this.parameters.set_name_value(this.TEMP_GRUU,a)};function MediaRange(){this.serialVersionUID="-6297125815438079210L";this.classname="MediaRange";this.type=null;this.subtype=null}MediaRange.prototype=new SIPObject();MediaRange.prototype.constructor=MediaRange;MediaRange.prototype.SLASH="/";MediaRange.prototype.getType=function(){return this.type};MediaRange.prototype.getSubtype=function(){return this.subtype};MediaRange.prototype.setType=function(a){this.type=a};MediaRange.prototype.setSubtype=function(a){this.subtype=a};MediaRange.prototype.encode=function(){return this.encodeBuffer("").toString()};MediaRange.prototype.encodeBuffer=function(a){a=a+this.type+this.SLASH+this.subtype;return a};function AuthenticationHeader(a){this.classname="AuthenticationHeader";this.headerName=null;this.scheme=null;if(a==null){this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA)}else{this.headerName=a;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}}AuthenticationHeader.prototype=new ParametersHeader();AuthenticationHeader.prototype.constructor=AuthenticationHeader;AuthenticationHeader.prototype.DOMAIN="domain";AuthenticationHeader.prototype.REALM="realm";AuthenticationHeader.prototype.OPAQUE="opaque";AuthenticationHeader.prototype.ALGORITHM="algorithm";AuthenticationHeader.prototype.QOP="qop";AuthenticationHeader.prototype.STALE="stale";AuthenticationHeader.prototype.SIGNATURE="signature";AuthenticationHeader.prototype.RESPONSE="response";AuthenticationHeader.prototype.SIGNED_BY="signed-by";AuthenticationHeader.prototype.NC="nc";AuthenticationHeader.prototype.URI="uri";AuthenticationHeader.prototype.USERNAME="username";AuthenticationHeader.prototype.CNONCE="cnonce";AuthenticationHeader.prototype.NONCE="nonce";AuthenticationHeader.prototype.IK="ik";AuthenticationHeader.prototype.CK="ck";AuthenticationHeader.prototype.INTEGRITY_PROTECTED="integrity-protected";AuthenticationHeader.prototype.COMMA=",";AuthenticationHeader.prototype.DIGEST="Digest";AuthenticationHeader.prototype.DOUBLE_QUOTE='"';AuthenticationHeader.prototype.SP=" ";AuthenticationHeader.prototype.setParameter=function(b,c){var a=this.parameters.getNameValue(b.toLowerCase());if(a==null){a=new NameValue(b,c);if(b.toLowerCase()==this.QOP||b.toLowerCase()==this.REALM||b.toLowerCase()==this.CNONCE||b.toLowerCase()==this.NONCE||b.toLowerCase()==this.USERNAME||b.toLowerCase()==this.DOMAIN||b.toLowerCase()==this.OPAQUE||b.toLowerCase()==this.NEXT_NONCE||b.toLowerCase()==this.URI||b.toLowerCase()==this.RESPONSE||b.toLowerCase()==this.IK||b.toLowerCase()==this.CK||b.toLowerCase()==this.INTEGRITY_PROTECTED){if(((this instanceof Authorization)||(this instanceof ProxyAuthorization))&&b.toLowerCase()==this.QOP){}else{a.setQuotedValue()}if(c==null){console.error("AuthenticationHeader:setParameter(): null value");throw"AuthenticationHeader:setParameter(): null value"}if(c.charAt(0)==this.DOUBLE_QUOTE){console.error("AuthenticationHeader:setParameter(): unexpected DOUBLE_QUOTE");throw"AuthenticationHeader:setParameter(): unexpected DOUBLE_QUOTE"}}this.parameters.set_nv(a)}else{a.setValueAsObject(c)}};AuthenticationHeader.prototype.setChallenge=function(a){this.scheme=a.scheme;this.parameters=a.authParams};AuthenticationHeader.prototype.encodeBody=function(){this.parameters.setSeparator(this.COMMA);return this.scheme+this.SP+this.parameters.encode()};AuthenticationHeader.prototype.setScheme=function(a){this.scheme=a};AuthenticationHeader.prototype.getScheme=function(){return this.scheme};AuthenticationHeader.prototype.setRealm=function(a){if(a==null){console.error("AuthenticationHeader:setRealm(): the realm parameter is null");throw"AuthenticationHeader:setRealm(): the realm parameter is null"}this.setParameter(this.REALM,a)};AuthenticationHeader.prototype.getRealm=function(){return this.getParameter(this.REALM)};AuthenticationHeader.prototype.setNonce=function(a){if(a==null){console.error("AuthenticationHeader:setNonce(): the nonce parameter is null");throw"AuthenticationHeader:setNonce(): the nonce parameter is null"}this.setParameter(this.NONCE,a)};AuthenticationHeader.prototype.getNonce=function(){return this.getParameter(this.NONCE)};AuthenticationHeader.prototype.setURI=function(b){if(b!=null){var a=new NameValue(this.URI,b);a.setQuotedValue();this.parameters.set_nv(a)}else{console.error("AuthenticationHeader:setNonce(): the uri parameter is null");throw"AuthenticationHeader:setURI(): the uri parameter is null"}};AuthenticationHeader.prototype.getURI=function(){return this.getParameterAsURI(this.URI)};AuthenticationHeader.prototype.setAlgorithm=function(a){if(a==null){console.error("AuthenticationHeader:setAlgorithm(): the algorithm parameter is null");throw"AuthenticationHeader:setAlgorithm(): the algorithm parameter is null"}this.setParameter(this.ALGORITHM,a)};AuthenticationHeader.prototype.getAlgorithm=function(){return this.getParameter(this.ALGORITHM)};AuthenticationHeader.prototype.setQop=function(a){if(a==null){console.error("AuthenticationHeader:setQop(): the qop parameter is null");throw"AuthenticationHeader:setQop(): the qop parameter is null"}this.setParameter(this.QOP,a)};AuthenticationHeader.prototype.getQop=function(){return this.getParameter(this.QOP)};AuthenticationHeader.prototype.setOpaque=function(a){if(a==null){console.error("AuthenticationHeader:setOpaque(): the opaque parameter is null");throw"AuthenticationHeader:setOpaque(): the opaque parameter is null"}this.setParameter(this.OPAQUE,a)};AuthenticationHeader.prototype.getOpaque=function(){return this.getParameter(this.OPAQUE)};AuthenticationHeader.prototype.setDomain=function(a){if(a==null){console.error("AuthenticationHeader:setDomain(): the domain parameter is null");throw"AuthenticationHeader:setDomain(): the opaque parameter is null"}this.setParameter(this.DOMAIN,a)};AuthenticationHeader.prototype.getDomain=function(){return this.getParameter(this.DOMAIN)};AuthenticationHeader.prototype.setStale=function(a){this.parameters.set_nv(new NameValue(this.STALE,new Boolean(a)))};AuthenticationHeader.prototype.isStale=function(){return this.getParameterAsBoolean(this.STALE)};AuthenticationHeader.prototype.setCNonce=function(a){this.setParameter(this.CNONCE,a)};AuthenticationHeader.prototype.getCNonce=function(){return this.getParameter(this.CNONCE)};AuthenticationHeader.prototype.getNonceCount=function(){return this.getParameterAsNumber(this.NC)};AuthenticationHeader.prototype.setNonceCount=function(b){if(b<0){console.error("AuthenticationHeader:setNonceCount(): bad parameter");throw"AuthenticationHeader:setNonceCount(): bad parameter"}var c=new String(b);var a="00000000";c=a.substring(0,8-c.length)+c;this.setParameter(this.NC,c)};AuthenticationHeader.prototype.getResponse=function(){return this.getParameter(this.RESPONSE)};AuthenticationHeader.prototype.setResponse=function(a){if(a==null){console.error("AuthenticationHeader:setResponse(): the domain parameter is null");throw"AuthenticationHeader:setResponse():  the opaque parameter is null"}this.setParameter(this.RESPONSE,a)};AuthenticationHeader.prototype.getUsername=function(){return this.getParameter(this.USERNAME)};AuthenticationHeader.prototype.setUsername=function(a){this.setParameter(this.USERNAME,a)};AuthenticationHeader.prototype.setIK=function(a){if(a==null){console.error("AuthenticationHeader:setIK(): the auth-param IK parameter is null");throw"AuthenticationHeader:setIK(): the auth-param IK parameter is null"}this.setParameter(this.IK,a)};AuthenticationHeader.prototype.getIK=function(){return this.getParameter(this.IK)};AuthenticationHeader.prototype.setCK=function(a){if(a==null){console.error("AuthenticationHeader:setCK() the auth-param CK parameter is null");throw"AuthenticationHeader:setCK(): the auth-param CK parameter is null"}this.setParameter(this.CK,a)};AuthenticationHeader.prototype.getCK=function(){return this.getParameter(this.CK)};AuthenticationHeader.prototype.setIntegrityProtected=function(a){if(a==null){console.error("AuthenticationHeader:setIntegrityProtected(): the integrity-protected parameter is null");throw"AuthenticationHeader:setIntegrityProtected(): the integrity-protected parameter is null"}this.setParameter(this.INTEGRITY_PROTECTED,a)};AuthenticationHeader.prototype.getIntegrityProtected=function(){return this.getParameter(this.INTEGRITY_PROTECTED)};function WWWAuthenticate(){this.serialVersionUID="115378648697363486L";this.classname="WWWAuthenticate";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}WWWAuthenticate.prototype=new AuthenticationHeader();WWWAuthenticate.prototype.constructor=WWWAuthenticate;WWWAuthenticate.prototype.NAME="WWW-Authenticate";WWWAuthenticate.prototype.COMMA=",";WWWAuthenticate.prototype.DIGEST="Digest";WWWAuthenticate.prototype.getURI=function(){return null};WWWAuthenticate.prototype.setURI=function(a){};function Route(a){this.serialVersionUID="5683577362998368846L";this.classname="Route";if(a==null){this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.address=a}}Route.prototype=new AddressParametersHeader();Route.prototype.constructor=Route;Route.prototype.NAME="Route";Route.prototype.NAME_ADDR=1;Route.prototype.SEMICOLON=";";Route.prototype.hashCode=function(){var d=0;var a=this.address.getHostPort().encode().toLowerCase();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};Route.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};Route.prototype.encodeBodyBuffer=function(a){var b=this.address.getAddressType()==this.NAME_ADDR;if(!b){a=a+"<";a=this.address.encodeBuffer(a);a=a+">"}else{a=this.address.encodeBuffer(a)}if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};function ProxyAuthenticate(){this.serialVersionUID="-3826145955463251116L";this.classname="ProxyAuthenticate";this.headerName=this.PROXY_AUTHENTICATE;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}ProxyAuthenticate.prototype=new AuthenticationHeader();ProxyAuthenticate.prototype.constructor=ProxyAuthenticate;ProxyAuthenticate.prototype.PROXY_AUTHENTICATE="Proxy-Authenticate";ProxyAuthenticate.prototype.COMMA=",";ProxyAuthenticate.prototype.DIGEST="Digest";ProxyAuthenticate.prototype.getURI=function(){return null};ProxyAuthenticate.prototype.setURI=function(a){};function ProxyAuthorization(){this.serialVersionUID="-6374966905199799098L";this.classname="ProxyAuthorization";this.scheme=null;this.headerName=this.PROXY_AUTHORIZATION;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}ProxyAuthorization.prototype=new AuthenticationHeader();ProxyAuthorization.prototype.constructor=ProxyAuthorization;ProxyAuthorization.prototype.PROXY_AUTHORIZATION="Proxy-Authorization";ProxyAuthorization.prototype.COMMA=",";ProxyAuthorization.prototype.DIGEST="Digest";function StatusLine(){this.serialVersionUID="-4738092215519950414L";this.classname="StatusLine";this.matchStatusClass=null;this.sipVersion=this.SIP_VERSION_STRING;this.statusCode=null;this.reasonPhrase=null}StatusLine.prototype=new SIPObject();StatusLine.prototype.constructor=StatusLine;StatusLine.prototype.SIP_VERSION_STRING="SIP/2.0";StatusLine.prototype.SP=" ";StatusLine.prototype.NEWLINE="\r\n";StatusLine.prototype.match=function(){};StatusLine.prototype.setMatchStatusClass=function(a){this.matchStatusClass=a};StatusLine.prototype.encode=function(){var a=this.SIP_VERSION_STRING+this.SP+this.statusCode;if(this.reasonPhrase!=null){a=a+this.SP+this.reasonPhrase}a=a+this.NEWLINE;return a};StatusLine.prototype.getSipVersion=function(){return this.sipVersion};StatusLine.prototype.getStatusCode=function(){return this.statusCode};StatusLine.prototype.getReasonPhrase=function(){return this.reasonPhrase};StatusLine.prototype.setSipVersion=function(a){this.sipVersion=a};StatusLine.prototype.setStatusCode=function(a){this.statusCode=a};StatusLine.prototype.setReasonPhrase=function(a){this.reasonPhrase=a};StatusLine.prototype.getVersionMajor=function(){if(this.sipVersion==null){return null}var a=null;var c=false;for(var b=0;b<this.sipVersion.length;b++){if(this.sipVersion.charAt(b)=="."){c=false}if(c){if(a==null){a=""+this.sipVersion.charAt(b)}else{a=a+this.sipVersion.charAt(b)}}if(this.sipVersion.charAt(b)=="/"){c=true}}return a};StatusLine.prototype.getVersionMinor=function(){if(this.sipVersion==null){return null}var c=null;var a=false;for(var b=0;b<this.sipVersion.length;b++){if(a){if(c==null){c=""+this.sipVersion.charAt(b)}else{c=c+this.sipVersion.charAt(b)}}if(this.sipVersion.charAt(b)=="."){a=true}}return c};function Authorization(){this.serialVersionUID="-8897770321892281348L";this.classname="Authorization";this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();this.parameters.setSeparator(this.COMMA);this.scheme=this.DIGEST}Authorization.prototype=new AuthenticationHeader();Authorization.prototype.constructor=Authorization;Authorization.prototype.NAME="Authorization";Authorization.prototype.COMMA=",";Authorization.prototype.DIGEST="Digest";function Allow(a){this.serialVersionUID="-3105079479020693930L";this.classname="Allow";this.method=null;if(a==null){this.headerName=this.ALLOW}else{if(arguments.length==1){this.headerName=this.ALLOW;this.method=a}}}Allow.prototype=new SIPHeader();Allow.prototype.constructor=Allow;Allow.prototype.ALLOW="Allow";Allow.prototype.getMethod=function(){return this.method};Allow.prototype.setMethod=function(a){if(a==null){console.error("Allow:setMethod(): JAIN-SIP Exception, the method parameter is null.");throw"Allow:setMethod(): the method parameter is null."}this.method=a};Allow.prototype.encodeBody=function(){return this.method};function RecordRoute(a){this.serialVersionUID="2388023364181727205L";this.classname="RecordRoute";if(a==null){this.headerName=this.RECORD_ROUTE;this.address=new AddressImpl();this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}else{this.headerName=this.NAME;this.address=a;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}}RecordRoute.prototype=new AddressParametersHeader();RecordRoute.prototype.constructor=RecordRoute;RecordRoute.prototype.NAME="Record-Route";RecordRoute.prototype.RECORD_ROUTE="Record-Route";RecordRoute.prototype.ADDRESS_SPEC=2;RecordRoute.prototype.LESS_THAN="<";RecordRoute.prototype.GREATER_THAN=">";RecordRoute.prototype.SEMICOLON=";";RecordRoute.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};RecordRoute.prototype.encodeBodyBuffer=function(a){if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.LESS_THAN}a=this.address.encodeBuffer(a);if(this.address.getAddressType()==this.ADDRESS_SPEC){a=a+this.GREATER_THAN}if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};function MaxForwards(a){this.serialVersionUID="-3096874323347175943L";this.classname="MaxForwards";this.headerName=this.NAME;this.maxForwards=null;if(a==null){this.headerName=this.NAME}else{this.headerName=this.NAME;this.setMaxForwards(a)}}MaxForwards.prototype=new SIPHeader();MaxForwards.prototype.constructor=MaxForwards;MaxForwards.prototype.NAME="Max-Forwards";MaxForwards.prototype.getMaxForwards=function(){return this.maxForwards};MaxForwards.prototype.setMaxForwards=function(a){if(a<0||a>255){console.error("MaxForwards:setMaxForwards(): bad max forwards value "+a);throw"MaxForwards:setMaxForwards(): bad max forwards value "+a}this.maxForwards=a};MaxForwards.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};MaxForwards.prototype.encodeBodyBuffer=function(a){a=a+this.maxForwards;return a};MaxForwards.prototype.hasReachedZero=function(){if(this.maxForwards==0){return true}else{return false}};MaxForwards.prototype.decrementMaxForwards=function(){if(this.maxForwards>0){this.maxForwards--}else{console.error("MaxForwards:decrementMaxForwards(): has already reached 0!");throw"MaxForwards:decrementMaxForwards(): has already reached 0!"}};function ContentType(b,a){this.serialVersionUID="8475682204373446610L";this.classname="ContentType";this.mediaRange=new MediaRange();this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList();if(b!=null&&a!=null){this.setContentType(b,a)}}ContentType.prototype=new ParametersHeader();ContentType.prototype.constructor=ContentType;ContentType.prototype.NAME="Content-Type";ContentType.prototype.SEMICOLON=";";ContentType.prototype.compareMediaRange=function(f){var b=(mediaRange.type+"/"+mediaRange.subtype).toLowerCase();var a=f.toLowerCase();var g=0;var e;if(b.length>=a.length){e=b.length}else{e=a.length}for(var d=0;d<e;d++){if(b.charAt(d)==null){}else{if(b.charAt(d)>a.charAt(d)){g=g+1}else{if(b.charAt(d)<a.charAt(d)){g=g-1}}}}return g};ContentType.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};ContentType.prototype.encodeBodyBuffer=function(a){a=this.mediaRange.encodeBuffer(a);if(this.hasParameters()){a=a+this.SEMICOLON;a=this.parameters.encodeBuffer(a)}return a};ContentType.prototype.getMediaRange=function(){return this.mediaRange};ContentType.prototype.getMediaType=function(){return this.mediaRange.type};ContentType.prototype.getMediaSubType=function(){return this.mediaRange.subtype};ContentType.prototype.getContentSubType=function(){return this.mediaRange==null?null:this.mediaRange.getSubtype()};ContentType.prototype.getContentType=function(){return this.mediaRange==null?null:this.mediaRange.getType()};ContentType.prototype.getCharset=function(){return this.getParameter("charset")};ContentType.prototype.setMediaRange=function(a){this.mediaRange=a};ContentType.prototype.setContentType=function(){if(arguments==1){var b=arguments[0];if(b==null){console.error("ContentType:setContentType(): null argument");throw"ContentType:setContentType(): null argument"}if(this.mediaRange==null){this.mediaRange=new MediaRange()}this.mediaRange.setType(b)}else{b=arguments[0];var a=arguments[1];if(this.mediaRange==null){this.mediaRange=new MediaRange()}this.mediaRange.setType(b);this.mediaRange.setSubtype(a)}};ContentType.prototype.setContentSubType=function(a){if(a==null){console.error("ContentType:setContentSubType(): null contentType parameter");throw"ContentType:setContentSubType(): null contentType parameter"}if(this.mediaRange==null){this.mediaRange=new MediaRange()}this.mediaRange.setSubtype(a)};function TimeStamp(){this.classname="TimeStamp";this.serialVersionUID="-3711322366481232720L";this.timeStamp=-1;this.delay=-1;this.delayFloat=-1;this.timeStampFloat=-1;this.headerName=this.TIMESTAMP}TimeStamp.prototype=new SIPHeader();TimeStamp.prototype.constructor=TimeStamp;TimeStamp.prototype.TIMESTAMP="Timestamp";TimeStamp.prototype.getTimeStampAsString=function(){if(this.timeStamp==-1&&this.timeStampFloat==-1){return""}else{if(this.timeStamp!=-1){return this.timeStamp.toString()}else{return this.timeStampFloat.toString()}}};TimeStamp.prototype.getDelayAsString=function(){if(this.delay==-1&&this.delayFloat==-1){return""}else{if(this.delay!=-1){return this.delay.toString()}else{return this.delayFloat.toString()}}};TimeStamp.prototype.encodeBody=function(){var a="";var c=this.getTimeStampAsString();var b=this.getDelayAsString();if(c==""&&b==""){return""}if(c!=""){a=a+c}if(b!=""){a=a+" "+b}return a.toString()};TimeStamp.prototype.hasDelay=function(){if(this.delay!=-1){return true}else{return false}};TimeStamp.prototype.removeDelay=function(){delay=-1};TimeStamp.prototype.setTimeStamp=function(a){if(a<0){console.error("TimeStamp:setTimeStamp(): the timeStamp parameter is <0");throw"TimeStamp:setTimeStamp(): the timeStamp parameter is <0"}this.timeStamp=-1;this.timeStampFloat=a};TimeStamp.prototype.getTimeStamp=function(){if(this.timeStampFloat==-1){return this.timeStamp}else{return this.timeStampFloat}};TimeStamp.prototype.getDelay=function(){if(this.delayFloat==-1){return this.delay}else{return this.delayFloat}};TimeStamp.prototype.setDelay=function(a){if(a<0&&a!=-1){console.error("TimeStamp:setDelay(): the delay parameter is <0");throw"TimeStamp:setDelay(): the delay parameter is <0"}this.delayFloat=a;this.delay=-1};TimeStamp.prototype.getTime=function(){return this.timeStamp==-1?this.timeStampFloat:this.timeStamp};TimeStamp.prototype.getTimeDelay=function(){return this.delay==-1?this.delayFloat:this.delay};TimeStamp.prototype.setTime=function(a){if(this.timeStamp<-1){console.error("TimeStamp:setTime(): illegal timestamp");throw"TimeStamp:setTime(): illegal timestamp"}this.timeStamp=a;this.timeStampFloat=-1};TimeStamp.prototype.setTimeDelay=function(a){if(a<-1){console.error("TimeStamp:setTimeDelay(): value out of range "+a);throw"TimeStamp:setTimeDelay(): value out of range "+a}this.delay=a;this.delayFloat=-1};function ContentLength(a){this.serialVersionUID="1187190542411037027L";this.classname="ContentLength";this.headerName=this.NAME;this.contentLength=null;if(a==null){this.headerName=this.NAME}else{this.headerName=this.NAME;this.contentLength=a}}ContentLength.prototype=new SIPHeader();ContentLength.prototype.constructor=ContentLength;ContentLength.prototype.NAME="Content-Length";ContentLength.prototype.getContentLength=function(){var a=this.contentLength-0;return a};ContentLength.prototype.setContentLength=function(a){if(a<0){console.error("ContentLength:setContentLength(): the contentLength parameter is < 0");throw"ContentLength:setContentLength(): the contentLength parameter is < 0"}this.contentLength=a};ContentLength.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};ContentLength.prototype.encodeBodyBuffer=function(a){if(this.contentLength==null){a=a+"0"}else{a=a+this.contentLength.toString()}return a};ContentLength.prototype.match=function(a){if(a instanceof ContentLength){return true}else{return false}};function ContentDisposition(a){this.serialVersionUID="835596496276127003L";this.classname="ContentDisposition";this.dispositionType=null;this.headerName=this.NAME;this.parameters=new NameValueList();this.duplicates=new DuplicateNameValueList()}ContentDisposition.prototype=new ParametersHeader();ContentDisposition.prototype.constructor=ContentDisposition;ContentDisposition.prototype.NAME="Content-Disposition";ContentDisposition.prototype.SEMICOLON=";";ContentDisposition.prototype.encodeBody=function(){var a=this.dispositionType;if(this.parameters.hmap.length!=0){a=a+this.SEMICOLON+this.parameters.encode()}return a.toString()};ContentDisposition.prototype.setDispositionType=function(a){if(a==null){console.error("ContentDisposition:setDispositionType(): the dispositionType parameter is null");throw"ContentDisposition:setDispositionType(): the dispositionType parameter is null"}this.dispositionType=a};ContentDisposition.prototype.getDispositionType=function(){return this.dispositionType};ContentDisposition.prototype.getHandling=function(){return this.getParameter("handling")};ContentDisposition.prototype.setHandling=function(a){if(a==null){console.error("ContentDisposition:setHandling(): the handling parameter is null");throw"ContentDisposition:setHandling(): the handling parameter is null"}this.setParameter("handling",a)};ContentDisposition.prototype.getContentDisposition=function(){return this.encodeBody()};function CallIdentifier(){this.serialVersionUID="7314773655675451377L";this.classname="CallIdentifier";this.localId=null;this.host=null;if(arguments.length==2){var a=arguments[0];var b=arguments[1];this.localId=a;this.host=b}else{if(arguments.length==1){var c=arguments[0];this.setCallID(c)}}}CallIdentifier.prototype=new SIPObject();CallIdentifier.prototype.constructor=CallIdentifier;CallIdentifier.prototype.AT="@";CallIdentifier.prototype.encode=function(){return this.encodeBuffer("").toString()};CallIdentifier.prototype.encodeBuffer=function(a){a=a+this.localId;if(this.host!=null){a=a+this.AT+this.host}return a};CallIdentifier.prototype.hashCode=function(){if(this.localId==null){console.error("CallIdentifier:hashCode(): hash code called before id is set");throw"CallIdentifier:hashCode(): hash code called before id is set"}var d=0;var a=this.localId.toLowerCase();if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d};CallIdentifier.prototype.getLocalId=function(){return this.localId};CallIdentifier.prototype.getHost=function(){return this.host};CallIdentifier.prototype.setLocalId=function(a){this.localId=a};CallIdentifier.prototype.setCallID=function(b){if(b==null){console.error("CallIdentifier:setCallID(): cid parameter is null");throw"CallIdentifier:setCallID(): cid parameter is null"}var a=b.indexOf("@");if(a==-1){this.localId=b;this.host=null}else{this.localId=b.substring(0,a);this.host=b.substring(a+1,b.length);if(this.localId==null||this.host==null){console.error("CallIdentifier:setCallID(): CallID  must be token@token or token");throw"CallIdentifier:setCallID(): CallID  must be token@token or token"}}};CallIdentifier.prototype.setHost=function(a){this.host=a};function CallID(){this.serialVersionUID="-6463630258703731156L;";this.classname="CallID";this.headerName=this.NAME;this.callIdentifier=new CallIdentifier();if(arguments.length!=0){var a=arguments[0];this.callIdentifier=new CallIdentifier(a)}}CallID.prototype=new SIPHeader();CallID.prototype.constructor=CallID;CallID.prototype.NAME="Call-ID";CallID.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};CallID.prototype.encodeBodyBuffer=function(a){if(this.callIdentifier!=null){a=this.callIdentifier.encodeBuffer(a)}return a};CallID.prototype.getCallId=function(){return this.encodeBody()};CallID.prototype.getCallIdentifer=function(){return this.callIdentifier};CallID.prototype.setCallId=function(a){this.callIdentifier=new CallIdentifier(a)};CallID.prototype.setCallIdentifier=function(a){this.callIdentifier=a};function CSeq(){this.serialVersionUID="-5405798080040422910L";this.classname="CSeq";this.method=null;this.seqno=null;if(arguments.length==0){this.headerName=this.CSEQ}else{var c=arguments[0];var b=arguments[1];this.headerName=this.CSEQ;this.seqno=c;var a=new SIPRequest();this.method=a.getCannonicalName(b)}}CSeq.prototype=new SIPHeader();CSeq.prototype.constructor=CSeq;CSeq.prototype.CSEQ="CSeq";CSeq.prototype.COLON=":";CSeq.prototype.SP=" ";CSeq.prototype.NEWLINE="\r\n";CSeq.prototype.encode=function(){return this.headerName+this.COLON+this.SP+this.encodeBody()+this.NEWLINE};CSeq.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};CSeq.prototype.encodeBodyBuffer=function(a){a=a+this.seqno+this.SP+this.method.toUpperCase();return a};CSeq.prototype.getMethod=function(){return this.method};CSeq.prototype.setSeqNumber=function(a){if(a<0){console.error("CSeq:setSeqNumber(): the sequence number parameter is < 0 : "+a);throw"CSeq:setSeqNumber(): the sequence number parameter is < 0 : "+a}else{if(a>2147483647){console.error("CSeq:setSeqNumber(): the sequence number parameter is too large : "+a);throw"CSeq:setSeqNumber(): the sequence number parameter is too large : "+a}}this.seqno=a};CSeq.prototype.setSequenceNumber=function(a){this.setSeqNumber(a)};CSeq.prototype.setMethod=function(b){if(b==null){console.error("CSeq:setMethod(): the method parameter is null");throw"CSeq:setMethod(): the meth parameter is null"}var a=new SIPRequest();this.method=a.getCannonicalName(b)};CSeq.prototype.getSequenceNumber=function(){if(this.seqno==null){return 0}else{return this.seqno}};CSeq.prototype.getSeqNumber=function(){return this.seqno};function Supported(a){this.serialVersionUID="-7679667592702854542L";this.classname="Supported";this.optionTag=null;if(a!=null){this.headerName="Supported";this.optionTag=a}else{this.headerName="Supported";this.optionTag=null}}Supported.prototype=new SIPHeader();Supported.prototype.constructor=Supported;Supported.prototype.COLON=":";Supported.prototype.NEWLINE="\r\n";Supported.prototype.encode=function(){var a=this.headerName+this.COLON;if(this.optionTag!=null){a=a+this.SP+this.optionTag}a=a+this.NEWLINE;return a};Supported.prototype.encodeBody=function(){return this.optionTag!=null?this.optionTag:""};Supported.prototype.setOptionTag=function(a){if(a==null){console.error("Supported:setOptionTag(): the optionTag parameter is null");throw"Supported:setOptionTag(): the optionTag parameter is null"}this.optionTag=a};Supported.prototype.getOptionTag=function(){return this.optionTag};function Expires(){this.serialVersionUID="3134344915465784267L";this.classname="Expires";this.headerName=this.NAME;this.expires=null}Expires.prototype=new SIPHeader();Expires.prototype.constructor=Expires;Expires.prototype.NAME="Expires";Expires.prototype.encodeBody=function(){return this.encodeBodyBuffer("").toString()};Expires.prototype.encodeBodyBuffer=function(a){a=a+this.expires;return a};Expires.prototype.getExpires=function(){return this.expires};Expires.prototype.setExpires=function(a){if(a<0){console.error("Expires:setExpires(): bad argument "+a);throw"Expires:setExpires(): bad argument "+a}this.expires=a};function ContactList(){this.serialVersionUID="1224806837758986814L";this.classname="ContactList";this.headerName=this.NAME;this.myClass="Contact";this.hlist=new Array()}ContactList.prototype=new SIPHeaderList();ContactList.prototype.constructor=ContactList;ContactList.prototype.NAME="Contact";ContactList.prototype.clone=function(){};function ViaList(){this.serialVersionUID="3899679374556152313L";this.classname="ViaList";this.headerName=this.NAME;this.myClass="Via";this.hlist=new Array()}ViaList.prototype=new SIPHeaderList();ViaList.prototype.constructor=ViaList;ViaList.prototype.NAME="Via";ViaList.prototype.clone=function(){};function WWWAuthenticateList(){this.serialVersionUID="-6978902284285501346L";this.classname="WWWAuthenticateList";this.headerName=this.NAME;this.myClass="WWWAuthenticate";this.hlist=new Array()}WWWAuthenticateList.prototype=new SIPHeaderList();WWWAuthenticateList.prototype.constructor=WWWAuthenticateList;WWWAuthenticateList.prototype.NAME="WWW-Authenticate";WWWAuthenticateList.prototype.clone=function(){};function RouteList(){this.serialVersionUID="1L";this.classname="RouteList";this.headerName=this.NAME;this.myClass="Route";this.hlist=new Array()}RouteList.prototype=new SIPHeaderList();RouteList.prototype.constructor=RouteList;RouteList.prototype.NAME="Route";RouteList.prototype.clone=function(){};RouteList.prototype.encode=function(){if(this.hlist.length==0){return""}else{return this.encodeBuffer("")}};RouteList.prototype.equals=function(){};function ProxyAuthenticateList(){this.serialVersionUID="1L";this.classname="ProxyAuthenticateList";this.headerName=this.NAME;this.myClass="ProxyAuthenticate";this.hlist=new Array()}ProxyAuthenticateList.prototype=new SIPHeaderList();ProxyAuthenticateList.prototype.constructor=ProxyAuthenticateList;ProxyAuthenticateList.prototype.NAME="Proxy-Authenticate";ProxyAuthenticateList.prototype.clone=function(){};function ProxyAuthorizationList(){this.serialVersionUID="-1L";this.classname="ProxyAuthorizationList";this.headerName=this.NAME;this.myClass="ProxyAuthorization"}ProxyAuthorizationList.prototype=new SIPHeaderList();ProxyAuthorizationList.prototype.constructor=ProxyAuthorizationList;ProxyAuthorizationList.prototype.NAME="Proxy-Authorization";ProxyAuthorizationList.prototype.clone=function(){};function AuthorizationList(){this.serialVersionUID="1L";this.classname="AuthorizationList";this.headerName=this.NAME;this.myClass="Authorization"}AuthorizationList.prototype=new SIPHeaderList();AuthorizationList.prototype.constructor=AuthorizationList;AuthorizationList.prototype.NAME="Authorization";AuthorizationList.prototype.clone=function(){};function AllowList(){this.serialVersionUID="-4699795429662562358L";this.classname="AllowList";this.headerName=this.NAME;this.myClass="Allow";this.hlist=new Array()}AllowList.prototype=new SIPHeaderList();AllowList.prototype.constructor=AllowList;AllowList.prototype.NAME="Allow";AllowList.prototype.clone=function(){};AllowList.prototype.getMethods=function(){var d=new Array();for(var c=0;c<this.hlist.length;c++){var b=this.hlist[c];d[c]=b.getMethod()}return d};AllowList.prototype.setMethods=function(a){var d=new Array();for(var b=0;b<a.length;b++){var c=new Allow();c.setMethod(a[b]);this.add(c)}return d};function RecordRouteList(){this.serialVersionUID="1724940469426766691L";this.classname="RecordRouteList";this.headerName=this.NAME;this.myClass="RecordRoute";this.hlist=new Array()}RecordRouteList.prototype=new SIPHeaderList();RecordRouteList.prototype.constructor=RecordRouteList;RecordRouteList.prototype.NAME="Record-Route";RecordRouteList.prototype.clone=function(){};function SupportedList(){this.serialVersionUID="-4539299544895602367L";this.classname="SupportedList";this.headerName=this.NAME;this.myClass="Supported"}SupportedList.prototype=new SIPHeaderList();SupportedList.prototype.constructor=SupportedList;SupportedList.prototype.NAME="Supported";SupportedList.prototype.clone=function(){};function HeaderFactoryImpl(){this.classname="HeaderFactoryImpl";this.stripAddressScopeZones=false}HeaderFactoryImpl.prototype=new SIPHeaderList();HeaderFactoryImpl.prototype.constructor=HeaderFactoryImpl;HeaderFactoryImpl.prototype.NAME="Authorization";HeaderFactoryImpl.prototype.setPrettyEncoding=function(b){var a=new SIPHeaderList();a.setPrettyEncode(b)};HeaderFactoryImpl.prototype.createAllowEventsHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createAllowEventsHeader(): null arg eventType");throw"HeaderFactoryImpl:createAllowEventsHeader(): null arg eventType"}var b=new AllowEvents();b.setEventType(a);return b};HeaderFactoryImpl.prototype.createAllowHeader=function(b){if(b==null){console.error("HeaderFactoryImpl:createAllowHeader(): null arg method");throw"HeaderFactoryImpl:createAllowHeader(): null arg method"}var a=new Allow();a.setMethod(b);return a};HeaderFactoryImpl.prototype.createCSeqHeader=function(b,c){if(b<0){console.error("HeaderFactoryImpl:createCSeqHeader(): bad arg "+b);throw"HeaderFactoryImpl:createCSeqHeader(): bad arg "+b}if(c==null){console.error("HeaderFactoryImpl:createCSeqHeader(): null arg method");throw"HeaderFactoryImpl:createCSeqHeader(): null arg method"}var a=new CSeq();a.setMethod(c);a.setSeqNumber(b);return a};HeaderFactoryImpl.prototype.createCallIdHeader=function(b){if(b==null){var a=new Date();b=new String(a.getTime())}var d=new CallID();d.setCallId(b);return d};HeaderFactoryImpl.prototype.createContactHeader=function(){if(arguments.length==0){var a=new Contact();a.setWildCardFlag(true);a.setExpires(0);return a}else{var b=arguments[0];if(b==null){console.error("HeaderFactoryImpl:createContactHeader(): null arg address");throw"HeaderFactoryImpl:createContactHeader(): null arg address"}a=new Contact();a.setAddress(b);return a}};HeaderFactoryImpl.prototype.createContentDispositionHeader=function(a){if(a<0){console.error("HeaderFactoryImpl:createContentDispositionHeader(): null arg contentDisposition");throw"HeaderFactoryImpl:createContentDispositionHeader(): null arg contentDisposition"}var b=new ContentDisposition();b.setDispositionType(a);return b};HeaderFactoryImpl.prototype.createContentLengthHeader=function(a){if(a<0){console.error("HeaderFactoryImpl:createContentLengthHeader(): bad contentLength");throw"HeaderFactoryImpl:createContentLengthHeader(): bad contentLength"}var b=new ContentLength();b.setContentLength(a);return b};HeaderFactoryImpl.prototype.createContentTypeHeader=function(d,a){if(d==null||a==null){console.error("HeaderFactoryImpl:createContentTypeHeader(): null contentType or subType");throw"HeaderFactoryImpl:createContentTypeHeader(): null contentType or subType"}var b=new ContentType();b.setContentType(d);b.setContentSubType(a);return b};HeaderFactoryImpl.prototype.createEventHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createEventHeader(): null eventType");throw"HeaderFactoryImpl:createEventHeader(): null eventType"}var b=new Event();b.setEventType(a);return b};HeaderFactoryImpl.prototype.createExpiresHeader=function(a){if(a<0){console.error("HeaderFactoryImpl:createExpiresHeader(): bad value "+a);throw"HeaderFactoryImpl:createExpiresHeader(): bad value "+a}var b=new Expires();b.setExpires(a);return b};HeaderFactoryImpl.prototype.createExtensionHeader=function(a,c){if(a==null){console.error("HeaderFactoryImpl:createExtensionHeader(): bad name");throw"HeaderFactoryImpl:createExtensionHeader(): bad name"}var b=new ExtensionHeaderImpl();b.setName(a);b.setValue(c);return b};HeaderFactoryImpl.prototype.createFromHeader=function(b,a){if(b==null){console.error("HeaderFactoryImpl:createFromHeader(): null address arg");throw"HeaderFactoryImpl:createFromHeader(): null address arg"}var c=new From();c.setAddress(b);if(a!=null){c.setTag(a)}return c};HeaderFactoryImpl.prototype.createMaxForwardsHeader=function(b){if(b<0||b>255){console.error("HeaderFactoryImpl:createMaxForwardsHeader(): bad maxForwards arg "+b);throw"HeaderFactoryImpl:createMaxForwardsHeader(): bad maxForwards arg "+b}var a=new MaxForwards();a.setMaxForwards(b);return a};HeaderFactoryImpl.prototype.createProxyAuthenticateHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createProxyAuthenticateHeader(): null scheme arg");throw"HeaderFactoryImpl:createProxyAuthenticateHeader(): null scheme arg"}var b=new ProxyAuthenticate();b.setScheme(a);return b};HeaderFactoryImpl.prototype.createProxyAuthorizationHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createProxyAuthorizationHeader(): null scheme arg");throw"HeaderFactoryImpl:createProxyAuthorizationHeader():null scheme arg"}var b=new ProxyAuthorization();b.setScheme(a);return b};HeaderFactoryImpl.prototype.createReasonHeader=function(d,a,c){if(d==null){console.error("HeaderFactoryImpl:createReasonHeader(): null protocol arg");throw"HeaderFactoryImpl:createReasonHeader(): null protocol arg"}if(a<0){console.error("HeaderFactoryImpl:createReasonHeader(): bad cause");throw"HeaderFactoryImpl:createReasonHeader():bad cause"}var b=new Reason();b.setProtocol(d);b.setCause(a);b.setText(c);return b};HeaderFactoryImpl.prototype.createRecordRouteHeader=function(b){if(b==null){console.error("HeaderFactoryImpl:createRecordRouteHeader(): null address arg");throw"HeaderFactoryImpl:createRecordRouteHeader(): null address arg"}var a=new RecordRoute();a.setAddress(b);return a};HeaderFactoryImpl.prototype.createRouteHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createRouteHeader(): null address arg");throw"HeaderFactoryImpl:createRouteHeader(): null address arg"}var b=new Route();b.setAddress(a);return b};HeaderFactoryImpl.prototype.createSubjectHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createSubjectHeader(): null subject arg");throw"HeaderFactoryImpl:createSubjectHeader():  null subject arg"}var b=new Subject();b.setSubject(a);return b};HeaderFactoryImpl.prototype.createSupportedHeader=function(b){if(b==null){console.error("HeaderFactoryImpl:createSupportedHeader(): null optionTag arg");throw"HeaderFactoryImpl:createSupportedHeader(): null optionTag arg"}var a=new Supported();a.setOptionTag(b);return a};HeaderFactoryImpl.prototype.createTimeStampHeader=function(a){if(a<0){console.error("HeaderFactoryImpl:createTimeStampHeader(): illegal timeStamp");throw"HeaderFactoryImpl:createTimeStampHeader(): illegal timeStamp"}var b=new TimeStamp();b.setTimeStamp(a);return b};HeaderFactoryImpl.prototype.createToHeader=function(b,a){if(b==null){console.error("HeaderFactoryImpl:createSupportedHeader(): null address arg");throw"HeaderFactoryImpl:createSupportedHeader(): null address arg"}var c=new To();c.setAddress(b);if(a!=null){c.setTag(a)}return c};HeaderFactoryImpl.prototype.createUserAgentHeader=function(b){if(b==null){console.error("HeaderFactoryImpl:createUserAgentHeader(): null product arg");throw"HeaderFactoryImpl:createUserAgentHeader(): null product arg"}var a=new UserAgent();a.setProduct(b);return a};HeaderFactoryImpl.prototype.createViaHeader=function(e,a,f,d){if(e==null||f==null){console.error("HeaderFactoryImpl:createViaHeader(): null host or  transport arg");throw"HeaderFactoryImpl:createViaHeader(): null host or  transport arg"}var b=new Via();if(d!=null){b.setBranch(d)}if(e.indexOf(":")>=0&&e.indexOf("[")<0){if(this.stripAddressScopeZones){var c=e.indexOf("%");if(c!=-1){e=e.substring(0,c)}}e="["+e+"]"}b.setHost(e);if(a!=null){b.setPort(a)}if(f!=null){b.setTransport(f)}else{b.setTransport("WS")}return b};HeaderFactoryImpl.prototype.createWWWAuthenticateHeader=function(a){if(a==null){console.error("HeaderFactoryImpl:createWWWAuthenticateHeader(): null scheme arg");throw"HeaderFactoryImpl:createWWWAuthenticateHeader(): null scheme arg"}var b=new WWWAuthenticate();b.setScheme(a);return b};HeaderFactoryImpl.prototype.createHeader=function(){if(arguments.length==1){var b=arguments[0];var f=new StringMsgParser();var e=f.parseSIPHeader(b.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,""));if(e instanceof SIPHeaderList){if(e.size()>1){console.error("HeaderFactoryImpl:createHeader(): only singleton allowed "+b);throw"HeaderFactoryImpl:createHeader():only singleton allowed "+b}else{if(e.size()==0){var d=e.getMyClass();var h=new Function("return new "+d)();return h}else{return e.getFirst()}}}else{return e}}else{if(arguments.length==2){var g=arguments[0];var a=arguments[1];if(g==null){console.error("header name is null");console.error("HeaderFactoryImpl:createHeader(): header name is null");throw"HeaderFactoryImpl:createHeader(): header name is null"}var c=g+":"+a;return this.createHeader(c)}}};HeaderFactoryImpl.prototype.createHeaders=function(c){if(c==null){console.error("HeaderFactoryImpl:createHeaders(): null headers arg");throw"HeaderFactoryImpl:createHeaders(): null headers arg"}var b=new StringMsgParser();var a=b.parseSIPHeader(c);if(a instanceof SIPHeaderList){return a}else{console.error("HeaderFactoryImpl:createHeaders():List of headers of this type is not allowed in a message",0);throw"HeaderFactoryImpl:createHeaders(): list of headers of this type is not allowed in a message"}};HeaderFactoryImpl.prototype.createRouteList=function(f){if(f!=null){var e=new RouteList();for(var d=f.getHeaderList().length-1;d>=0;d--){var c=f.getHeaderList()[d];var b=new Route();var a=c.getAddress();b.setAddress(a);b.setParameters(c.getParameters());e.add(b)}return e}else{return new RouteList()}};HeaderFactoryImpl.prototype.createRequestLine=function(b){var a=new RequestLineParser(b);return a.parse()};HeaderFactoryImpl.prototype.createStatusLine=function(a){var b=new StatusLineParser(a);return b.parse()};HeaderFactoryImpl.prototype.createAuthorizationHeader=function(){if(arguments.length==1){var d=arguments[0];return this.createAuthorizationHeaderargu1(d)}else{var c=arguments[0];var e=arguments[1];var b=arguments[2];var f=arguments[3];var a=arguments[4];return this.createAuthorizationHeaderargu2(c,e,b,f)}};HeaderFactoryImpl.prototype.createAuthorizationHeaderargu1=function(a){if(a==null){console.error("HeaderFactoryImpl:createAuthorizationHeaderargu1(): null scheme arg");throw"HeaderFactoryImpl:createAuthorizationHeaderargu1(): null scheme arg"}var b=new Authorization();b.setScheme(a);return b};HeaderFactoryImpl.prototype.createAuthorizationHeaderargu2=function(g,h,c,e){if(g.hasHeader("www-authenticate")){var l=g.getWWWAuthenticate().getRealm();var d=g.getWWWAuthenticate().getScheme();var m=g.getWWWAuthenticate().getNonce();var b=g.getWWWAuthenticate().getQop();var n=new Authorization()}else{if(g.hasHeader("proxy-authenticate")){l=g.getProxyAuthenticate().getRealm();d=g.getProxyAuthenticate().getScheme();m=g.getProxyAuthenticate().getNonce();var q=new ProxyAuthorization();b=g.getWWWAuthenticate().getQop()}}var p=new MessageDigestAlgorithm();var a=g.getCSeq().getMethod();var r=Math.floor(Math.random()*16777215).toString(16);var j="00000001";var f=p.calculateResponse(e,l,c,m,j,r,a,h.getRequestURI(),null,b);if(g.hasHeader("www-authenticate")){n.setUsername(e);n.setRealm(l);n.setNonce(m);n.setCNonce(r);n.setNonceCount(j);n.setScheme(d);n.setResponse(f);n.setURI(h.getRequestURI());n.setAlgorithm("MD5");n.setQop(b);return n}else{if(g.hasHeader("proxy-authenticate")){q.setUsername(e);q.setRealm(l);q.setNonce(m);n.setCNonce(r);n.setNonceCount(j);q.setScheme(d);q.setResponse(f);q.setURI(h.getRequestURI());q.setAlgorithm("MD5");return q}}};function Parser(){this.classname="Parser"}Parser.prototype=new ParserCore();Parser.prototype.constructor=Parser;Parser.prototype.INVITE=LexerCore.prototype.START+5;Parser.prototype.ACK=LexerCore.prototype.START+6;Parser.prototype.OPTIONS=LexerCore.prototype.START+8;Parser.prototype.BYE=LexerCore.prototype.START+7;Parser.prototype.REGISTER=LexerCore.prototype.START+4;Parser.prototype.CANCEL=LexerCore.prototype.START+9;Parser.prototype.SUBSCRIBE=LexerCore.prototype.START+53;Parser.prototype.NOTIFY=LexerCore.prototype.START+54;Parser.prototype.PUBLISH=LexerCore.prototype.START+67;Parser.prototype.MESSAGE=LexerCore.prototype.START+70;Parser.prototype.ID=LexerCore.prototype.ID;Parser.prototype.SIP=LexerCore.prototype.START+3;Parser.prototype.createParseException=function(){};Parser.prototype.getLexer=function(){return this.lexer};Parser.prototype.sipVersion=function(){var a=this.lexer.match(this.SIP);if(a.getTokenValue().toUpperCase()!="SIP"){this.createParseException("Expecting SIP")}this.lexer.match("/");a=this.lexer.match(this.ID);if(a.getTokenValue()!="2.0"){this.createParseException("Expecting SIP/2.0")}return"SIP/2.0"};Parser.prototype.method=function(){var b=this.lexer.peekNextToken(1);var a=b[0];if(a.getTokenType()==this.INVITE||a.getTokenType()==this.ACK||a.getTokenType()==this.OPTIONS||a.getTokenType()==this.BYE||a.getTokenType()==this.REGISTER||a.getTokenType()==this.CANCEL||a.getTokenType()==this.SUBSCRIBE||a.getTokenType()==this.NOTIFY||a.getTokenType()==this.PUBLISH||a.getTokenType()==this.MESSAGE||a.getTokenType()==this.ID){this.lexer.consume();return a.getTokenValue()}else{console.error("Parser:method(): invalid Method");throw"Parser:method(): invalid Method"}};Parser.prototype.checkToken=function(b){if(b==null||b.length==0){console.error("Parser:checkToken(): null or empty token");throw"Parser:method(): null or empty token"}else{for(var a=0;a<b.length;++a){var c=new LexerCore();if(!c.isTokenChar(b.charAt(a))){console.error("Parser:checkToken(): invalid character(s) in string (not allowed in 'token')",a);throw"Parser:method(): invalid character(s) in string (not allowed in 'token')"}}}};function Lexer(b,a){this.classname="Lexer";this.buffer=a;this.bufferLen=a.length;this.ptr=0;this.currentLexer=new Array();this.currentLexerName=b;this.selectLexer(b)}Lexer.prototype=new LexerCore();Lexer.prototype.constructor=Lexer;Lexer.prototype.ErrorInfoHeader="Error-Info";Lexer.prototype.AllowEventsHeader="Allow-Events";Lexer.prototype.AuthenticationInfoHeader="Authentication-Info";Lexer.prototype.EventHeader="Event";Lexer.prototype.MinExpiresHeader="Min-Expires";Lexer.prototype.RSeqHeader="RSeq";Lexer.prototype.RAckHeader="RAck";Lexer.prototype.ReasonHeader="Reason";Lexer.prototype.ReplyToHeader="Reply-To";Lexer.prototype.SubscriptionStateHeader="Subscription-State";Lexer.prototype.TimeStampHeader="Timestamp";Lexer.prototype.InReplyToHeader="In-Reply-To";Lexer.prototype.MimeVersionHeader="MIME-Version";Lexer.prototype.AlertInfoHeader="Alert-Info";Lexer.prototype.FromHeader="From";Lexer.prototype.ToHeader="To";Lexer.prototype.ReferToHeader="Refer-To";Lexer.prototype.ViaHeader="Via";Lexer.prototype.UserAgentHeader="User-Agent";Lexer.prototype.ServerHeader="Server";Lexer.prototype.AcceptEncodingHeader="Accept-Encoding";Lexer.prototype.AcceptHeader="Accept";Lexer.prototype.AllowHeader="Allow";Lexer.prototype.RouteHeader="Route";Lexer.prototype.AuthorizationHeader="Authorization";Lexer.prototype.ProxyAuthorizationHeader="Proxy-Authorization";Lexer.prototype.RetryAfterHeader="Retry-After";Lexer.prototype.ProxyRequireHeader="Proxy-Require";Lexer.prototype.ContentLanguageHeader="Content-Language";Lexer.prototype.UnsupportedHeader="Unsupported";Lexer.prototype.SupportedHeader="Supported";Lexer.prototype.WarningHeader="Warning";Lexer.prototype.MaxForwardsHeader="Max-Forwards";Lexer.prototype.DateHeader="Date";Lexer.prototype.PriorityHeader="Priority";Lexer.prototype.ProxyAuthenticateHeader="Proxy-Authenticate";Lexer.prototype.ContentEncodingHeader="Content-Encoding";Lexer.prototype.ContentLengthHeader="Content-Length";Lexer.prototype.SubjectHeader="Subject";Lexer.prototype.ContentTypeHeader="Content-Type";Lexer.prototype.ContactHeader="Contact";Lexer.prototype.CallIdHeader="Call-ID";Lexer.prototype.RequireHeader="Require";Lexer.prototype.ExpiresHeader="Expires";Lexer.prototype.RecordRouteHeader="Record-Route";Lexer.prototype.OrganizationHeader="Organization";Lexer.prototype.CSeqHeader="CSeq";Lexer.prototype.AcceptLanguageHeader="Accept-Language";Lexer.prototype.WWWAuthenticateHeader="WWW-Authenticate";Lexer.prototype.CallInfoHeader="Call-Info";Lexer.prototype.ContentDispositionHeader="Content-Disposition";Lexer.prototype.SIPETagHeader="SIP-ETag";Lexer.prototype.SIPIfMatchHeader="SIP-If-Match";Lexer.prototype.SessionExpiresHeader="Session-Expires";Lexer.prototype.MinSEHeader="Min-SE";Lexer.prototype.ReferredByHeader="Referred-By";Lexer.prototype.ReplacesHeader="Replaces";Lexer.prototype.JoinHeader="Join";Lexer.prototype.PathHeader="Path";Lexer.prototype.ServiceRouteHeader="Service-Route";Lexer.prototype.PAssertedIdentityHeader="P-Asserted-Identity";Lexer.prototype.PPreferredIdentityHeader="P-Preferred-Identity";Lexer.prototype.PrivacyHeader="Privacy";Lexer.prototype.PCalledPartyIDHeader="P-Called-Party-ID";Lexer.prototype.PAssociatedURIHeader="P-Associated-URI";Lexer.prototype.PVisitedNetworkIDHeader="P-Visited-Network-ID";Lexer.prototype.PChargingFunctionAddressesHeader="P-Charging-Function-Addresses";Lexer.prototype.PChargingVectorHeader="P-Charging-Vector";Lexer.prototype.PAccessNetworkInfoHeader="P-Access-Network-Info";Lexer.prototype.PMediaAuthorizationHeader="P-Media-Authorization";Lexer.prototype.SecurityServerHeader="Security-Server";Lexer.prototype.SecurityVerifyHeader="Security-Verify";Lexer.prototype.SecurityClientHeader="Security-Client";Lexer.prototype.PUserDatabaseHeader="P-User-Database";Lexer.prototype.PProfileKeyHeader="P-Profile-Key";Lexer.prototype.PServedUserHeader="P-Served-User";Lexer.prototype.PPreferredServiceHeader="P-Preferred-Service";Lexer.prototype.PAssertedServiceHeader="P-Asserted-Service";Lexer.prototype.ReferencesHeader="References";Lexer.prototype.AcceptContact="Accept-Contact";Lexer.prototype.getHeaderName=function(a){if(a==null){return null}var d=null;try{var c=a.indexOf(":");d=null;if(c>=1){d=a.substring(0,c).replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"")}}catch(b){console.error("Lexer:getHeaderName(): catched exception:"+b);return null}return d};Lexer.prototype.getHeaderValue=function(a){if(a==null){return null}var d=null;try{var c=a.indexOf(":");d=a.substring(c+1)}catch(b){console.error("Lexer:getHeaderValue(): catched exception:"+b);return null}return d};Lexer.prototype.selectLexer=function(c){var b=null;for(var a=0;a<this.lexerTables.length;a++){if(this.lexerTables[a][0]==c){b=a}}if(b!=null){this.currentLexer=this.lexerTables[b][1]}this.currentLexerName=c;if(this.currentLexer.length==0){this.addLexer(c);if(c=="method_keywordLexer"){this.addKeyword(TokenNames.prototype.REGISTER,TokenTypes.prototype.REGISTER);this.addKeyword(TokenNames.prototype.ACK,TokenTypes.prototype.ACK);this.addKeyword(TokenNames.prototype.OPTIONS,TokenTypes.prototype.OPTIONS);this.addKeyword(TokenNames.prototype.BYE,TokenTypes.prototype.BYE);this.addKeyword(TokenNames.prototype.INVITE,TokenTypes.prototype.INVITE);this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP);this.addKeyword(TokenNames.prototype.SIPS.toUpperCase(),TokenTypes.prototype.SIPS);this.addKeyword(TokenNames.prototype.SUBSCRIBE,TokenTypes.prototype.SUBSCRIBE);this.addKeyword(TokenNames.prototype.NOTIFY,TokenTypes.prototype.NOTIFY);this.addKeyword(TokenNames.prototype.MESSAGE,TokenTypes.prototype.MESSAGE);this.addKeyword(TokenNames.prototype.PUBLISH,TokenTypes.prototype.PUBLISH)}else{if(c=="command_keywordLexer"){this.addKeyword(this.ErrorInfoHeader.toUpperCase(),TokenTypes.prototype.ERROR_INFO);this.addKeyword(this.AllowEventsHeader.toUpperCase(),TokenTypes.prototype.ALLOW_EVENTS);this.addKeyword(this.AuthenticationInfoHeader.toUpperCase(),TokenTypes.prototype.AUTHENTICATION_INFO);this.addKeyword(this.EventHeader.toUpperCase(),TokenTypes.prototype.EVENT);this.addKeyword(this.MinExpiresHeader.toUpperCase(),TokenTypes.prototype.MIN_EXPIRES);this.addKeyword(this.RSeqHeader.toUpperCase(),TokenTypes.prototype.RSEQ);this.addKeyword(this.RAckHeader.toUpperCase(),TokenTypes.prototype.RACK);this.addKeyword(this.ReasonHeader.toUpperCase(),TokenTypes.prototype.REASON);this.addKeyword(this.ReplyToHeader.toUpperCase(),TokenTypes.prototype.REPLY_TO);this.addKeyword(this.SubscriptionStateHeader.toUpperCase(),TokenTypes.prototype.SUBSCRIPTION_STATE);this.addKeyword(this.TimeStampHeader.toUpperCase(),TokenTypes.prototype.TIMESTAMP);this.addKeyword(this.InReplyToHeader.toUpperCase(),TokenTypes.prototype.IN_REPLY_TO);this.addKeyword(this.MimeVersionHeader.toUpperCase(),TokenTypes.prototype.MIME_VERSION);this.addKeyword(this.AlertInfoHeader.toUpperCase(),TokenTypes.prototype.ALERT_INFO);this.addKeyword(this.FromHeader.toUpperCase(),TokenTypes.prototype.FROM);this.addKeyword(this.ToHeader.toUpperCase(),TokenTypes.prototype.TO);this.addKeyword(this.ReferToHeader.toUpperCase(),TokenTypes.prototype.REFER_TO);this.addKeyword(this.ViaHeader.toUpperCase(),TokenTypes.prototype.VIA);this.addKeyword(this.UserAgentHeader.toUpperCase(),TokenTypes.prototype.USER_AGENT);this.addKeyword(this.ServerHeader.toUpperCase(),TokenTypes.prototype.SERVER);this.addKeyword(this.AcceptEncodingHeader.toUpperCase(),TokenTypes.prototype.ACCEPT_ENCODING);this.addKeyword(this.AcceptHeader.toUpperCase(),TokenTypes.prototype.ACCEPT);this.addKeyword(this.AllowHeader.toUpperCase(),TokenTypes.prototype.ALLOW);this.addKeyword(this.RouteHeader.toUpperCase(),TokenTypes.prototype.ROUTE);this.addKeyword(this.AuthorizationHeader.toUpperCase(),TokenTypes.prototype.AUTHORIZATION);this.addKeyword(this.ProxyAuthorizationHeader.toUpperCase(),TokenTypes.prototype.PROXY_AUTHORIZATION);this.addKeyword(this.RetryAfterHeader.toUpperCase(),TokenTypes.prototype.RETRY_AFTER);this.addKeyword(this.ProxyRequireHeader.toUpperCase(),TokenTypes.prototype.PROXY_REQUIRE);this.addKeyword(this.ContentLanguageHeader.toUpperCase(),TokenTypes.prototype.CONTENT_LANGUAGE);this.addKeyword(this.UnsupportedHeader.toUpperCase(),TokenTypes.prototype.UNSUPPORTED);this.addKeyword(this.SupportedHeader.toUpperCase(),TokenTypes.prototype.SUPPORTED);this.addKeyword(this.WarningHeader.toUpperCase(),TokenTypes.prototype.WARNING);this.addKeyword(this.MaxForwardsHeader.toUpperCase(),TokenTypes.prototype.MAX_FORWARDS);this.addKeyword(this.DateHeader.toUpperCase(),TokenTypes.prototype.DATE);this.addKeyword(this.PriorityHeader.toUpperCase(),TokenTypes.prototype.PRIORITY);this.addKeyword(this.ProxyAuthenticateHeader.toUpperCase(),TokenTypes.prototype.PROXY_AUTHENTICATE);this.addKeyword(this.ContentEncodingHeader.toUpperCase(),TokenTypes.prototype.CONTENT_ENCODING);this.addKeyword(this.ContentLengthHeader.toUpperCase(),TokenTypes.prototype.CONTENT_LENGTH);this.addKeyword(this.SubjectHeader.toUpperCase(),TokenTypes.prototype.SUBJECT);this.addKeyword(this.ContentTypeHeader.toUpperCase(),TokenTypes.prototype.CONTENT_TYPE);this.addKeyword(this.ContactHeader.toUpperCase(),TokenTypes.prototype.CONTACT);this.addKeyword(this.CallIdHeader.toUpperCase(),TokenTypes.prototype.CALL_ID);this.addKeyword(this.RequireHeader.toUpperCase(),TokenTypes.prototype.REQUIRE);this.addKeyword(this.ExpiresHeader.toUpperCase(),TokenTypes.prototype.EXPIRES);this.addKeyword(this.RecordRouteHeader.toUpperCase(),TokenTypes.prototype.RECORD_ROUTE);this.addKeyword(this.OrganizationHeader.toUpperCase(),TokenTypes.prototype.ORGANIZATION);this.addKeyword(this.CSeqHeader.toUpperCase(),TokenTypes.prototype.CSEQ);this.addKeyword(this.AcceptLanguageHeader.toUpperCase(),TokenTypes.prototype.ACCEPT_LANGUAGE);this.addKeyword(this.WWWAuthenticateHeader.toUpperCase(),TokenTypes.prototype.WWW_AUTHENTICATE);this.addKeyword(this.CallInfoHeader.toUpperCase(),TokenTypes.prototype.CALL_INFO);this.addKeyword(this.ContentDispositionHeader.toUpperCase(),TokenTypes.prototype.CONTENT_DISPOSITION);this.addKeyword(TokenNames.prototype.K.toUpperCase(),TokenTypes.prototype.SUPPORTED);this.addKeyword(TokenNames.prototype.C.toUpperCase(),TokenTypes.prototype.CONTENT_TYPE);this.addKeyword(TokenNames.prototype.E.toUpperCase(),TokenTypes.prototype.CONTENT_ENCODING);this.addKeyword(TokenNames.prototype.F.toUpperCase(),TokenTypes.prototype.FROM);this.addKeyword(TokenNames.prototype.I.toUpperCase(),TokenTypes.prototype.CALL_ID);this.addKeyword(TokenNames.prototype.M.toUpperCase(),TokenTypes.prototype.CONTACT);this.addKeyword(TokenNames.prototype.L.toUpperCase(),TokenTypes.prototype.CONTENT_LENGTH);this.addKeyword(TokenNames.prototype.S.toUpperCase(),TokenTypes.prototype.SUBJECT);this.addKeyword(TokenNames.prototype.T.toUpperCase(),TokenTypes.prototype.TO);this.addKeyword(TokenNames.prototype.U.toUpperCase(),TokenTypes.prototype.ALLOW_EVENTS);this.addKeyword(TokenNames.prototype.V.toUpperCase(),TokenTypes.prototype.VIA);this.addKeyword(TokenNames.prototype.R.toUpperCase(),TokenTypes.prototype.REFER_TO);this.addKeyword(TokenNames.prototype.O.toUpperCase(),TokenTypes.prototype.EVENT);this.addKeyword(TokenNames.prototype.X.toUpperCase(),TokenTypes.prototype.SESSIONEXPIRES_TO);this.addKeyword(this.SIPETagHeader.toUpperCase(),TokenTypes.prototype.SIP_ETAG);this.addKeyword(this.SIPIfMatchHeader.toUpperCase(),TokenTypes.prototype.SIP_IF_MATCH);this.addKeyword(this.SessionExpiresHeader.toUpperCase(),TokenTypes.prototype.SESSIONEXPIRES_TO);this.addKeyword(this.MinSEHeader.toUpperCase(),TokenTypes.prototype.MINSE_TO);this.addKeyword(this.ReferredByHeader.toUpperCase(),TokenTypes.prototype.REFERREDBY_TO);this.addKeyword(TokenNames.prototype.B.toUpperCase(),TokenTypes.prototype.REFERREDBY_TO);this.addKeyword(this.ReplacesHeader.toUpperCase(),TokenTypes.prototype.REPLACES_TO);this.addKeyword(this.JoinHeader.toUpperCase(),TokenTypes.prototype.JOIN_TO);this.addKeyword(this.PathHeader.toUpperCase(),TokenTypes.prototype.PATH);this.addKeyword(this.ServiceRouteHeader.toUpperCase(),TokenTypes.prototype.SERVICE_ROUTE);this.addKeyword(this.PAssertedIdentityHeader.toUpperCase(),TokenTypes.prototype.P_ASSERTED_IDENTITY);this.addKeyword(this.PPreferredIdentityHeader.toUpperCase(),TokenTypes.prototype.P_PREFERRED_IDENTITY);this.addKeyword(this.PrivacyHeader.toUpperCase(),TokenTypes.prototype.PRIVACY);this.addKeyword(this.PCalledPartyIDHeader.toUpperCase(),TokenTypes.prototype.P_CALLED_PARTY_ID);this.addKeyword(this.PAssociatedURIHeader.toUpperCase(),TokenTypes.prototype.P_ASSOCIATED_URI);this.addKeyword(this.PVisitedNetworkIDHeader.toUpperCase(),TokenTypes.prototype.P_VISITED_NETWORK_ID);this.addKeyword(this.PChargingFunctionAddressesHeader.toUpperCase(),TokenTypes.prototype.P_CHARGING_FUNCTION_ADDRESSES);this.addKeyword(this.PChargingVectorHeader.toUpperCase(),TokenTypes.prototype.P_VECTOR_CHARGING);this.addKeyword(this.PAccessNetworkInfoHeader.toUpperCase(),TokenTypes.prototype.P_ACCESS_NETWORK_INFO);this.addKeyword(this.PMediaAuthorizationHeader.toUpperCase(),TokenTypes.prototype.P_MEDIA_AUTHORIZATION);this.addKeyword(this.SecurityServerHeader.toUpperCase(),TokenTypes.prototype.SECURITY_SERVER);this.addKeyword(this.SecurityVerifyHeader.toUpperCase(),TokenTypes.prototype.SECURITY_VERIFY);this.addKeyword(this.SecurityClientHeader.toUpperCase(),TokenTypes.prototype.SECURITY_CLIENT);this.addKeyword(this.PUserDatabaseHeader.toUpperCase(),TokenTypes.prototype.P_USER_DATABASE);this.addKeyword(this.PProfileKeyHeader.toUpperCase(),TokenTypes.prototype.P_PROFILE_KEY);this.addKeyword(this.PServedUserHeader.toUpperCase(),TokenTypes.prototype.P_SERVED_USER);this.addKeyword(this.PPreferredServiceHeader.toUpperCase(),TokenTypes.prototype.P_PREFERRED_SERVICE);this.addKeyword(this.PAssertedServiceHeader.toUpperCase(),TokenTypes.prototype.P_ASSERTED_SERVICE);this.addKeyword(this.ReferencesHeader.toUpperCase(),TokenTypes.prototype.REFERENCES);this.addKeyword(this.AcceptContact.toUpperCase(),TokenTypes.prototype.ACCEPT_CONTACT)}else{if(c=="status_lineLexer"){this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP)}else{if(c=="request_lineLexer"){this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP)}else{if(c=="sip_urlLexer"){this.addKeyword(TokenNames.prototype.TEL.toUpperCase(),TokenTypes.prototype.TEL);this.addKeyword(TokenNames.prototype.SIP.toUpperCase(),TokenTypes.prototype.SIP);this.addKeyword(TokenNames.prototype.SIPS.toUpperCase(),TokenTypes.prototype.SIPS)}}}}}}};function HeaderParser(){this.classname="HeaderParser";if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}else{if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}}}HeaderParser.prototype=new Parser();HeaderParser.prototype.constructor=HeaderParser;HeaderParser.prototype.wkday=function(){var a=this.lexer.ttoken();var b=a.toLowerCase();if(TokenNames.prototype.MON==b.toLowerCase()){return 2}else{if(TokenNames.prototype.TUE.toLowerCase()==b.toLowerCase()){return 3}else{if(TokenNames.prototype.WED.toLowerCase()==b.toLowerCase()){return 4}else{if(TokenNames.prototype.THU.toLowerCase()==b.toLowerCase()){return 5}else{if(TokenNames.prototype.FRI.toLowerCase()==b.toLowerCase()){return 6}else{if(TokenNames.prototype.SAT.toLowerCase()==b.toLowerCase()){return 7}else{if(TokenNames.prototype.SUN.toLowerCase()==b.toLowerCase()){return 1}else{console.error("HeaderParser:wkday(): bad wkday");throw"HeaderParser:wkday(): bad wkday"}}}}}}}};HeaderParser.prototype.date=function(){try{var a=new Date();var e=this.lexer.number();var b=e+0;if(b<=0||b>31){console.error("HeaderParser:date(): bad day");throw"HeaderParser:date():  bad day"}a.set(5,b);this.lexer.match(" ");var g=this.lexer.ttoken().toLowerCase();if(g.equals("jan")){a.setMonth(0)}else{if(g=="feb"){a.setMonth(1)}else{if(g=="mar"){a.setMonth(2)}else{if(g=="apr"){a.setMonth(3)}else{if(g=="may"){a.setMonth(4)}else{if(g=="jun"){a.setMonth(5)}else{if(g=="jul"){a.setMonth(6)}else{if(g=="aug"){a.setMonth(7)}else{if(g=="sep"){a.setMonth(8)}else{if(g=="oct"){a.setMonth(9)}else{if(g=="nov"){a.setMonth(10)}else{if(g=="dec"){a.setMonth(11)}}}}}}}}}}}}this.lexer.match(" ");var c=this.lexer.number();var f=c;a.setYear(f);return a}catch(d){console.error("HeaderParser:date(): bad date field");throw"HeaderParser:date(): bad date field"}};HeaderParser.prototype.time=function(f){try{var e=this.lexer.number();var a=e;f.setHours(a);this.lexer.match(":");e=this.lexer.number();var c=e;f.setMinutes(c);this.lexer.match(":");e=this.lexer.number();var d=e;f.setSeconds(d)}catch(b){console.error("HeaderParser:time(): error processing time ");throw"HeaderParser:time():error processing time "}};HeaderParser.prototype.parse=function(){var c=this.lexer.getNextToken(":");this.lexer.consume(1);var a=this.lexer.getLine().replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"");var b=new ExtensionHeaderImpl(c);b.setValue(a);return b};HeaderParser.prototype.headerName=function(a){this.lexer.match(a);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT()};function ParametersParser(){this.classname="ParametersParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ParametersParser.prototype=new HeaderParser();ParametersParser.prototype.constructor=ParametersParser;ParametersParser.prototype.parse=function(b){this.lexer.SPorHT();while(this.lexer.lookAhead(0)==";"){this.lexer.consume(1);this.lexer.SPorHT();var a=this.nameValue();b.setParameter_nv(a);this.lexer.SPorHT()}};ParametersParser.prototype.parseNameValueList=function(b){b.removeParameters();while(true){this.lexer.SPorHT();var a=nameValue();b.setParameter(a.getName(),a.getValueAsObject());this.lexer.SPorHT();if(this.lexer.lookAhead(0)!=";"){break}else{this.lexer.consume(1)}}};function TokenTypes(){this.classname="TokenTypes"}TokenTypes.prototype.constructor=Parser;TokenTypes.prototype.START=LexerCore.prototype.START;TokenTypes.prototype.END=LexerCore.prototype.END;TokenTypes.prototype.SIP=LexerCore.prototype.START+3;TokenTypes.prototype.REGISTER=LexerCore.prototype.START+4;TokenTypes.prototype.INVITE=LexerCore.prototype.START+5;TokenTypes.prototype.ACK=LexerCore.prototype.START+6;TokenTypes.prototype.BYE=LexerCore.prototype.START+7;TokenTypes.prototype.OPTIONS=LexerCore.prototype.START+8;TokenTypes.prototype.CANCEL=LexerCore.prototype.START+9;TokenTypes.prototype.ERROR_INFO=LexerCore.prototype.START+10;TokenTypes.prototype.IN_REPLY_TO=LexerCore.prototype.START+11;TokenTypes.prototype.MIME_VERSION=LexerCore.prototype.START+12;TokenTypes.prototype.ALERT_INFO=LexerCore.prototype.START+13;TokenTypes.prototype.FROM=LexerCore.prototype.START+14;TokenTypes.prototype.TO=LexerCore.prototype.START+15;TokenTypes.prototype.VIA=LexerCore.prototype.START+16;TokenTypes.prototype.USER_AGENT=LexerCore.prototype.START+17;TokenTypes.prototype.SERVER=LexerCore.prototype.START+18;TokenTypes.prototype.ACCEPT_ENCODING=LexerCore.prototype.START+19;TokenTypes.prototype.ACCEPT=LexerCore.prototype.START+20;TokenTypes.prototype.ALLOW=LexerCore.prototype.START+21;TokenTypes.prototype.ROUTE=LexerCore.prototype.START+22;TokenTypes.prototype.AUTHORIZATION=LexerCore.prototype.START+23;TokenTypes.prototype.PROXY_AUTHORIZATION=LexerCore.prototype.START+24;TokenTypes.prototype.RETRY_AFTER=LexerCore.prototype.START+25;TokenTypes.prototype.PROXY_REQUIRE=LexerCore.prototype.START+26;TokenTypes.prototype.CONTENT_LANGUAGE=LexerCore.prototype.START+27;TokenTypes.prototype.UNSUPPORTED=LexerCore.prototype.START+28;TokenTypes.prototype.SUPPORTED=LexerCore.prototype.START+20;TokenTypes.prototype.WARNING=LexerCore.prototype.START+30;TokenTypes.prototype.MAX_FORWARDS=LexerCore.prototype.START+31;TokenTypes.prototype.DATE=LexerCore.prototype.START+32;TokenTypes.prototype.PRIORITY=LexerCore.prototype.START+33;TokenTypes.prototype.PROXY_AUTHENTICATE=LexerCore.prototype.START+34;TokenTypes.prototype.CONTENT_ENCODING=LexerCore.prototype.START+35;TokenTypes.prototype.CONTENT_LENGTH=LexerCore.prototype.START+36;TokenTypes.prototype.SUBJECT=LexerCore.prototype.START+37;TokenTypes.prototype.CONTENT_TYPE=LexerCore.prototype.START+38;TokenTypes.prototype.CONTACT=LexerCore.prototype.START+39;TokenTypes.prototype.CALL_ID=LexerCore.prototype.START+40;TokenTypes.prototype.REQUIRE=LexerCore.prototype.START+41;TokenTypes.prototype.EXPIRES=LexerCore.prototype.START+42;TokenTypes.prototype.ENCRYPTION=LexerCore.prototype.START+43;TokenTypes.prototype.RECORD_ROUTE=LexerCore.prototype.START+44;TokenTypes.prototype.ORGANIZATION=LexerCore.prototype.START+45;TokenTypes.prototype.CSEQ=LexerCore.prototype.START+46;TokenTypes.prototype.ACCEPT_LANGUAGE=LexerCore.prototype.START+47;TokenTypes.prototype.WWW_AUTHENTICATE=LexerCore.prototype.START+48;TokenTypes.prototype.RESPONSE_KEY=LexerCore.prototype.START+49;TokenTypes.prototype.HIDE=LexerCore.prototype.START+50;TokenTypes.prototype.CALL_INFO=LexerCore.prototype.START+51;TokenTypes.prototype.CONTENT_DISPOSITION=LexerCore.prototype.START+52;TokenTypes.prototype.SUBSCRIBE=LexerCore.prototype.START+53;TokenTypes.prototype.NOTIFY=LexerCore.prototype.START+54;TokenTypes.prototype.TIMESTAMP=LexerCore.prototype.START+55;TokenTypes.prototype.SUBSCRIPTION_STATE=LexerCore.prototype.START+56;TokenTypes.prototype.TEL=LexerCore.prototype.START+57;TokenTypes.prototype.REPLY_TO=LexerCore.prototype.START+58;TokenTypes.prototype.REASON=LexerCore.prototype.START+59;TokenTypes.prototype.RSEQ=LexerCore.prototype.START+60;TokenTypes.prototype.RACK=LexerCore.prototype.START+61;TokenTypes.prototype.MIN_EXPIRES=LexerCore.prototype.START+62;TokenTypes.prototype.EVENT=LexerCore.prototype.START+63;TokenTypes.prototype.AUTHENTICATION_INFO=LexerCore.prototype.START+64;TokenTypes.prototype.ALLOW_EVENTS=LexerCore.prototype.START+65;TokenTypes.prototype.REFER_TO=LexerCore.prototype.START+66;TokenTypes.prototype.PUBLISH=LexerCore.prototype.START+67;TokenTypes.prototype.SIP_ETAG=LexerCore.prototype.START+68;TokenTypes.prototype.SIP_IF_MATCH=LexerCore.prototype.START+69;TokenTypes.prototype.MESSAGE=LexerCore.prototype.START+70;TokenTypes.prototype.PATH=LexerCore.prototype.START+71;TokenTypes.prototype.SERVICE_ROUTE=LexerCore.prototype.START+72;TokenTypes.prototype.P_ASSERTED_IDENTITY=LexerCore.prototype.START+73;TokenTypes.prototype.P_PREFERRED_IDENTITY=LexerCore.prototype.START+74;TokenTypes.prototype.P_VISITED_NETWORK_ID=LexerCore.prototype.START+75;TokenTypes.prototype.P_CHARGING_FUNCTION_ADDRESSES=LexerCore.prototype.START+76;TokenTypes.prototype.P_VECTOR_CHARGING=LexerCore.prototype.START+77;TokenTypes.prototype.PRIVACY=LexerCore.prototype.START+78;TokenTypes.prototype.P_ACCESS_NETWORK_INFO=LexerCore.prototype.START+79;TokenTypes.prototype.P_CALLED_PARTY_ID=LexerCore.prototype.START+80;TokenTypes.prototype.P_ASSOCIATED_URI=LexerCore.prototype.START+81;TokenTypes.prototype.P_MEDIA_AUTHORIZATION=LexerCore.prototype.START+82;TokenTypes.prototype.P_MEDIA_AUTHORIZATION_TOKEN=LexerCore.prototype.START+83;TokenTypes.prototype.REFERREDBY_TO=LexerCore.prototype.START+84;TokenTypes.prototype.SESSIONEXPIRES_TO=LexerCore.prototype.START+85;TokenTypes.prototype.MINSE_TO=LexerCore.prototype.START+86;TokenTypes.prototype.REPLACES_TO=LexerCore.prototype.START+87;TokenTypes.prototype.SIPS=LexerCore.prototype.START+88;TokenTypes.prototype.SECURITY_SERVER=LexerCore.prototype.START+89;TokenTypes.prototype.SECURITY_CLIENT=LexerCore.prototype.START+90;TokenTypes.prototype.SECURITY_VERIFY=LexerCore.prototype.START+91;TokenTypes.prototype.JOIN_TO=LexerCore.prototype.START+92;TokenTypes.prototype.P_USER_DATABASE=LexerCore.prototype.START+93;TokenTypes.prototype.P_PROFILE_KEY=LexerCore.prototype.START+94;TokenTypes.prototype.P_SERVED_USER=LexerCore.prototype.START+95;TokenTypes.prototype.P_PREFERRED_SERVICE=LexerCore.prototype.START+96;TokenTypes.prototype.P_ASSERTED_SERVICE=LexerCore.prototype.START+97;TokenTypes.prototype.REFERENCES=LexerCore.prototype.START+98;TokenTypes.prototype.ACCEPT_CONTACT=LexerCore.prototype.START+99;TokenTypes.prototype.ALPHA=LexerCore.prototype.ALPHA;TokenTypes.prototype.DIGIT=LexerCore.prototype.DIGIT;TokenTypes.prototype.ID=LexerCore.prototype.ID;TokenTypes.prototype.WHITESPACE=LexerCore.prototype.WHITESPACE;TokenTypes.prototype.BACKSLASH=LexerCore.prototype.BACKSLASH;TokenTypes.prototype.QUOTE=LexerCore.prototype.QUOTE;TokenTypes.prototype.AT=LexerCore.prototype.AT;TokenTypes.prototype.SP=LexerCore.prototype.SP;TokenTypes.prototype.HT=LexerCore.prototype.HT;TokenTypes.prototype.COLON=LexerCore.prototype.COLON;TokenTypes.prototype.STAR=LexerCore.prototype.STAR;TokenTypes.prototype.DOLLAR=LexerCore.prototype.DOLLAR;TokenTypes.prototype.PLUS=LexerCore.prototype.PLUS;TokenTypes.prototype.POUND=LexerCore.prototype.POUND;TokenTypes.prototype.MINUS=LexerCore.prototype.MINUS;TokenTypes.prototype.DOUBLEQUOTE=LexerCore.prototype.DOUBLEQUOTE;TokenTypes.prototype.TILDE=LexerCore.prototype.TILDE;TokenTypes.prototype.BACK_QUOTE=LexerCore.prototype.BACK_QUOTE;TokenTypes.prototype.NULL=LexerCore.prototype.NULL;TokenTypes.prototype.EQUALS="=".charCodeAt(0);TokenTypes.prototype.SEMICOLON=";".charCodeAt(0);TokenTypes.prototype.SLASH="/".charCodeAt(0);TokenTypes.prototype.L_SQUARE_BRACKET="[".charCodeAt(0);TokenTypes.prototype.R_SQUARE_BRACKET="]".charCodeAt(0);TokenTypes.prototype.R_CURLY="}".charCodeAt(0);TokenTypes.prototype.L_CURLY="{".charCodeAt(0);TokenTypes.prototype.HAT="^".charCodeAt(0);TokenTypes.prototype.BAR="|".charCodeAt(0);TokenTypes.prototype.DOT=".".charCodeAt(0);TokenTypes.prototype.EXCLAMATION="!".charCodeAt(0);TokenTypes.prototype.LPAREN="(".charCodeAt(0);TokenTypes.prototype.RPAREN=")".charCodeAt(0);TokenTypes.prototype.GREATER_THAN=">".charCodeAt(0);TokenTypes.prototype.LESS_THAN="<".charCodeAt(0);TokenTypes.prototype.PERCENT="%".charCodeAt(0);TokenTypes.prototype.QUESTION="?".charCodeAt(0);TokenTypes.prototype.AND="&".charCodeAt(0);TokenTypes.prototype.UNDERSCORE="_".charCodeAt(0);function TokenNames(){this.classname="TokenNames"}TokenNames.prototype.INVITE="INVITE";TokenNames.prototype.ACK="ACK";TokenNames.prototype.BYE="BYE";TokenNames.prototype.SUBSCRIBE="SUBSCRIBE";TokenNames.prototype.NOTIFY="NOTIFY";TokenNames.prototype.OPTIONS="OPTIONS";TokenNames.prototype.REGISTER="REGISTER";TokenNames.prototype.MESSAGE="MESSAGE";TokenNames.prototype.PUBLISH="PUBLISH";TokenNames.prototype.SIP="sip";TokenNames.prototype.SIPS="sips";TokenNames.prototype.TEL="tel";TokenNames.prototype.GMT="GMT";TokenNames.prototype.MON="Mon";TokenNames.prototype.TUE="Tue";TokenNames.prototype.WED="Wed";TokenNames.prototype.THU="Thu";TokenNames.prototype.FRI="Fri";TokenNames.prototype.SAT="Sat";TokenNames.prototype.SUN="Sun";TokenNames.prototype.JAN="Jan";TokenNames.prototype.FEB="Feb";TokenNames.prototype.MAR="Mar";TokenNames.prototype.APR="Apr";TokenNames.prototype.MAY="May";TokenNames.prototype.JUN="Jun";TokenNames.prototype.JUL="Jul";TokenNames.prototype.AUG="Aug";TokenNames.prototype.SEP="Sep";TokenNames.prototype.OCT="Oct";TokenNames.prototype.NOV="Nov";TokenNames.prototype.DEC="Dec";TokenNames.prototype.K="K";TokenNames.prototype.C="C";TokenNames.prototype.E="E";TokenNames.prototype.F="F";TokenNames.prototype.I="I";TokenNames.prototype.M="M";TokenNames.prototype.L="L";TokenNames.prototype.S="S";TokenNames.prototype.T="T";TokenNames.prototype.U="U";TokenNames.prototype.V="V";TokenNames.prototype.R="R";TokenNames.prototype.O="O";TokenNames.prototype.X="X";TokenNames.prototype.B="B";function StringMsgParser(a){this.classname="StringMsgParser";this.readBody=true;this.parseExceptionListener=null;this.rawStringMessage=null;this.strict=null;this.computeContentLengthFromMessage=false;this.viaCount=0;if(a!=null){this.parseExceptionListener=a}}StringMsgParser.prototype.SIP_VERSION_STRING="SIP/2.0";StringMsgParser.prototype.setParseExceptionListener=function(a){this.parseExceptionListener=a};StringMsgParser.prototype.parseSIPMessage=function(){if(typeof arguments[0]=="string"){var b=arguments[0];return this.parseSIPMessagestring(b)}else{if(typeof arguments[0]=="object"){var a=arguments[0];return this.parseSIPMessagebyte(a)}}};StringMsgParser.prototype.parseSIPMessagestring=function(a){if(a==null||a.length==0){return null}this.rawStringMessage=a;var b=0;try{while(a.charCodeAt(b)<32){b++}}catch(g){console.error("StringMsgParser:parseSIPMessagestring(): catched exception:"+g);return null}var m=null;var j=null;var f=true;var n=null;do{var e=b;try{var h=a.charAt(b);while(h!="\r"&&h!="\n"){h=a.charAt(++b)}}catch(g){console.error("StringMsgParser:parseSIPMessagestring(): catched exception:"+g);break}m=a.substring(e,b);m=this.trimEndOfLine(m);if(m.length==0){if(j!=null){this.processHeader(j,n)}}else{if(f){n=this.processFirstLine(m)}else{var l=m.charAt(0);if(l=="\t"||l==" "){if(j==null){console.error("StringMsgParser:parseSIPMessagestring(): bad header continuation.");throw"StringMsgParser:parseSIPMessagestring(): bad header continuation."}j=j+m.substring(1)}else{if(j!=null){this.processHeader(j,n)}j=m}}}if(a.charAt(b)=="\r"&&a.length>b+1&&a.charAt(b+1)=="\n"){b++}b++;f=false}while(m.length>0);n.setSize(b);if(this.readBody&&n.getContentLength()!=null){if(n.getContentLength().getContentLength()!=0){var d=a.substring(b);n.setMessageContent(d,this.strict,this.computeContentLengthFromMessage,n.getContentLength().getContentLength())}else{if(!this.computeContentLengthFromMessage&&n.getContentLength().getContentLength()==0){if(this.strict){console.error("StringMsgParser:parse(): extraneous characters at the end of the message",b);throw"StringMsgParser:parse(): extraneous characters at the end of the message"}}}}return n};StringMsgParser.prototype.parseSIPMessagebyte=function(q){if(q==null||q.length==0){return null}var d=0;try{while(q[d].charCodeAt(0)<32){d++}}catch(h){console.error("StringMsgParser:parseSIPMessagebyte(): catched exception:"+h);return null}var p="";var m=null;var g=true;var r=null;do{var f=d;try{while(q[d]!="\r"&&q[d]!="\n"){d++}}catch(h){console.error("StringMsgParser:parseSIPMessagebyte(): catched exception:"+h);break}var a=d-f;try{for(var j=0;j<a;j++){p=p+q[j+f]}}catch(h){console.error("StringMsgParser:parseSIPMessagebyte(): bad message encoding!");throw"StringMsgParser:parseSIPMessagebyte():bad message encoding!"}p=this.trimEndOfLine(p);if(p.length()==0){if(m!=null&&r!=null){this.processHeader(m,r)}}else{if(g){r=this.processFirstLine(p)}else{var n=p.charAt(0);if(n=="\t"||n==" "){if(m==null){console.error("StringMsgParser:parseSIPMessagebyte(): bad header continuation");throw"StringMsgParser:parseSIPMessagebyte(): bad header continuation"}m=m+p.substring(1)}else{if(m!=null&&r!=null){this.processHeader(m,r)}m=p}}}if(q[d]=="\r"&&q.length>d+1&&q[d+1]=="\n"){d++}d++;g=false}while(p.length>0);if(r==null){console.error("StringMsgParser:parseSIPMessagebyte(): bad message");throw"StringMsgParser:parseSIPMessagebyte(): bad message"}r.setSize(d);if(this.readBody&&r.getContentLength()!=null&&r.getContentLength().getContentLength()!=0){var b=q.length-d;var e=new Array();var c=d;for(j=0;j<b;j++){e[j]=q[c];c=c+1}r.setMessageContent(e,this.computeContentLengthFromMessage,r.getContentLength().getContentLength())}return r};StringMsgParser.prototype.trimEndOfLine=function(a){if(a==null){return a}var b=a.length-1;while(b>=0&&a.charCodeAt(b)<=32){b--}if(b==a.length-1){return a}if(b==-1){return""}return a.substring(0,b+1)};StringMsgParser.prototype.processFirstLine=function(f){var j=null;var g=this.SIP_VERSION_STRING.length;var a=0;for(var c=0;c<g;c++){if(f.charAt(c)==this.SIP_VERSION_STRING.charAt(c)){a=a+1}}if(a!=g){j=new SIPRequest();try{var h=new RequestLineParser(f+"\n").parse();j.setRequestLine(h)}catch(e){console.error("StringMsgParser:processFirstLine(): catched exception:"+e);if(this.parseExceptionListener!=null){var d=new RequestLine();this.parseExceptionListener.handleException(e,j,d.classname,f,this.rawStringMessage)}else{throw e}}}else{j=new SIPResponse();try{var b=new StatusLineParser(f+"\n").parse();j.setStatusLine(b)}catch(e){console.error("StringMsgParser:processFirstLine(): catched exception:"+e);if(this.parseExceptionListener!=null){b=new StatusLine();this.parseExceptionListener.handleException(e,j,b.classname,f,this.rawStringMessage)}else{throw e}}}return j};StringMsgParser.prototype.processHeader=function(d,l){if(d==null||d.length==0){return}var g=null;try{var e=new ParserFactory();g=e.createParser(d+"\n")}catch(j){console.error("StringMsgParser:processHeader(): catched exception:"+j);this.parseExceptionListener.handleException(j,l,null,d,this.rawStringMessage);return}try{var b=g.parse();if(b instanceof ViaList){this.viaCount=this.viaCount+1;if(this.viaCount==1){l.attachHeader(b,false)}else{l.addViaHeaderList(b)}}else{l.attachHeader(b,false)}}catch(j){console.error("StringMsgParser:processHeader(): catched exception:"+j);if(this.parseExceptionListener!=null){var c=new Lexer();var h=c.getHeaderName(d);var f=new NameMap();var a=f.getClassFromName(h);if(a==null){a=new ExtensionHeaderImpl().classname}this.parseExceptionListener.handleException(j,l,a,d,this.rawStringMessage)}}};StringMsgParser.prototype.parseAddress=function(a){var b=new AddressParser(a);return b.address(true)};StringMsgParser.prototype.parseHost=function(a){var b=new Lexer("charLexer",a);return new HostNameParser(b).host()};StringMsgParser.prototype.parseTelephoneNumber=function(a){return new URLParser(a).parseTelephoneNumber(true)};StringMsgParser.prototype.parseSIPUrl=function(a){try{return new URLParser(a).sipURL(true)}catch(b){console.error("StringMsgParser:parseSIPUrl(): "+a+" is not a SIP URL ");throw"StringMsgParser:parseSIPUrl(): "+a+" is not a SIP URL "}};StringMsgParser.prototype.parseUrl=function(a){return new URLParser(a).parse()};StringMsgParser.prototype.parseSIPHeader=function(g){var a=0;var b=g.length-1;try{while(g.charCodeAt(a)<=32){a++}while(g.charCodeAt(b)<=32){b--}}catch(j){console.error("StringMsgParser:parseSIPHeader(): empty header");throw"StringMsgParser:parseSIPHeader(): eEmpty header"}var d="";var e=a;var h=a;var m=false;while(e<=b){var l=g.charAt(e);if(l=="\r"||l=="\n"){if(!m){d=d+g.substring(h,e);m=true}}else{if(m){m=false;if(l==" "||l=="\t"){d=d+" ";h=e+1}else{h=e}}}e++}d=d+g.substring(h,e);d=d+"\n";var f=new ParserFactory();var n=f.createParser(d.toString());if(n==null){console.error("StringMsgParser:parseSIPHeader(): could not create parser");throw"StringMsgParser:parseSIPHeader(): could not create parser"}return n.parse()};StringMsgParser.prototype.parseSIPRequestLine=function(a){a+="\n";return new RequestLineParser(a).parse()};StringMsgParser.prototype.parseSIPStatusLine=function(a){a+="\n";return new StatusLineParser(a).parse()};StringMsgParser.prototype.setComputeContentLengthFromMessage=function(a){this.computeContentLengthFromMessage=a};StringMsgParser.prototype.setStrict=function(a){this.strict=a};function AddressParametersParser(){this.classname="AddressParametersParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AddressParametersParser.prototype=new ParametersParser();AddressParametersParser.prototype.constructor=AddressParametersParser;AddressParametersParser.prototype.parse=function(a){try{var c=new AddressParser(this.getLexer());var e=c.address(false);a.setAddress(e);this.lexer.SPorHT();var d=this.lexer.lookAhead(0);if(this.lexer.hasMoreChars()&&d!="\0"&&d!="\n"&&this.lexer.startsId()){ParametersParser.prototype.parseNameValueList.call(this,a)}else{ParametersParser.prototype.parse.call(this,a)}}catch(b){console.error("AddressParametersParser:parse(): address Error");throw b}};function ChallengeParser(){this.classname="ChallengeParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ChallengeParser.prototype=new HeaderParser();ChallengeParser.prototype.constructor=ChallengeParser;ChallengeParser.prototype.parse=function(c){this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();c.setScheme(a.getTokenValue());while(this.lexer.lookAhead(0)!="\n"){this.parseParameter(c);this.lexer.SPorHT();var b=this.lexer.lookAhead(0);if(b=="\n"||b=="'\0'"){break}this.lexer.match(",");this.lexer.SPorHT()}};ChallengeParser.prototype.parseParameter=function(b){var a=this.nameValue("=");b.setParameter_nv(a)};function URLParser(){this.classname="URLParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("sip_urlLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("sip_urlLexer",a)}}}URLParser.prototype=new Parser();URLParser.prototype.constructor=URLParser;URLParser.prototype.PLUS=TokenTypes.prototype.PLUS;URLParser.prototype.SEMICOLON=TokenTypes.prototype.SEMICOLON;URLParser.prototype.isMark=function(a){switch(a){case"-":case"_":case".":case"!":case"~":case"*":case"'":case"(":case")":return true;default:return false}};URLParser.prototype.isUnreserved=function(a){var b=new Lexer("","");if(b.isAlphaDigit(a)||this.isMark(a)){return true}else{return false}};URLParser.prototype.isReservedNoSlash=function(a){switch(a){case";":case"?":case":":case"@":case"&":case"+":case"$":case",":return true;default:return false}};URLParser.prototype.isUserUnreserved=function(a){switch(a){case"&":case"?":case"+":case"$":case"#":case"/":case",":case";":case"=":return true;default:return false}};URLParser.prototype.unreserved=function(){var a=this.lexer.lookAhead(0);if(this.isUnreserved(a)){this.lexer.consume(1);return a}else{console.error("URLParser:unreserved(): unreserved");throw"URLParser:unreserved(): unreserved"}};URLParser.prototype.paramNameOrValue=function(){var a=this.lexer.getPtr();while(this.lexer.hasMoreChars()){var b=this.lexer.lookAhead(0);var c=false;switch(b){case"[":case"]":case"/":case":":case"&":case"+":case"$":c=true}if(c||this.isUnreserved(b)){this.lexer.consume(1)}else{if(this.isEscaped()){this.lexer.consume(3)}else{break}}}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};URLParser.prototype.uriParam=function(){var d="";var b=this.paramNameOrValue();var c=this.lexer.lookAhead(0);var a=true;if(c=="="){this.lexer.consume(1);d=this.paramNameOrValue();a=false}if(b.length==0&&(d==null||d.length==0)){return null}else{return new NameValue(b,d,a)}};URLParser.prototype.isReserved=function(a){switch(a){case";":case"/":case"?":case":":case"=":case"@":case"&":case"+":case"$":case",":return true;default:return false}};URLParser.prototype.reserved=function(){var a=this.lexer.lookAhead(0);if(this.isReserved(a)){this.lexer.consume(1);var b="";b=(b+a).toString();return b}else{console.error("URLParser:reserved(): reserved");throw"URLParser:reserved(): reserved"}};URLParser.prototype.isEscaped=function(){try{var b=new Lexer("","");if(this.lexer.lookAhead(0)=="%"&&b.isHexDigit(this.lexer.lookAhead(1))&&b.isHexDigit(this.lexer.lookAhead(2))){return true}else{return false}}catch(a){console.error("URLParser:isEscaped(): catched exception:"+a);return false}};URLParser.prototype.escaped=function(){var e=new Lexer("","");var a="";var d=this.lexer.lookAhead(0);var c=this.lexer.lookAhead(1);var b=this.lexer.lookAhead(2);if(d=="%"&&e.isHexDigit(c)&&e.isHexDigit(b)){this.lexer.consume(3);a=a+d+c+b}else{console.error("URLParser:escaped(): escaped");throw"URLParser:escaped(): escaped"}return a.toString()};URLParser.prototype.mark=function(){var a=this.lexer.lookAhead(0);if(this.isMark(a)){this.lexer.consume(1);return a}else{console.error("URLParser:mark(): marked");throw"URLParser:mark(): marked"}};URLParser.prototype.uric=function(){try{var c=new Lexer("","");var d=this.lexer.lookAhead(0);if(this.isUnreserved(d)){this.lexer.consume(1);return c.charAsString(d)}else{if(this.isReserved(d)){this.lexer.consume(1);return c.charAsString(d)}else{if(this.isEscaped()){var a=this.lexer.charAsString(3);this.lexer.consume(3);return a}else{return null}}}}catch(b){console.error("URLParser:uric(): catched exception:"+b);return null}};URLParser.prototype.uricNoSlash=function(){try{var c=new Lexer("","");var d=this.lexer.lookAhead(0);if(this.isEscaped()){var a=this.lexer.charAsString(3);this.lexer.consume(3);return a}else{if(this.isUnreserved(d)){this.lexer.consume(1);return c.charAsString(d)}else{if(this.isReservedNoSlash(d)){this.lexer.consume(1);return c.charAsString(d)}else{return null}}}}catch(b){console.error("URLParser:uricNoSlash(): catched exception:"+b);return null}};URLParser.prototype.uricString=function(){var a="";while(true){var b=this.uric();if(b==null){var d=this.lexer.lookAhead(0);if(d=="["){var e=new HostNameParser(this.getLexer());var c=e.hostPort(false);a=a+c.toString();continue}break}a=a+b}return a.toString()};URLParser.prototype.uriReference=function(g){var a=null;var f=this.lexer.peekNextToken(2);var d=f[0];var c=f[1];if(d.getTokenType()==TokenTypes.prototype.SIP||d.getTokenType()==TokenTypes.prototype.SIPS){if(c.getTokenType()==":"){a=this.sipURL(g)}else{console.error("URLParser:uriReference(): expecting ':'");throw"URLParser:uriReference(): expecting ':'"}}else{if(d.getTokenType()==TokenTypes.prototype.TEL){if(c.getTokenType()==":"){a=this.telURL(g)}else{console.error("URLParser:uriReference(): expecting ':'");throw"URLParser:uriReference(): expecting ':'"}}else{var e=this.uricString();try{a=new GenericURI(e)}catch(b){console.error("URLParser:uriReference(): "+b);throw"URLParser:uriReference(): "+b}}}return a};URLParser.prototype.base_phone_number=function(){var b="";var d=new Lexer("","");var c=0;while(this.lexer.hasMoreChars()){var a=this.lexer.lookAhead(0);if(d.isDigit(a)||a=="-"||a=="."||a=="("||a==")"){this.lexer.consume(1);b=b+a;c++}else{if(c>0){break}else{console.error("URLParser:base_phone_number(): unexpected"+a);throw"URLParser:base_phone_number(): unexpected"+a}}}return b.toString()};URLParser.prototype.local_number=function(){var a="";var c=new Lexer("","");var b=0;while(this.lexer.hasMoreChars()){var d=this.lexer.lookAhead(0);if(d=="*"||d=="#"||d=="-"||d=="."||d=="("|d==")"||c.isHexDigit(d)){this.lexer.consume(1);a=a+d;b++}else{if(b>0){break}else{console.error("URLParser:local_number(): unexpected"+d);throw"URLParser:local_number(): unexpected"+d}}}return a.toString()};URLParser.prototype.parseTelephoneNumber=function(e){var a;this.lexer.selectLexer("charLexer");var b=new Lexer("","");var d=this.lexer.lookAhead(0);if(d=="+"){a=this.global_phone_number(e)}else{if(b.isHexDigit(d)||d=="#"||d=="*"||d=="-"||d=="."||d=="("||d==")"){a=this.local_phone_number(e)}else{console.error("URLParser:parseTelephoneNumber(): unexpected char "+d);throw"URLParser:parseTelephoneNumber(): unexpected char "+d}}return a};URLParser.prototype.global_phone_number=function(f){var c=new TelephoneNumber();c.setGlobal(true);var e=null;this.lexer.match("+");var a=this.base_phone_number();c.setPhoneNumber(a);if(this.lexer.hasMoreChars()){var d=this.lexer.lookAhead(0);if(d==";"&&f){this.lexer.consume(1);e=tel_parameters();c.setParameters(e)}}return c};URLParser.prototype.local_phone_number=function(f){var c=new TelephoneNumber();c.setGlobal(false);var e=null;var a=null;a=this.local_number();c.setPhoneNumber(a);if(this.lexer.hasMoreChars()){var d=this.lexer.peekNextToken();switch(d.getTokenType()){case this.SEMICOLON:if(f){this.lexer.consume(1);e=this.tel_parameters();c.setParameters(e)}break;default:break}}return c};URLParser.prototype.tel_parameters=function(){var d=new NameValueList();var a;while(true){var b=this.paramNameOrValue();if(b.toLowerCase()==("phone-context").toLowerCase()){a=this.phone_context()}else{if(this.lexer.lookAhead(0)=="="){this.lexer.consume(1);var c=this.paramNameOrValue();a=new NameValue(b,c,false)}else{a=new NameValue(b,"",true)}}d.set(a);if(this.lexer.lookAhead(0)==";"){this.lexer.consume(1)}else{return d}}};URLParser.prototype.phone_context=function(){this.lexer.match("=");var c=this.lexer.lookAhead(0);var b=null;if(c=="+"){this.lexer.consume(1);b="+"+this.base_phone_number()}else{if(Lexer.isAlphaDigit(c)){var a=this.lexer.match(Lexer.prototype.ID);b=a.getTokenValue()}else{console.error("URLParser:phone_context(): invalid phone-context:"+c);throw"URLParser:phone_context(): invalid phone-context:"+c}}return new NameValue("phone-context",b,false)};URLParser.prototype.telURL=function(c){this.lexer.match(TokenTypes.prototype.TEL);this.lexer.match(":");var a=this.parseTelephoneNumber(c);var b=new TelURLImpl();b.setTelephoneNumber(a);return b};URLParser.prototype.sipURL=function(h){var c=new SipUri();var f=this.lexer.peekNextToken();var b=TokenTypes.prototype.SIP;var e=TokenNames.prototype.SIP;if(f.getTokenType()==TokenTypes.prototype.SIPS){b=TokenTypes.prototype.SIPS;e=TokenNames.prototype.SIPS}this.lexer.match(b);this.lexer.match(":");c.setScheme(e);var d=this.lexer.markInputPosition();var a=this.user();var j=null;if(this.lexer.lookAhead()==":"){this.lexer.consume(1);j=this.password()}if(this.lexer.lookAhead()=="@"){this.lexer.consume(1);c.setUser(a);if(j!=null){c.setUserPassword(j)}}else{this.lexer.rewindInputPosition(d)}var g=new HostNameParser(this.getLexer());var m=g.hostPort(false);c.setHostPort(m);this.lexer.selectLexer("charLexer");while(this.lexer.hasMoreChars()){if(this.lexer.lookAhead(0)!=";"||!h){break}this.lexer.consume(1);var l=this.uriParam();if(l!=null){c.setUriParameter(l)}}if(this.lexer.hasMoreChars()&&this.lexer.lookAhead(0)=="?"){this.lexer.consume(1);while(this.lexer.hasMoreChars()){l=this.qheader();c.setQHeader(l);if(this.lexer.hasMoreChars()&&this.lexer.lookAhead(0)!="&"){break}else{this.lexer.consume(1)}}}return c};URLParser.prototype.peekScheme=function(){var b=this.lexer.peekNextToken(1);if(b.length==0){return null}var a=b[0].getTokenValue();return a};URLParser.prototype.qheader=function(){var b=this.lexer.ptr;while(true){var d=this.lexer.lookAhead(0);if(d=="="){break}else{if(d=="\0"){console.error("URLParser:qheader(): EOL reached");throw"URLParser:qheader(): EOL reached"}}this.lexer.consume(1)}var a=this.lexer.getBuffer().substring(b,this.lexer.ptr);this.lexer.consume(1);var c=this.hvalue();return new NameValue(a,c,false)};URLParser.prototype.hvalue=function(){var a="";while(this.lexer.hasMoreChars()){var d=this.lexer.lookAhead(0);var c=false;switch(d){case"+":case"?":case":":case"[":case"]":case"/":case"$":case"_":case"-":case'"':case"!":case"~":case"*":case".":case"(":case")":c=true}var b=new Lexer("","");if(c||b.isAlphaDigit(d)){this.lexer.consume(1);a=a+d}else{if(d=="%"){a=a+this.escaped()}else{break}}}return a.toString()};URLParser.prototype.urlString=function(){var a="";this.lexer.selectLexer("charLexer");while(this.lexer.hasMoreChars()){var b=this.lexer.lookAhead(0);if(b==" "||b=="\t"||b=="\n"||b==">"||b=="<"){break}this.lexer.consume(0);a=a+b}return a.toString()};URLParser.prototype.user=function(){var a=this.lexer.getPtr();while(this.lexer.hasMoreChars()){var b=this.lexer.lookAhead(0);if(this.isUnreserved(b)||this.isUserUnreserved(b)){this.lexer.consume(1)}else{if(this.isEscaped()){this.lexer.consume(3)}else{break}}}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};URLParser.prototype.password=function(){var a=this.lexer.getPtr();while(true){var c=this.lexer.lookAhead(0);var b=false;switch(c){case"&":case"=":case"+":case"$":case",":b=true}if(b||this.isUnreserved(c)){this.lexer.consume(1)}else{if(this.isEscaped()){this.lexer.consume(3)}else{break}}}return this.lexer.getBuffer().substring(a,this.lexer.getPtr())};URLParser.prototype.parse=function(){return this.uriReference(true)};function AddressParser(){this.classname="AddressParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AddressParser.prototype=new Parser();AddressParser.prototype.constructor=AddressParser;AddressParser.prototype.NAME_ADDR=1;AddressParser.prototype.ADDRESS_SPEC=2;AddressParser.prototype.nameAddr=function(){if(this.lexer.lookAhead(0)=="<"){this.lexer.consume(1);this.lexer.selectLexer("sip_urlLexer");this.lexer.SPorHT();var d=new URLParser(this.lexer);var c=d.uriReference(true);var a=new AddressImpl();a.setAddressType(this.NAME_ADDR);a.setURI(c);this.lexer.SPorHT();this.lexer.match(">");return a}else{var e=new AddressImpl();e.setAddressType(this.NAME_ADDR);var b=null;if(this.lexer.lookAhead(0)=='"'){b=this.lexer.quotedString();this.lexer.SPorHT()}else{b=this.lexer.getNextToken("<")}e.setDisplayName(b.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,""));this.lexer.match("<");this.lexer.SPorHT();d=new URLParser(this.lexer);c=d.uriReference(true);a=new AddressImpl();e.setAddressType(this.NAME_ADDR);e.setURI(c);this.lexer.SPorHT();this.lexer.match(">");return e}};AddressParser.prototype.address=function(f){var a=null;var b=0;while(this.lexer.hasMoreChars()){var e=this.lexer.lookAhead(b);if(e=="<"||e=='"'||e==":"||e=="/"){break}else{if(e=="\0"){console.error("AddressParser:address(): unexpected EOL");throw"AddressParser:parse(): unexpected EOL"}else{b++}}}e=this.lexer.lookAhead(b);if(e=="<"||e=='"'){a=this.nameAddr()}else{if(e==":"||e=="/"){a=new AddressImpl();var d=new URLParser(this.lexer);var c=d.uriReference(f);a.setAddressType(this.ADDRESS_SPEC);a.setURI(c)}else{console.error("AddressParser:address(): bad address spec");throw"AddressParser:parse(): bad address spec"}}return a};function ToParser(){this.classname="ToParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ToParser.prototype=new AddressParametersParser();ToParser.prototype.constructor=ToParser;ToParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.TO);var a=new To();AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function FromParser(){this.classname="FromParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}FromParser.prototype=new AddressParametersParser();FromParser.prototype.constructor=FromParser;FromParser.prototype.parse=function(){var a=new From();this.lexer.match(TokenTypes.prototype.FROM);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();AddressParametersParser.prototype.parse.call(this,a);this.lexer.match("\n");return a};function CSeqParser(){this.classname="CSeqParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}CSeqParser.prototype=new HeaderParser();CSeqParser.prototype.constructor=CSeqParser;CSeqParser.prototype.parse=function(){var e=new CSeq();this.lexer.match(TokenTypes.prototype.CSEQ);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var b=this.lexer.number();e.setSeqNumber(b);this.lexer.SPorHT();var d=new SIPRequest();var a=d.getCannonicalName(this.method());e.setMethod(a);this.lexer.SPorHT();this.lexer.match("\n");return e};function ViaParser(){this.classname="ViaParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ViaParser.prototype=new HeaderParser();ViaParser.prototype.constructor=ViaParser;ViaParser.prototype.RECEIVED="received";ViaParser.prototype.BRANCH="branch";ViaParser.prototype.parseVia=function(l){this.lexer.match(TokenTypes.prototype.ID);var c=this.lexer.getNextToken();this.lexer.SPorHT();this.lexer.match("/");this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);this.lexer.SPorHT();var g=this.lexer.getNextToken();this.lexer.SPorHT();this.lexer.match("/");this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);this.lexer.SPorHT();var e=this.lexer.getNextToken();this.lexer.SPorHT();var p=new Protocol();p.setProtocolName(c.getTokenValue());p.setProtocolVersion(g.getTokenValue());if(e.getTokenValue()=="WS"){p.setTransport("WS")}else{p.setTransport(e.getTokenValue())}l.setSentProtocol(p);var h=new HostNameParser(this.getLexer());var d=h.hostPort(true);l.setSentBy(d);this.lexer.SPorHT();while(this.lexer.lookAhead(0)==";"){this.lexer.consume(1);this.lexer.SPorHT();var m=this.nameValue();var b=m.getName();if(b==this.BRANCH){var f=m.getValueAsObject();if(f==null){console.error("ViaParser:parseVia(): null branch Id",this.lexer.getPtr());throw"ViaParser:parseVia(): null branch Id"+this.lexer.getPtr()}}l.setParameter_nv(m);this.lexer.SPorHT()}if(this.lexer.lookAhead(0)=="("){this.lexer.selectLexer("charLexer");this.lexer.consume(1);var j="";while(true){var a=this.lexer.lookAhead(0);if(a==")"){this.lexer.consume(1);break}else{if(a=="\\"){var n=this.lexer.getNextToken();j=j+n.getTokenValue();this.lexer.consume(1);n=this.lexer.getNextToken();j=j+n.getTokenValue();this.lexer.consume(1)}else{if(a=="\n"){break}else{j=j+a;this.lexer.consume(1)}}}}l.setComment(j.toString())}};ViaParser.prototype.nameValue=function(){this.lexer.match(LexerCore.prototype.ID);var b=this.lexer.getNextToken();this.lexer.SPorHT();try{var d=false;var f=this.lexer.lookAhead(0);if(f=="="){this.lexer.consume(1);this.lexer.SPorHT();var g=null;if(b.getTokenValue().toLowerCase()==this.RECEIVED.toLowerCase()){g=this.lexer.byteStringNoSemicolon()}else{if(this.lexer.lookAhead(0)=='"'){g=this.lexer.quotedString();d=true}else{this.lexer.match(LexerCore.prototype.ID);var e=this.lexer.getNextToken();g=e.getTokenValue()}}var a=new NameValue(b.getTokenValue().toLowerCase(),g);if(d){a.setQuotedValue()}return a}else{return new NameValue(b.getTokenValue().toLowerCase(),null)}}catch(c){console.error("ViaParser:nameValue(): catched exception:"+c);return new NameValue(b.getTokenValue(),null)}};ViaParser.prototype.parse=function(){var b=new ViaList();this.lexer.match(TokenTypes.prototype.VIA);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();while(true){var a=new Via();this.parseVia(a);b.add(a);this.lexer.SPorHT();if(this.lexer.lookAhead(0)==","){this.lexer.consume(1);this.lexer.SPorHT()}if(this.lexer.lookAhead(0)=="\n"){break}}this.lexer.match("\n");return b};function ContactParser(){this.classname="ContactParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ContactParser.prototype=new AddressParametersParser();ContactParser.prototype.constructor=ContactParser;ContactParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.CONTACT);var b=new ContactList();while(true){var a=new Contact();if(this.lexer.lookAhead(0)=="*"){var c=this.lexer.lookAhead(1);if(c==" "||c=="\t"||c=="\r"||c=="\n"){this.lexer.match("*");a.setWildCardFlag(true)}else{AddressParametersParser.prototype.parse.call(this,a)}}else{AddressParametersParser.prototype.parse.call(this,a)}b.add(a);this.lexer.SPorHT();var d=this.lexer.lookAhead(0);if(d==","){this.lexer.match(",");this.lexer.SPorHT()}else{if(d=="\n"||d=="\0"){break}else{console.error("ContactParser:address(): unexpected char");throw"ContactParser:parse(): unexpected char"}}}return b};function ContentTypeParser(){this.classname="ContentTypeParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ContentTypeParser.prototype=new ParametersParser();ContentTypeParser.prototype.constructor=ContentTypeParser;ContentTypeParser.prototype.parse=function(){var c=new ContentType();this.headerName(TokenTypes.prototype.CONTENT_TYPE);this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();this.lexer.SPorHT();c.setContentType(a.getTokenValue());this.lexer.match("/");this.lexer.match(TokenTypes.prototype.ID);var b=this.lexer.getNextToken();this.lexer.SPorHT();c.setContentSubType(b.getTokenValue());ParametersParser.prototype.parse.call(this,c);this.lexer.match("\n");return c};function ContentLengthParser(){this.classname="ContentLengthParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ContentLengthParser.prototype=new HeaderParser();ContentLengthParser.prototype.constructor=ContentLengthParser;ContentLengthParser.prototype.parse=function(){var a=new ContentLength();this.headerName(TokenTypes.prototype.CONTENT_LENGTH);var b=this.lexer.number();a.setContentLength(b);this.lexer.SPorHT();this.lexer.match("\n");return a};function AuthorizationParser(){this.classname="AuthorizationParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AuthorizationParser.prototype=new ChallengeParser();AuthorizationParser.prototype.constructor=AuthorizationParser;AuthorizationParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.AUTHORIZATION);var a=new Authorization();ChallengeParser.prototype.parse.call(this,a);return a};function WWWAuthenticateParser(){this.classname="WWWAuthenticateParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}WWWAuthenticateParser.prototype=new ChallengeParser();WWWAuthenticateParser.prototype.constructor=WWWAuthenticateParser;WWWAuthenticateParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.WWW_AUTHENTICATE);var a=new WWWAuthenticate();ChallengeParser.prototype.parse.call(this,a);return a};function CallIDParser(){this.classname="CallIDParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}CallIDParser.prototype=new HeaderParser();CallIDParser.prototype.constructor=CallIDParser;CallIDParser.prototype.parse=function(){this.lexer.match(TokenTypes.prototype.CALL_ID);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var a=new CallID();this.lexer.SPorHT();var b=this.lexer.getRest();a.setCallId(b.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,""));return a};function RouteParser(){this.classname="RouteParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}RouteParser.prototype=new AddressParametersParser();RouteParser.prototype.constructor=RouteParser;RouteParser.prototype.parse=function(){var b=new RouteList();this.lexer.match(TokenTypes.prototype.ROUTE);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();while(true){var a=new Route();AddressParametersParser.prototype.parse.call(this,a);b.add(a);this.lexer.SPorHT();var c=this.lexer.lookAhead(0);if(c==","){this.lexer.match(",");this.lexer.SPorHT()}else{if(c=="\n"){break}else{console.error("RouteParser:parse(): unexpected char");throw"RouteParser:parse(): unexpected char"}}}return b};function RecordRouteParser(){this.classname="RecordRouteParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}RecordRouteParser.prototype=new AddressParametersParser();RecordRouteParser.prototype.constructor=RecordRouteParser;RecordRouteParser.prototype.parse=function(){var b=new RecordRouteList();this.lexer.match(TokenTypes.prototype.RECORD_ROUTE);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();while(true){var a=new RecordRoute();AddressParametersParser.prototype.parse.call(this,a);b.add(a);this.lexer.SPorHT();var c=this.lexer.lookAhead(0);if(c==","){this.lexer.match(",");this.lexer.SPorHT()}else{if(c=="\n"){break}else{console.error("RecordRouteParser:parse(): unexpected char");throw"RecordRouteParser:parse(): unexpected char"}}}return b};function ProxyAuthenticateParser(){this.classname="ProxyAuthenticateParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ProxyAuthenticateParser.prototype=new ChallengeParser();ProxyAuthenticateParser.prototype.constructor=ProxyAuthenticateParser;ProxyAuthenticateParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.PROXY_AUTHENTICATE);var a=new ProxyAuthenticate();ChallengeParser.prototype.parse.call(this,a);return a};function ProxyAuthorizationParser(){this.classname="ProxyAuthorizationParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ProxyAuthorizationParser.prototype=new ChallengeParser();ProxyAuthorizationParser.prototype.constructor=ProxyAuthorizationParser;ProxyAuthorizationParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.PROXY_AUTHORIZATION);var a=new ProxyAuthorization();ChallengeParser.prototype.parse.call(this,a);return a};function TimeStampParser(){this.classname="TimeStampParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}TimeStampParser.prototype=new HeaderParser();TimeStampParser.prototype.constructor=TimeStampParser;TimeStampParser.prototype.TIMESTAMP="Timestamp";TimeStampParser.prototype.parse=function(){var a=new TimeStamp();this.headerName(TokenTypes.prototype.TIMESTAMP);a.setHeaderName(this.TIMESTAMP);this.lexer.SPorHT();var e=this.lexer.number();if(this.lexer.lookAhead(0)=="."){this.lexer.match(".");var b=this.lexer.number();var c=e+"."+b;var d=c;a.setTimeStamp(d)}else{d=e;a.setTime(d)}this.lexer.SPorHT();if(this.lexer.lookAhead(0)!="\n"){e=this.lexer.number()}if(this.lexer.lookAhead(0)=="."){this.lexer.match(".");b=this.lexer.number();c=e+"."+b;d=c;a.setDelay(d)}else{d=e;a.setDelay(d)}return a};function UserAgentParser(){this.classname="UserAgentParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}UserAgentParser.prototype=new HeaderParser();UserAgentParser.prototype.constructor=UserAgentParser;UserAgentParser.prototype.parse=function(){var d=new UserAgent();this.headerName(TokenTypes.prototype.USER_AGENT);if(this.lexer.lookAhead(0)=="\n"){console.error("UserAgentParser:parse(): empty header");throw"UserAgentParser:parse(): empty header"}while(this.lexer.lookAhead(0)!="\n"&&this.lexer.lookAhead(0)!="\0"){if(this.lexer.lookAhead(0)=="("){var e=this.lexer.comment();d.addProductToken("("+e+")")}else{this.getLexer().SPorHT();var c=this.lexer.byteStringNoSlash();if(c==null){console.error("UserAgentParser:parse(): expected product string");throw"UserAgentParser:parse():expected product string"}var b=c;if(this.lexer.peekNextToken().getTokenValue()=="/"){this.lexer.match("/");this.getLexer().SPorHT();var a=this.lexer.byteStringNoWhiteSpace();if(a==null){console.error("UserAgentParser:parse(): expected product version");throw"UserAgentParser:parse(): expected product version"}b=b+"/"+a}d.addProductToken(b.toString())}this.lexer.SPorHT()}return d};function SupportedParser(){this.classname="SupportedParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}SupportedParser.prototype=new HeaderParser();SupportedParser.prototype.constructor=SupportedParser;SupportedParser.prototype.SUPPORTED="Supported";SupportedParser.prototype.parse=function(){var b=new SupportedList();this.headerName(TokenTypes.prototype.SUPPORTED);while(this.lexer.lookAhead(0)!="\n"){this.lexer.SPorHT();var a=new Supported();a.setHeaderName(this.SUPPORTED);this.lexer.match(TokenTypes.prototype.ID);var c=this.lexer.getNextToken();a.setOptionTag(c.getTokenValue());this.lexer.SPorHT();b.add(a);while(this.lexer.lookAhead(0)==","){this.lexer.match(",");this.lexer.SPorHT();a=new Supported();this.lexer.match(TokenTypes.prototype.ID);c=this.lexer.getNextToken();a.setOptionTag(c.getTokenValue());this.lexer.SPorHT();b.add(a)}}return b};function ServerParser(){this.classname="ServerParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ServerParser.prototype=new HeaderParser();ServerParser.prototype.constructor=ServerParser;ServerParser.prototype.parse=function(){var d=new Server();this.headerName(TokenTypes.prototype.SERVER);if(this.lexer.lookAhead(0)=="\n"){console.error("ServerParser:parse(): empty header");throw"ServerParser:parse():  empty header"}while(this.lexer.lookAhead(0)!="\n"&&this.lexer.lookAhead(0)!="\0"){if(this.lexer.lookAhead(0)=="("){var e=this.lexer.comment();d.addProductToken("("+e+")")}else{var b;var a=0;try{a=this.lexer.markInputPosition();b=this.lexer.getString("/");if(b.charAt(b.length()-1)=="\n"){b=b.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"")}d.addProductToken(b)}catch(c){this.lexer.rewindInputPosition(a);b=this.lexer.getRest().replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"");d.addProductToken(b);break}}}return d};function SubjectParser(){this.classname="SubjectParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}SubjectParser.prototype=new HeaderParser();SubjectParser.prototype.constructor=SubjectParser;SubjectParser.prototype.parse=function(){var a=new Subject();this.headerName(TokenTypes.prototype.SUBJECT);this.lexer.SPorHT();var b=this.lexer.getRest();a.setSubject(b.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,""));return a};function MaxForwardsParser(){this.classname="MaxForwardsParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}MaxForwardsParser.prototype=new HeaderParser();MaxForwardsParser.prototype.constructor=MaxForwardsParser;MaxForwardsParser.prototype.parse=function(){var a=new MaxForwards();this.headerName(TokenTypes.prototype.MAX_FORWARDS);var b=this.lexer.number();a.setMaxForwards(b);this.lexer.SPorHT();this.lexer.match("\n");return a};function ReasonParser(){this.classname="ReasonParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ReasonParser.prototype=new ParametersParser();ReasonParser.prototype.constructor=ReasonParser;ReasonParser.prototype.parse=function(){var d=new ReasonList();this.headerName(TokenTypes.prototype.REASON);this.lexer.SPorHT();while(this.lexer.lookAhead(0)!="\n"){var c=new Reason();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();var b=a.getTokenValue();c.setProtocol(b);ParametersParser.prototype.parse.call(this,c);d.add(c);if(this.lexer.lookAhead(0)==","){this.lexer.match(",");this.lexer.SPorHT()}else{this.lexer.SPorHT()}return d}};function RequestLineParser(){this.classname="RequestLineParser";if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("method_keywordLexer",b)}else{if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("method_keywordLexer")}}}RequestLineParser.prototype=new Parser();RequestLineParser.prototype.constructor=RequestLineParser;RequestLineParser.prototype.parse=function(){var b=new RequestLine();var a=this.method();this.lexer.SPorHT();b.setMethod(a);this.lexer.selectLexer("sip_urlLexer");var e=new URLParser(this.getLexer());var d=e.uriReference(true);this.lexer.SPorHT();b.setUri(d);this.lexer.selectLexer("request_lineLexer");var c=this.sipVersion();b.setSipVersion(c);this.lexer.SPorHT();this.lexer.match("\n");return b};function ExpiresParser(){this.classname="ExpiresParser";if(typeof arguments[0]=="object"){var a=arguments[0];this.lexer=a;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var b=arguments[0];this.lexer=new Lexer("command_keywordLexer",b)}}}ExpiresParser.prototype=new HeaderParser();ExpiresParser.prototype.constructor=ExpiresParser;ExpiresParser.prototype.parse=function(){var a=new Expires();this.lexer.match(TokenTypes.prototype.EXPIRES);this.lexer.SPorHT();this.lexer.match(":");this.lexer.SPorHT();var b=this.lexer.getNextId();this.lexer.match("\n");var c=b+0;a.setExpires(c);return a};function EventParser(){this.classname="EventParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}EventParser.prototype=new ParametersParser();EventParser.prototype.constructor=EventParser;EventParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.EVENT);this.lexer.SPorHT();var b=new Event();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();var c=a.getTokenValue();b.setEventType(c);ParametersParser.prototype.parse.call(this,b);this.lexer.SPorHT();this.lexer.match("\n");return b};function StatusLineParser(){this.classname="StatusLineParser";if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("status_lineLexer",a)}else{if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("status_lineLexer")}}}StatusLineParser.prototype=new Parser();StatusLineParser.prototype.constructor=StatusLineParser;StatusLineParser.prototype.statusCode=function(){var b=this.lexer.number();var a=b;return a};StatusLineParser.prototype.reasonPhrase=function(){return this.lexer.getRest().replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"")};StatusLineParser.prototype.parse=function(){var b=new StatusLine();var a=this.sipVersion();b.setSipVersion(a);this.lexer.SPorHT();var c=this.statusCode();b.setStatusCode(c);this.lexer.SPorHT();var d=this.reasonPhrase();b.setReasonPhrase(d);this.lexer.SPorHT();return b};function ContentDispositionParser(){this.classname="ContentDispositionParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}ContentDispositionParser.prototype=new ParametersParser();ContentDispositionParser.prototype.constructor=ContentDispositionParser;ContentDispositionParser.prototype.CONTENT_DISPOSITION="Content-Disposition";ContentDispositionParser.prototype.parse=function(){this.headerName(TokenTypes.prototype.CONTENT_DISPOSITION);var b=new ContentDisposition();b.setHeaderName(this.CONTENT_DISPOSITION);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();b.setDispositionType(a.getTokenValue());this.lexer.SPorHT();ParametersParser.prototype.parse.call(this,b);this.lexer.SPorHT();this.lexer.match("\n");return b};function AllowParser(){this.classname="AllowParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AllowParser.prototype=new HeaderParser();AllowParser.prototype.constructor=AllowParser;AllowParser.prototype.ALLOW="Allow";AllowParser.prototype.parse=function(){var c=new AllowList();this.headerName(TokenTypes.prototype.ALLOW);var b=new Allow();b.setHeaderName(this.ALLOW);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();b.setMethod(a.getTokenValue());c.add(b);this.lexer.SPorHT();while(this.lexer.lookAhead(0)==","){this.lexer.match(",");this.lexer.SPorHT();b=new Allow();this.lexer.match(TokenTypes.prototype.ID);a=this.lexer.getNextToken();b.setMethod(a.getTokenValue());c.add(b);this.lexer.SPorHT()}this.lexer.SPorHT();this.lexer.match("\n");return c};function AllowEventsParser(){this.classname="AllowEventsParser";if(typeof arguments[0]=="object"){var b=arguments[0];this.lexer=b;this.lexer.selectLexer("command_keywordLexer")}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.lexer=new Lexer("command_keywordLexer",a)}}}AllowEventsParser.prototype=new HeaderParser();AllowEventsParser.prototype.constructor=AllowEventsParser;AllowEventsParser.prototype.ALLOW_EVENTS="Allow-Events";AllowEventsParser.prototype.parse=function(){var c=new AllowEventsList();this.headerName(TokenTypes.prototype.ALLOW_EVENTS);var b=new AllowEvents();b.setHeaderName(this.ALLOW_EVENTS);this.lexer.SPorHT();this.lexer.match(TokenTypes.prototype.ID);var a=this.lexer.getNextToken();b.setEventType(a.getTokenValue());c.add(b);this.lexer.SPorHT();while(this.lexer.lookAhead(0)==","){this.lexer.match(",");this.lexer.SPorHT();b=new AllowEvents();this.lexer.match(TokenTypes.prototype.ID);a=this.lexer.getNextToken();b.setEventType(a.getTokenValue());c.add(b);this.lexer.SPorHT()}this.lexer.SPorHT();this.lexer.match("\n");return c};function ParserFactory(){this.classname="ParserFactory";this.parserTable=new Array();this.constructorArgs=null;this.parserConstructorCache=new Array();this.put(this.parserTable,"t",new ToParser().classname);this.put(this.parserTable,"To".toLowerCase(),new ToParser().classname);this.put(this.parserTable,"From".toLowerCase(),new FromParser().classname);this.put(this.parserTable,"f",new FromParser().classname);this.put(this.parserTable,"CSeq".toLowerCase(),new CSeqParser().classname);this.put(this.parserTable,"Via".toLowerCase(),new ViaParser().classname);this.put(this.parserTable,"v",new ViaParser().classname);this.put(this.parserTable,"Contact".toLowerCase(),new ContactParser().classname);this.put(this.parserTable,"m",new ContactParser().classname);this.put(this.parserTable,"Content-Type".toLowerCase(),new ContentTypeParser().classname);this.put(this.parserTable,"c",new ContentTypeParser().classname);this.put(this.parserTable,"Content-Length".toLowerCase(),new ContentLengthParser().classname);this.put(this.parserTable,"l",new ContentLengthParser().classname);this.put(this.parserTable,"Authorization".toLowerCase(),new AuthorizationParser().classname);this.put(this.parserTable,"WWW-Authenticate".toLowerCase(),new WWWAuthenticateParser().classname);this.put(this.parserTable,"Call-ID".toLowerCase(),new CallIDParser().classname);this.put(this.parserTable,"i",new CallIDParser().classname);this.put(this.parserTable,"Route".toLowerCase(),new RouteParser().classname);this.put(this.parserTable,"Record-Route".toLowerCase(),new RecordRouteParser().classname);this.put(this.parserTable,"Proxy-Authorization".toLowerCase(),new ProxyAuthorizationParser().classname);this.put(this.parserTable,"Proxy-Authenticate".toLowerCase(),new ProxyAuthenticateParser().classname);this.put(this.parserTable,"Timestamp".toLowerCase(),new TimeStampParser().classname);this.put(this.parserTable,"User-Agent".toLowerCase(),new UserAgentParser().classname);this.put(this.parserTable,"Supported".toLowerCase(),new SupportedParser().classname);this.put(this.parserTable,"k",new SupportedParser().classname);this.put(this.parserTable,"Server".toLowerCase(),new ServerParser().classname);this.put(this.parserTable,"Subject".toLowerCase(),new SubjectParser().classname);this.put(this.parserTable,"s",new SubjectParser().classname);this.put(this.parserTable,"Max-Forwards".toLowerCase(),new MaxForwardsParser().classname);this.put(this.parserTable,"Reason".toLowerCase(),new ReasonParser().classname);this.put(this.parserTable,"Expires".toLowerCase(),new ExpiresParser().classname);this.put(this.parserTable,"Event".toLowerCase(),new EventParser().classname);this.put(this.parserTable,"o",new EventParser().classname);this.put(this.parserTable,"Content-Disposition".toLowerCase(),new ContentDispositionParser().classname);this.put(this.parserTable,"Allow".toLowerCase(),new AllowParser().classname);this.put(this.parserTable,"Allow-Events".toLowerCase(),new AllowEventsParser().classname);this.put(this.parserTable,"u",new AllowEventsParser().classname)}ParserFactory.prototype.createParser=function(l){var d=new Lexer("","");var g=d.getHeaderName(l);var h=d.getHeaderValue(l);if(g==null||h==null){console.error("ParserFactory:createParser(): the header name or value is null");throw"ParserFactory:createParser(): the header name or value is null"}var c=null;var j=g.toLowerCase();for(var e=0;e<this.parserTable.length;e++){if(this.parserTable[e][0]==j){c=this.parserTable[e][1]}}if(c!=null){var a=null;for(e=0;e<this.parserConstructorCache.length;e++){if(this.parserConstructorCache[e][0]==c){c=this.parserConstructorCache[e][1]}}if(a==null){a=new Function("return new "+c)();this.put(this.parserConstructorCache,c,a)}var f=l;var b=new window[c](f);return b}else{return new HeaderParser(l)}};ParserFactory.prototype.put=function(e,b,f){var g=0;for(var d=0;d<e.length;d++){var c=e[d][0];if(c==b){g=1;var a=new Array();a[0]=c;a[1]=f;e[d]=a}}if(g==0){a=new Array();a[0]=b;a[1]=f;e.push(a)}return e};function WSMsgParser(a,b){this.classname="WSMsgParser";this.data=b;this.peerProtocol=null;this.messageProcessor=null;this.sipStack=a}WSMsgParser.prototype.RPORT="rport";WSMsgParser.prototype.RECEIVED="received";WSMsgParser.prototype.parsermessage=function(c){var e=new StringMsgParser();var d=e.parseSIPMessage(this.data);var b=d.getContentLength();var a=0;if(b!=null){a=b.getContentLength()}else{a=0}if(a==0){d.removeContent()}console.info("SIP message received: "+d.encode());this.processMessage(d,c)};WSMsgParser.prototype.processMessage=function(f,h){if(f.getFrom()==null||f.getTo()==null||f.getCallId()==null||f.getCSeq()==null||f.getViaHeaders()==null){return}var e=this.getSIPStack().getChannel();if(f instanceof SIPRequest){this.peerProtocol="WS";var d=f;var c=this.sipStack.newSIPServerRequest(d,e);if(c!=null){c.processRequest(d,e)}}else{var g=f;try{g.checkHeaders()}catch(a){console.error("WSMsgParser:processMessage(): catched exception:"+a);return}var b=this.sipStack.newSIPServerResponse(g,e);if(b!=null){if(b instanceof SIPClientTransaction&&!b.checkFromTag(g)){return}b.processResponse(g,e)}}};WSMsgParser.prototype.getSIPStack=function(){return this.sipStack};function MessageObject(){this.classname="MessageObject"}MessageObject.prototype=new GenericObject();MessageObject.prototype.constructor=MessageObject;MessageObject.prototype.encode=function(){};function ListMap(){this.classname="ListMap";this.headerListTable=new Array();this.initialized=null;this.initializeListMap()}ListMap.prototype.put=function(d,e,b){var j=0;for(var g=0;g<d.length;g++){var f=d[g][0];if(f.classname==e){j=1;var a=new Array();a[0]=e;a[1]=b;d[g]=a}}if(j==0){var h=d.length;a=new Array();a[0]=e;a[1]=b;d[h]=a}};ListMap.prototype.initializeListMap=function(){this.put(this.headerListTable,"Contact","ContactList");this.put(this.headerListTable,"Via","ViaList");this.put(this.headerListTable,"WWW-Authenticate","WWWAuthenticateList");this.put(this.headerListTable,"Route","RouteList");this.put(this.headerListTable,"Proxy-Authenticate","ProxyAuthenticateList");this.put(this.headerListTable,"Allow","AllowList");this.put(this.headerListTable,"RecordRoute","RecordRouteList");this.put(this.headerListTable,"Supported","SupportedList");this.initialized=true};ListMap.prototype.hasList=function(){if(!this.initialized){initializeListMap()}var d=arguments[0];if(typeof d=="object"){if(d instanceof SIPHeaderList){return false}else{var c=d.classname;var a=null}}else{c=d;a=null}for(var b=0;b<this.headerListTable.length;b++){if(this.headerListTable[b][0]==c){a=this.headerListTable[b][1]}}if(a!=null){return true}else{return false}};ListMap.prototype.getListClass=function(c){if(!this.initialized){initializeListMap()}var b=null;for(var a=0;a<this.headerListTable.length;a++){if(this.headerListTable[a][0]==c){b=this.headerListTable[a][1]}}return b};ListMap.prototype.getList=function(e){if(!this.initialized){initializeListMap()}var d=e.headerName;var a=null;for(var c=0;c<this.headerListTable.length;c++){if(this.headerListTable[c][0]==d){a=this.headerListTable[c][1]}}if(a!=null){var b=new Function("return new "+a)();b.setHeaderName(e.getName());return b}else{return null}};function SIPMessage(){this.classname="SIPMessage";this.contentEncodingCharset=new MessageFactoryImpl().getDefaultContentEncodingCharset();this.nullRequest=null;this.unrecognizedHeaders=new Array();this.headers=new Array();this.fromHeader=new From();this.toHeader=new To();this.cSeqHeader=new CSeq();this.callIdHeader=new CallID();this.contentLengthHeader=new ContentDisposition();this.maxForwardsHeader=new MaxForwards();this.size=null;this.messageContent=null;this.nameTable=new Array();this.applicationData=null;var a=new ContentLength(0);this.stackTransaction=null;this.attachHeader(a,false)}SIPMessage.prototype=new MessageObject();SIPMessage.prototype.constructor=SIPMessage;SIPMessage.prototype.NEWLINE="\r\n";SIPMessage.prototype.ViaHeader="Via";SIPMessage.prototype.BRANCH_MAGIC_COOKIE_UPPER_CASE="Z9HG4BK";SIPMessage.prototype.CANCEL="CANCEL";SIPMessage.prototype.CONTENT_TYPE_LOWERCASE="content-type";SIPMessage.prototype.AUTHORIZATION_LOWERCASE="authorization";SIPMessage.prototype.PROXYAUTHORIZATION_LOWERCASE="proxy-authorization";SIPMessage.prototype.CONTACT_LOWERCASE="contact";SIPMessage.prototype.VIA_LOWERCASE="via";SIPMessage.prototype.ROUTE_LOWERCASE="route";SIPMessage.prototype.RECORDROUTE_LOWERCASE="record-route";SIPMessage.prototype.CONTENT_DISPOSITION_LOWERCASE="content-disposition";SIPMessage.prototype.EXPIRES_LOWERCASE="expires";SIPMessage.prototype.isRequestHeader=function(a){if(a instanceof Authorization||a instanceof MaxForwards||a instanceof UserAgent||a instanceof ProxyAuthorization||a instanceof Route||a instanceof RouteList||a instanceof Subject){return true}else{return false}};SIPMessage.prototype.isResponseHeader=function(a){if(a instanceof WWWAuthenticate||a instanceof ProxyAuthenticate){return true}else{return false}};SIPMessage.prototype.getMessageAsEncodedStrings=function(){var a=new Array();for(var d=0;d<this.headers.length;d++){var e=this.headers[d];if(e instanceof SIPHeaderList){var b=e;for(var c=0;c<b.getHeadersAsEncodedStrings().length;c++){a[a.length]=b.getHeadersAsEncodedStrings()[c]}}else{a[a.length]=e.encode()}}return a};SIPMessage.prototype.encodeSIPHeaders=function(){var d="";var a="";for(var c=0;c<this.headers.length;c++){var b=this.headers[c];if(!(b instanceof ContentLength)){a=a+b.encodeBuffer(d)}}a=(a+this.contentLengthHeader.encodeBuffer(d)+this.NEWLINE).toString();return a};SIPMessage.prototype.encodeMessage=function(){};SIPMessage.prototype.getDialogId=function(a){};SIPMessage.prototype.encode=function(){var e="";for(var b=0;b<this.headers.length;b++){var a=this.headers[b];if(!(a instanceof ContentLength)){e=e+a.encode()}}for(b=0;b<this.unrecognizedHeaders.length;b++){var c=this.unrecognizedHeaders[b];e=e+c+this.NEWLINE}e=e+this.contentLengthHeader.encode()+this.NEWLINE;if(this.messageContent!=null){var d=this.messageContent;e=e+d}return e.toString()};SIPMessage.prototype.encodeAsBytes=function(h){if(this instanceof SIPRequest&&this.isNullRequest()){return this.getBytes("\r\n\r\n")}var g=this.getHeader(this.ViaHeader);g.setTransport(h);var f="";for(var c=0;c<this.headers.length;c++){var b=this.headers[c];if(!(b instanceof ContentLength)){b.encode(f)}}this.contentLengthHeader.encode(f);f=f+this.NEWLINE;var a=null;var e=this.getRawContent();if(e!=null){var d=null;d=this.getBytes(f.toString());a=d.concat(e)}else{a=this.getBytes(f.toString())}return a};SIPMessage.prototype.attachHeader=function(){if(arguments.length==1){var a=arguments[0];this.attachHeaderargu1(a)}else{if(arguments.length==2){a=arguments[0];var b=arguments[1];this.attachHeaderargu2(a,b)}else{if(arguments.length==3){a=arguments[0];b=arguments[1];var c=arguments[2];this.attachHeaderargu3(a,b,c)}}}};SIPMessage.prototype.attachHeaderargu1=function(b){if(b==null){console.error("MessageFactoryImpl:attachHeaderargu1(): null header!");throw"MessageFactoryImpl:attachHeaderargu1(): null header!"}if(b instanceof SIPHeaderList){var a=b;if(a.hlist.length==0){return}}this.attachHeaderargu3(b,false,false)};SIPMessage.prototype.attachHeaderargu2=function(a,b){this.attachHeaderargu3(a,b,false)};SIPMessage.prototype.attachHeaderargu3=function(g,v,p){if(g==null){console.error("MessageFactoryImpl:attachHeaderargu3(): null header!");throw"MessageFactoryImpl:attachHeaderargu3(): null header!"}var j=null;var q=new ListMap();if(q.hasList(g)&&!(g instanceof SIPHeaderList)){var b=q.getList(g);b.add(g);j=b}else{j=g}var m=j.getName().toLowerCase();var d=null;for(var e=0;e<this.nameTable.length;e++){if(this.nameTable[e][0]==m){d=e}}if(v){if(d!=null){this.nameTable.splice(d,1)}}else{if(d!=null&&!(j instanceof SIPHeaderList)){if(j instanceof ContentLength){var t=j;this.contentLengthHeader.setContentLength(t.getContentLength())}return}}var u=this.getHeader(g.getName());if(u!=null){var a=this.headers;var c=0;for(e=0;e<this.headers.length;e++){var f=this.headers[e];if(f!=u){a[c]=f;c=c+1}}this.headers=a}if(d==null){var r=new Array();r[0]=m;r[1]=j;this.nameTable.push(r);this.headers.push(j)}else{if(j instanceof SIPHeaderList){var s=this.nameTable[d][0];if(s!=null){s.concatenate(j,p)}else{r=new Array();r[0]=m;r[1]=j;this.nameTable.push(r)}}else{r=new Array();r[0]=m;r[1]=j;this.nameTable.push(r)}}if(j instanceof From){this.fromHeader=j}else{if(j instanceof ContentLength){this.contentLengthHeader=j}else{if(j instanceof To){this.toHeader=j}else{if(j instanceof CSeq){this.cSeqHeader=j}else{if(j instanceof CallID){this.callIdHeader=j}else{if(j instanceof MaxForwards){this.maxForwardsHeader=j}}}}}}};SIPMessage.prototype.setHeader=function(b){var c=b;if(c==null){console.error("MessageFactoryImpl:setHeader(): null header!");throw"MessageFactoryImpl:setHeader(): null header!"}if(c instanceof SIPHeaderList){var a=c;if(a.hlist.length==0){return}}this.removeHeader(c.getHeaderName());this.attachHeader(c,true,false)};SIPMessage.prototype.setHeaders=function(c){for(var a=0;a<c.length;a++){var b=c[a];this.attachHeader(b,false)}};SIPMessage.prototype.removeHeader=function(){if(arguments.length==1){var b=arguments[0];this.removeHeaderargu1(b)}else{if(arguments.length==2){b=arguments[0];var a=arguments[1];this.removeHeaderargu2(b,a)}}};SIPMessage.prototype.removeHeaderargu1=function(f){if(f==null){console.error("MessageFactoryImpl:removeHeaderargu1(): null header!");throw"MessageFactoryImpl:removeHeaderargu1(): null header!"}var b=f.toLowerCase();var e=null;var a=null;for(var c=0;c<this.nameTable.length;c++){if(this.nameTable[c][0]==b){a=c;e=this.nameTable[c][0]}}if(e==null){return}else{this.nameTable.splice(a,1)}if(e instanceof From){this.fromHeader=null}else{if(e instanceof To){this.toHeader=null}else{if(e instanceof CSeq){this.cSeqHeader=null}else{if(e instanceof CallID){this.callIdHeader=null}else{if(e instanceof MaxForwards){this.maxForwardsHeader=null}else{if(e instanceof ContentLength){this.contentLengthHeader=null}}}}}}for(c=0;c<this.headers.length;c++){var d=this.headers[c];if(d.getName().toLowerCase()==b){a=c}}this.headers.splice(a,1)};SIPMessage.prototype.removeHeaderargu2=function(f,h){var g=f.toLowerCase();var a=null;var d=null;var j=null;for(var e=0;e<this.nameTable.length;e++){if(this.nameTable[e][0]==g){d=e;a=this.nameTable[e][1]}}if(a==null){return}if(a instanceof SIPHeaderList){var b=a;if(h){b.removeFirst()}else{b.removeLast()}if(b.hlist.length==0){for(e=0;e<this.headers.length;e++){var c=this.headers[e];if(c.getName().toLowerCase()==g){j=e}}}this.nameTable.splice(d,1);this.headers.splice(j,1)}};SIPMessage.prototype.getTransactionId=function(){var c=new Via();if(this.getViaHeaders().hlist.length!=0){c=this.getViaHeaders().getFirst()}if(c!=null&&c.getBranch()!=null&&c.getBranch().toUpperCase().substr(0,7)==this.BRANCH_MAGIC_COOKIE_UPPER_CASE){if(this.getCSeq().getMethod()==(this.CANCEL)){return(c.getBranch()+":"+this.getCSeq().getMethod()).toLowerCase()}else{return c.getBranch().toLowerCase()}}else{var b="";var f=this.getFrom();var e=this.getTo();if(f.hasTag()){b=b+f.getTag()+"-"}var d=this.callIdHeader.getCallId();b=b+d+"-"+this.cSeqHeader.getSequenceNumber()+"-"+this.cSeqHeader.getMethod();if(c!=null){b=b+"-"+c.getSentBy().encode();if(!c.getSentBy().hasPort()){b=b+"-"+5060}}if(this.getCSeq().getMethod()==this.CANCEL){b=b+this.CANCEL}var a=new Utils();b=b.toString().toLowerCase().replace(":","-").replace("@","-")+a.getSignature();return b}};SIPMessage.prototype.hashCode=function(){if(this.callIdHeader==null){console.error("MessageFactoryImpl:hashCode(): invalid message! Cannot compute hashcode! call-id header is missing !");throw"MessageFactoryImpl:hashCode(): invalid message! Cannot compute hashcode! call-id header is missing !"}else{var c=0;var e=this.callIdHeader.getCallId();if(!(e==null||e.value=="")){for(var a=0;a<e.length;a++){c=c*31+e.charCodeAt(a);var b=2147483647;var d=-2147483648;if(c>b||c<d){c&=4294967295}}}return c}};SIPMessage.prototype.hasContent=function(){return this.messageContent!=null};SIPMessage.prototype.getHeaders=function(){if(arguments.length!=0){var d=arguments[0];if(d==null){console.error("MessageFactoryImpl:getHeaders(): headerName header!");throw"MessageFactoryImpl:getHeaders(): null headerName!"}var c=null;for(var b=0;b<this.nameTable.length;b++){if(this.nameTable[b][0]==d.toLowerCase()){c=this.nameTable[b][1]}}if(c==null){var a=new SIPHeaderList();return a.listIterator()}if(c instanceof SIPHeaderList){return c.listIterator()}else{return new HeaderIterator(this,c)}}else{return this.headers}};SIPMessage.prototype.getHeader=function(a){return this.getHeaderLowerCase(a.toLowerCase())};SIPMessage.prototype.getHeaderLowerCase=function(a){if(a==null){console.error("MessageFactoryImpl:getHeaderLowerCase(): null lowerCaseHeaderName !");throw"MessageFactoryImpl:getHeaderLowerCase(): null lowerCaseHeaderName!"}var c=null;for(var b=0;b<this.nameTable.length;b++){if(this.nameTable[b][0]==a){c=this.nameTable[b][1]}}if(c instanceof SIPHeaderList){return c.getFirst()}else{return c}};SIPMessage.prototype.getContentTypeHeader=function(){return this.getHeaderLowerCase(this.CONTENT_TYPE_LOWERCASE)};SIPMessage.prototype.getWWWAuthenticate=function(){return this.getHeaderLowerCase("www-authenticate")};SIPMessage.prototype.getProxyAuthenticate=function(){return this.getHeaderLowerCase("proxy-authenticate")};SIPMessage.prototype.getContentLengthHeader=function(){return this.getContentLength()};SIPMessage.prototype.getFrom=function(){return this.fromHeader};SIPMessage.prototype.getContactHeaders=function(){return this.getSIPHeaderListLowerCase(this.CONTACT_LOWERCASE)};SIPMessage.prototype.getContactHeader=function(){var a=this.getContactHeaders();if(a!=null){return a.getFirst()}else{return null}};SIPMessage.prototype.getViaHeaders=function(){return this.getSIPHeaderListLowerCase(this.VIA_LOWERCASE)};SIPMessage.prototype.setVia=function(b){if(b.classname=="Via"){var d=new ViaList();d.add(b)}else{d=new ViaList();for(var c=0;c<b.hlist.length;c++){var a=b.hlist[c];d.add(a)}}this.setHeader(d)};SIPMessage.prototype.getTopmostVia=function(){if(this.getViaHeaders()==null){return null}else{return this.getViaHeaders().getFirst()}};SIPMessage.prototype.getCSeq=function(){return this.cSeqHeader};SIPMessage.prototype.getAuthorization=function(){return this.getHeaderLowerCase(this.AUTHORIZATION_LOWERCASE)};SIPMessage.prototype.getProxyAuthorization=function(){return this.getHeaderLowerCase(this.PROXYAUTHORIZATION_LOWERCASE)};SIPMessage.prototype.getMaxForwards=function(){return this.maxForwardsHeader};SIPMessage.prototype.setMaxForwards=function(a){this.setHeader(a)};SIPMessage.prototype.getRouteHeaders=function(){return this.getSIPHeaderListLowerCase(this.ROUTE_LOWERCASE)};SIPMessage.prototype.getCallId=function(){return this.callIdHeader};SIPMessage.prototype.setCallId=function(a){if(typeof a=="object"){this.setHeader(a)}else{if(typeof a=="string"){if(this.callIdHeader==null){this.setHeader(new CallID())}this.callIdHeader.setCallId(a)}}};SIPMessage.prototype.getRecordRouteHeaders=function(){return this.getSIPHeaderListLowerCase(this.RECORDROUTE_LOWERCASE)};SIPMessage.prototype.getTo=function(){return this.toHeader};SIPMessage.prototype.setTo=function(a){this.setHeader(a)};SIPMessage.prototype.setFrom=function(a){this.setHeader(a)};SIPMessage.prototype.getContentLength=function(){return this.contentLengthHeader};SIPMessage.prototype.getMessageContent=function(){return this.messageContent};SIPMessage.prototype.getRawContent=function(){return this.messageContent};SIPMessage.prototype.setMessageContent=function(){if(arguments.length==1){var f=arguments[0];this.computeContentLength(f);this.messageContent=f}else{if(arguments.length==3){var d=arguments[0];var h=arguments[1];var e=arguments[2];var c=new ContentType(d,h);this.setHeader(c);this.messageContent=e;this.computeContentLength(e)}else{if(arguments.length==4){f=arguments[0];var a=arguments[1];var b=arguments[2];var g=arguments[3];this.computeContentLength(f);if((!b)){if((!a&&this.contentLengthHeader.getContentLength()!=g)||this.contentLengthHeader.getContentLength()<g){console.error("MessageFactoryImpl:setMessageContent(): invalid content length "+this.contentLengthHeader.getContentLength()+" / "+g,0);throw"MessageFactoryImpl:setMessageContent(): invalid content length "+this.contentLengthHeader.getContentLength()+" / "+g}}this.messageContent=f}}}};SIPMessage.prototype.setContent=function(b,a){if(b==null){console.error("MessageFactoryImpl:setContent(): null content !",0);throw"MessageFactoryImpl:setContent(): null content!"}this.setHeader(a);this.messageContent=b;this.computeContentLength(b)};SIPMessage.prototype.getContent=function(){if(this.messageContent!=null){return this.messageContent}else{return null}};SIPMessage.prototype.computeContentLength=function(b){var a=0;if(b!=null){if(b instanceof String){a=b.length}else{if(b.constructor==Array){a=b.length}else{a=b.toString().length}}}this.contentLengthHeader.setContentLength(a)};SIPMessage.prototype.removeContent=function(){this.messageContent=null;this.contentLengthHeader.setContentLength(0)};SIPMessage.prototype.getHeaderAsFormattedString=function(b){var d=b.toLowerCase();var a=null;for(var c=0;c<this.nameTable.length;c++){if(this.nameTable[c][0]==d){a=c}}if(a!=null){return this.nameTable[a][1].toString()}else{return this.getHeader(b).toString()}};SIPMessage.prototype.getSIPHeaderListLowerCase=function(a){var b=null;for(var c=0;c<this.nameTable.length;c++){if(this.nameTable[c][0]==a){b=c}}if(b!=null){return this.nameTable[b][1]}else{return null}};SIPMessage.prototype.getHeaderList=function(e){var a=null;for(var b=0;b<this.nameTable.length;b++){if(this.nameTable[b][0]==e.toLowerCase()){a=b}}var d=this.nameTable[a][1];if(d==null){return null}else{if(d instanceof SIPHeaderList){return d.getHeaderList()}else{var c=new Array();c.push(d);return c}}};SIPMessage.prototype.hasHeader=function(c){var a=null;for(var b=0;b<this.nameTable.length;b++){if(this.nameTable[b][0]==c.toLowerCase()){a=b}}if(a!=null){return true}else{return false}};SIPMessage.prototype.hasFromTag=function(){return this.fromHeader!=null&&this.fromHeader.getTag()!=null};SIPMessage.prototype.hasToTag=function(){return this.toHeader!=null&&this.toHeader.getTag()!=null};SIPMessage.prototype.getFromTag=function(){return this.fromHeader==null?null:this.fromHeader.getTag()};SIPMessage.prototype.setFromTag=function(a){this.fromHeader.setTag(a)};SIPMessage.prototype.setToTag=function(a){this.toHeader.setTag(a)};SIPMessage.prototype.getToTag=function(){return this.toHeader==null?null:this.toHeader.getTag()};SIPMessage.prototype.getFirstLine=function(){};SIPMessage.prototype.addHeader=function(){if(typeof arguments[0]!="object"){var f=arguments[0];var e=f.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"")+"\n";try{var a=new ParserFactory();var g=a.createParser(f);var d=g.parse();this.attachHeader(d,false)}catch(c){console.error("SIPMessage:addHeader(): catched exception:"+c);this.unrecognizedHeaders.push(e)}}else{f=arguments[0];try{if((f instanceof ViaList)||(f instanceof RecordRouteList)){this.attachHeader(f,false,true)}else{this.attachHeader(f,false,false)}}catch(c){console.error("SIPMessage:addHeader(): catched exception:"+c);if(f instanceof ContentLength){var b=f;this.contentLengthHeader.setContentLength(b.getContentLength())}}}};SIPMessage.prototype.addUnparsed=function(a){this.unrecognizedHeaders.push(a)};SIPMessage.prototype.getUnrecognizedHeaders=function(){return this.unrecognizedHeaders};SIPMessage.prototype.getHeaderNames=function(){var a=new Array();for(var c=0;c<this.headers.length;c++){var d=this.headers[c];var b=d.getName();a.push(b)}return a};SIPMessage.prototype.getContentDisposition=function(){return this.getHeaderLowerCase(this.CONTENT_DISPOSITION_LOWERCASE)};SIPMessage.prototype.getExpires=function(){return this.getHeaderLowerCase(this.EXPIRES_LOWERCASE)};SIPMessage.prototype.setExpires=function(a){this.setHeader(a)};SIPMessage.prototype.setContentDisposition=function(a){this.setHeader(a)};SIPMessage.prototype.setContentLength=function(a){this.contentLengthHeader.setContentLength(a.getContentLength())};SIPMessage.prototype.setSize=function(a){this.size=a};SIPMessage.prototype.getSize=function(){return this.size};SIPMessage.prototype.addLast=function(a){if(a==null){console.error("SIPMessage:addLast(): null header arg!");throw"SIPMessage:addLast(): null header arg!"}this.attachHeader(a,false,false)};SIPMessage.prototype.addFirst=function(a){if(a==null){console.error("SIPMessage:addFirst(): null header arg!");throw"SIPMessage:addFirst(): null header arg!"}this.attachHeader(a,false,true)};SIPMessage.prototype.removeFirst=function(a){if(a==null){console.error("SIPMessage:removeFirst(): null headerName arg!");throw"SIPMessage:removeFirst(): null headerName arg!"}this.removeHeader(a,true)};SIPMessage.prototype.removeLast=function(a){if(a==null){console.error("SIPMessage:removeLast(): null headerName arg!");throw"SIPMessage:removeLast(): null headerName arg!"}this.removeHeader(a,false)};SIPMessage.prototype.setCSeq=function(a){this.setHeader(a)};SIPMessage.prototype.setApplicationData=function(a){this.applicationData=a};SIPMessage.prototype.getApplicationData=function(){return this.applicationData};SIPMessage.prototype.getMultipartMimeContent=function(){var b=new MultipartMimeContentImpl(this.getContentTypeHeader());var c=this.getRawContent();var a=new String(c);b.createContentList(a);return b};SIPMessage.prototype.getCallIdHeader=function(){return this.callIdHeader};SIPMessage.prototype.getFromHeader=function(){return this.fromHeader};SIPMessage.prototype.getToHeader=function(){return this.toHeader};SIPMessage.prototype.getTopmostViaHeader=function(){return this.getTopmostVia()};SIPMessage.prototype.getCSeqHeader=function(){return this.cSeqHeader};SIPMessage.prototype.getCharset=function(){var a=this.getContentTypeHeader();if(a!=null){var b=a.getCharset();return b!=null?b:this.contentEncodingCharset}else{return this.contentEncodingCharset}};SIPMessage.prototype.isNullRequest=function(){return this.nullRequest};SIPMessage.prototype.setNullRequest=function(){this.nullRequest=true};SIPMessage.prototype.setSIPVersion=function(){};SIPMessage.prototype.getSIPVersion=function(){};SIPMessage.prototype.toString=function(){};SIPMessage.prototype.getBytes=function(b){var c=new Array();b=new String(b);for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};SIPMessage.prototype.getStackTransaction=function(){return this.stackTransaction};SIPMessage.prototype.setStackTransaction=function(a){this.stackTransaction=a};SIPMessage.prototype.addViaHeaderList=function(e){var b=new Array();var d=0;for(var a=0;a<this.headers.length;a++){b[d]=this.headers[a];d=d+1;if((this.headers[a] instanceof ViaList)){if(a==this.headers.length-1||!(this.headers[a] instanceof ViaList)){b[d]=e;d=d+1}if(!(this.headers[a-1] instanceof ViaList)&&a!=0){var c=new Array();c[0]=this.headers[a].getName().toLowerCase();c[1]=this.headers[a];this.nameTable.push(c)}}}if(d==a){b[d]=e;c=new Array();c[0]=e.getName().toLowerCase();c[1]=e;this.nameTable.push(c)}this.headers=b};function MessageFactoryImpl(){this.classname="MessageFactoryImpl";this.testing=false;this.strict=true;this.defaultContentEncodingCharset="UTF-8";this.userAgent=null;this.server=null;if(arguments.length!=0){this.listeningpoint=arguments[0];this.viaheader=this.listeningpoint.getViaHeader()}}MessageFactoryImpl.prototype.CONTENTTYPEHEADER="Content-Type";MessageFactoryImpl.prototype.setStrict=function(){};MessageFactoryImpl.prototype.setTest=function(){};MessageFactoryImpl.prototype.createRequest=function(){if(arguments.length==1){var m=arguments[0];return this.createRequestPrototype5(m)}else{if(arguments.length==7){var d=arguments[0];var a=arguments[1];var e=arguments[2];var b=arguments[3];var g=arguments[4];var h=arguments[5];var c=arguments[6];var l=this.viaheader;return this.createRequestPrototype3(d,a,e,b,g,h,l,c)}else{if(arguments.length==9){if(arguments[7].classname!="ContentType"){d=arguments[0];a=arguments[1];e=arguments[2];b=arguments[3];g=arguments[4];h=arguments[5];l=this.viaheader;c=arguments[6];var f=arguments[7];var j=arguments[8];return this.createRequestPrototype2(d,a,e,b,g,h,l,c,f,j)}else{if(arguments[8].constructor!=Array){d=arguments[0];a=arguments[1];e=arguments[2];b=arguments[3];g=arguments[4];h=arguments[5];l=this.viaheader;c=arguments[6];j=arguments[7];f=arguments[8];return this.createRequestPrototype4(d,a,e,b,g,h,l,c,j,f)}else{if(arguments[8].constructor==Array){d=arguments[0];a=arguments[1];e=arguments[2];b=arguments[3];g=arguments[4];h=arguments[5];l=this.viaheader;c=arguments[6];j=arguments[7];f=arguments[8];return this.createRequestPrototype1(d,a,e,b,g,h,l,c,j,f)}}}}}}};MessageFactoryImpl.prototype.createRequestPrototype1=function(d,a,e,b,h,j,m,c,l,f){if(d==null||a==null||e==null||b==null||h==null||j==null||m==null||c==null||f==null||l==null){console.error("MessageFactoryImpl:createRequestPrototype1(): some parameters are missing, unable to create the request");throw"MessageFactoryImpl:createRequestPrototype1(): some parameters are missing, unable to create the request"}var g=new SIPRequest();g.setRequestURI(d);g.setMethod(a);g.setCallId(e);g.setCSeq(b);g.setFrom(h);g.setTo(j);g.setVia(m);g.setMaxForwards(c);g.setContent(f,l);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createRequestPrototype2=function(d,a,e,b,h,j,m,c,f,l){if(d==null||a==null||e==null||b==null||h==null||j==null||m==null||c==null||f==null||l==null){console.error("MessageFactoryImpl:createRequestPrototype2(): some parameters are missing, unable to create the request");throw"MessageFactoryImpl:createRequestPrototype2(): some parameters are missing, unable to create the request"}var g=new SIPRequest();g.setRequestURI(d);g.setMethod(a);g.setCallId(e);g.setCSeq(b);g.setFrom(h);g.setTo(j);g.setVia(m);g.setMaxForwards(c);g.setHeader(l);g.setMessageContent(f);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createRequestPrototype3=function(d,a,e,b,g,h,j,c){if(d==null||a==null||e==null||b==null||g==null||h==null||j==null||c==null){console.error("MessageFactoryImpl:createRequestPrototype3(): some parameters are missing, unable to create the request");throw"MessageFactoryImpl:createRequestPrototype3(): some parameters are missing, unable to create the request"}var f=new SIPRequest();f.setRequestURI(d);f.setMethod(a);f.setCallId(e);f.setCSeq(b);f.setFrom(g);f.setTo(h);f.setVia(j);f.setMaxForwards(c);if(this.userAgent!=null){f.setHeader(this.userAgent)}return f};MessageFactoryImpl.prototype.createRequestPrototype4=function(d,a,e,b,h,j,m,c,l,f){if(d==null||a==null||e==null||b==null||h==null||j==null||m==null||c==null||f==null||l==null){console.error("MessageFactoryImpl:createRequestPrototype4(): some parameters are missing, unable to create the request");throw"MessageFactoryImpl:createRequestPrototype4(): some parameters are missing, unable to create the request"}var g=new SIPRequest();g.setRequestURI(d);g.setMethod(a);g.setCallId(e);g.setCSeq(b);g.setFrom(h);g.setTo(j);g.setVia(m);g.setMaxForwards(c);g.setContent(f,l);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createRequestPrototype5=function(b){if(b==null||b.equals("")){var a=new SIPRequest();a.setNullRequest();return a}var d=new StringMsgParser();d.setStrict(this.strict);var c=d.parseSIPMessage(b);if(!(c instanceof SIPRequest)){console.error("MessageFactoryImpl:createRequestPrototype5(): parsing error");throw"MessageFactoryImpl:createRequestPrototype5(): parsing error"}return c};MessageFactoryImpl.prototype.createResponse=function(){if(arguments.length==1){var f=arguments[0];return this.createReponsePrototype9(f)}else{if(arguments.length==2){var d=arguments[0];var c=arguments[1];return this.createReponsePrototype6(d,c)}else{if(arguments.length==4){if(arguments[3].constructor!=Array){d=arguments[0];c=arguments[1];var l=arguments[2];var g=arguments[3];return this.createReponsePrototype4(d,c,l,g)}else{if(arguments[3].constructor==Array){d=arguments[0];c=arguments[1];l=arguments[2];g=arguments[3];return this.createReponsePrototype5(d,c,l,g)}}}else{if(arguments.length==7){d=arguments[0];var e=arguments[1];var a=arguments[2];var j=arguments[3];var h=arguments[4];var m=arguments[5];var b=arguments[6];return this.createReponsePrototype3(d,e,a,j,h,m,b)}else{if(arguments.length==9){if(arguments[8].classname=="ContentType"){if(arguments[7].constructor!=Array){d=arguments[0];e=arguments[1];a=arguments[2];j=arguments[3];h=arguments[4];m=arguments[5];b=arguments[6];g=arguments[7];l=arguments[8];return this.createReponsePrototype1(d,e,a,j,h,m,b,g,l)}else{if(arguments[7].constructor==Array){d=arguments[0];e=arguments[1];a=arguments[2];j=arguments[3];h=arguments[4];m=arguments[5];b=arguments[6];g=arguments[7];l=arguments[8];return this.createReponsePrototype2(d,e,a,j,h,m,b,g,l)}}}else{if(arguments[8].classname!="ContentType"){if(arguments[7].constructor!=Array){d=arguments[0];e=arguments[1];a=arguments[2];j=arguments[3];h=arguments[4];m=arguments[5];b=arguments[6];l=arguments[7];g=arguments[8];return this.createReponsePrototype7(d,e,a,j,h,m,b,l,g)}else{if(arguments[7].constructor==Array){d=arguments[0];e=arguments[1];a=arguments[2];j=arguments[3];h=arguments[4];m=arguments[5];b=arguments[6];l=arguments[7];g=arguments[8];return this.createReponsePrototype8(d,e,a,j,h,m,b,l,g)}}}}}}}}}};MessageFactoryImpl.prototype.createReponsePrototype1=function(e,f,a,j,l,n,d,h,m){if(f==null||a==null||j==null||l==null||n==null||d==null||h==null||m==null){console.error("MessageFactoryImpl:createReponsePrototype1(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype1(): some parameters are missing, unable to create the response"}var g=new SIPResponse();var c=new StatusLine();c.setStatusCode(e);var b=g.getReasonPhrase(e);c.setReasonPhrase(b);g.setStatusLine(c);g.setCallId(f);g.setCSeq(a);g.setFrom(j);g.setTo(l);g.setVia(n);g.setMaxForwards(d);g.setContent(h,m);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createReponsePrototype2=function(c,d,a,g,h,l,b,f,j){if(d==null||a==null||g==null||h==null||l==null||b==null||f==null||j==null){console.error("MessageFactoryImpl:createReponsePrototype2(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype2(): some parameters are missing, unable to create the response"}var e=new SIPResponse();e.setStatusCode(c);e.setCallId(d);e.setCSeq(a);e.setFrom(g);e.setTo(h);e.setVia(l);e.setMaxForwards(b);e.setHeader(j);e.setMessageContent(f);if(this.userAgent!=null){e.setHeader(this.userAgent)}return e};MessageFactoryImpl.prototype.createReponsePrototype3=function(d,c,e,h,g,a,b){if(c==null||e==null||h==null||g==null||a==null||b==null){console.error("MessageFactoryImpl:createReponsePrototype3(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype3(): some parameters are missing, unable to create the response"}var f=new SIPResponse();f.setStatusCode(d);f.setCallId(c);f.setCSeq(e);f.setFrom(h);f.setTo(g);f.setVia(a);f.setMaxForwards(b);if(this.userAgent!=null){f.setHeader(this.userAgent)}return f};MessageFactoryImpl.prototype.createReponsePrototype4=function(a,d,f,c){if(d==null||c==null||f==null){console.error("MessageFactoryImpl:createReponsePrototype4(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype4(): some parameters are missing, unable to create the response"}var b=d;var e=b.createResponse(a);e.setContent(c,f);if(this.server!=null){e.setHeader(this.server)}return e};MessageFactoryImpl.prototype.createReponsePrototype5=function(a,d,f,c){if(d==null||c==null||f==null){console.error("MessageFactoryImpl:createReponsePrototype5(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype5(): some parameters are missing, unable to create the response"}var b=d;var e=b.createResponse(a);e.setHeader(f);e.setMessageContent(c);if(this.server!=null){e.setHeader(this.server)}return e};MessageFactoryImpl.prototype.createReponsePrototype6=function(a,c){if(c==null||content==null||contentType==null){console.error("MessageFactoryImpl:createReponsePrototype6(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype6(): ome parameters are missing, unable to create the response"}var b=c;var d=b.createResponse(a);d.removeContent();d.removeHeader(this.CONTENTTYPEHEADER);if(this.server!=null){d.setHeader(this.server)}return d};MessageFactoryImpl.prototype.createReponsePrototype7=function(d,f,a,j,l,n,c,m,h){if(f==null||a==null||j==null||l==null||n==null||c==null||h==null||m==null){console.error("MessageFactoryImpl:createReponsePrototype7(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype7(): some parameters are missing, unable to create the response"}var g=new SIPResponse();var b=new StatusLine();b.setStatusCode(d);var e=g.getReasonPhrase(d);if(e==null){console.error("MessageFactoryImpl:createReponsePrototype7(): unknown statusCode "+d);throw"MessageFactoryImpl:createReponsePrototype7(): unknown statusCode "+d}b.setReasonPhrase(e);g.setStatusLine(b);g.setCallId(f);g.setCSeq(a);g.setFrom(j);g.setTo(l);g.setVia(n);g.setContent(h,m);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createReponsePrototype8=function(d,f,a,j,l,n,c,m,h){if(f==null||a==null||j==null||l==null||n==null||c==null||h==null||m==null){console.error("MessageFactoryImpl:createReponsePrototype8(): some parameters are missing, unable to create the response");throw"MessageFactoryImpl:createReponsePrototype8(): some parameters are missing, unable to create the response"}var g=new SIPResponse();var b=new StatusLine();b.setStatusCode(d);var e=g.getReasonPhrase(d);if(e==null){console.error("MessageFactoryImpl:createReponsePrototype8(): unknown statusCode "+d);throw"MessageFactoryImpl:createReponsePrototype8(): unknown statusCode "+d}b.setReasonPhrase(e);g.setStatusLine(b);g.setCallId(f);g.setCSeq(a);g.setFrom(j);g.setTo(l);g.setVia(n);g.setContent(h,m);if(this.userAgent!=null){g.setHeader(this.userAgent)}return g};MessageFactoryImpl.prototype.createReponsePrototype9=function(a){if(a==null){return new SIPResponse()}var c=new StringMsgParser();var b=c.parseSIPMessage(a);if(!(b instanceof SIPResponse)){console.error("MessageFactoryImpl:createReponsePrototype9(): parse error");throw"MessageFactoryImpl:createReponsePrototype9(): parse error"}return b};MessageFactoryImpl.prototype.setDefaultUserAgentHeader=function(a){this.userAgent=a};MessageFactoryImpl.prototype.setDefaultServerHeader=function(a){this.server=a};MessageFactoryImpl.prototype.getDefaultUserAgentHeader=function(){return this.userAgent};MessageFactoryImpl.prototype.getDefaultServerHeader=function(){return this.server};MessageFactoryImpl.prototype.setDefaultContentEncodingCharset=function(a){if(a==null){throw new NullPointerException("Null argument!")}this.defaultContentEncodingCharset=a};MessageFactoryImpl.prototype.getDefaultContentEncodingCharset=function(){return this.defaultContentEncodingCharset};MessageFactoryImpl.prototype.createMultipartMimeContent=function(c,h,j,f){var b=c.getParameter("boundary");var a=new MultipartMimeContentImpl(c);for(var d=0;d<h.length;d++){var e=new ContentType(h[d],j[d]);var g=new ContentImpl(f[d],b);g.setContentTypeHeader(e);a.add(g)}return a};MessageFactoryImpl.prototype.getBytes=function(b){var c=new Array();b=new String(b);for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};MessageFactoryImpl.prototype.addHeader=function(a,b){a.addHeader(b);return a};MessageFactoryImpl.prototype.setNewViaHeader=function(e){this.viaheader=this.listeningpoint.getViaHeader();if(e instanceof SIPRequest){var a=new SIPRequest();a.setMethod(e.getMethod());a.setRequestURI(e.getRequestURI())}else{a=new SIPResponse()}var d=e.getHeaders();for(var b=0;b<d.length;b++){a.addHeader(d[b])}if(e.getCSeq()!=null&&e.getCallId()!=null&&e.getViaHeaders()!=null&&e.getFrom()!=null&&e.getTo()!=null&&e.getMaxForwards()!=null){a.setCSeq(e.getCSeq());a.setCallId(e.getCallId());a.setVia(this.viaheader);a.setFrom(e.getFrom());a.setTo(e.getTo());a.setMaxForwards(e.getMaxForwards());if(e.getContent()!=null){var c=e.getContent();var f=e.getContentTypeHeader();a.setContent(c,f)}}return a};function SIPRequest(){this.classname="SIPRequest";this.serialVersionUID="3360720013577322927L";this.transactionPointer=null;this.requestLine=new RequestLine();this.messageChannel=null;this.inviteTransaction=null;this.targetRefreshMethods=new Array();this.nameTable=new Array();this.unrecognizedHeaders=new Array();this.headers=new Array();this.attachHeader(new ContentLength(0),false);this.targetRefreshMethods.push(this.INVITE);this.targetRefreshMethods.push(this.UPDATE);this.targetRefreshMethods.push(this.SUBSCRIBE);this.targetRefreshMethods.push(this.NOTIFY);this.targetRefreshMethods.push(this.REFER);this.putName(this.INVITE);this.putName(this.BYE);this.putName(this.CANCEL);this.putName(this.ACK);this.putName(this.PRACK);this.putName(this.INFO);this.putName(this.MESSAGE);this.putName(this.NOTIFY);this.putName(this.OPTIONS);this.putName(this.PRACK);this.putName(this.PUBLISH);this.putName(this.REFER);this.putName(this.REGISTER);this.putName(this.SUBSCRIBE);this.putName(this.UPDATE)}SIPRequest.prototype=new SIPMessage();SIPRequest.prototype.constructor=SIPRequest;SIPRequest.prototype.DEFAULT_USER="ip";SIPRequest.prototype.DEFAULT_TRANSPORT="tcp";SIPRequest.prototype.INVITE="INVITE";SIPRequest.prototype.BYE="BYE";SIPRequest.prototype.CANCEL="CANCEL";SIPRequest.prototype.ACK="ACK";SIPRequest.prototype.PRACK="PRACK";SIPRequest.prototype.INFO="INFO";SIPRequest.prototype.MESSAGE="MESSAGE";SIPRequest.prototype.NOTIFY="NOTIFY";SIPRequest.prototype.OPTIONS="OPTIONS";SIPRequest.prototype.PUBLISH="PUBLISH";SIPRequest.prototype.REFER="REFER";SIPRequest.prototype.REGISTER="REGISTER";SIPRequest.prototype.SUBSCRIBE="SUBSCRIBE";SIPRequest.prototype.UPDATE="UPDATE";SIPRequest.prototype.CSeqHeader="CSeq";SIPRequest.prototype.ToHeader="To";SIPRequest.prototype.CallIdHeader="Call-ID";SIPRequest.prototype.FromHeader="From";SIPRequest.prototype.ViaHeader="Via";SIPRequest.prototype.MaxForwardsHeader="Max-Forwards";SIPRequest.prototype.EventHeader="Event";SIPRequest.prototype.ContactHeader="Contact";SIPRequest.prototype.COLON=":";SIPRequest.prototype.putName=function(a){var b=new Array();b[0]=a;b[1]=a;this.nameTable.push(b)};SIPRequest.prototype.isTargetRefresh=function(c){var a=null;for(var b=0;b<this.targetRefreshMethods;b++){if(this.targetRefreshMethods[b]==c){a=1}}if(a!=null){return true}else{return false}};SIPRequest.prototype.isDialogCreating=function(b){var a=new SIPTransactionStack();return a.isDialogCreated(b)};SIPRequest.prototype.getCannonicalName=function(c){var a=null;for(var b=0;b<this.nameTable;b++){if(this.nameTable[b][0]==c){a=b}}if(a!=null){return this.nameTable[a][1]}else{return c}};SIPRequest.prototype.getRequestLine=function(){return this.requestLine};SIPRequest.prototype.setRequestLine=function(a){this.requestLine=a};SIPRequest.prototype.checkHeaders=function(){var c="Missing a required header : ";if(this.getCSeq()==null){console.error("SIPRequest:checkHeaders(): "+c+this.CSeqHeader);throw"SIPRequest:checkHeaders(): "+c+this.CSeqHeader}if(this.getTo()==null){console.error("SIPRequest:checkHeaders(): "+c+this.ToHeader);throw"SIPRequest:checkHeaders(): "+c+this.ToHeader}if(this.callIdHeader==null||this.callIdHeader.getCallId()==null||this.callIdHeader.getCallId()==""){console.error("SIPRequest:checkHeaders(): "+c+this.CallIdHeader);throw"SIPRequest:checkHeaders(): "+c+this.CallIdHeader}if(this.getFrom()==null){console.error("SIPRequest:checkHeaders(): "+c+this.FromHeader);throw"SIPRequest:checkHeaders(): "+c+this.FromHeader}if(this.getViaHeaders()==null){console.error("SIPRequest:checkHeaders(): "+c+this.ViaHeader);throw"SIPRequest:checkHeaders(): "+c+this.ViaHeader}if(this.getMaxForwards()==null){console.error("SIPRequest:checkHeaders(): "+c+this.MaxForwardsHeader);throw"SIPRequest:checkHeaders(): "+c+this.MaxForwardsHeader}if(this.getTopmostVia()==null){console.error("SIPRequest:checkHeaders(): no via header in request!");throw"SIPRequest:checkHeaders():  no via header in request!"}if(this.getMethod()==this.NOTIFY){if(getHeader(this.EventHeader)==null){console.error("SIPRequest:checkHeaders(): "+c+this.EventHeader);throw"SIPRequest:checkHeaders(): "+c+this.EventHeader}}else{if(this.getMethod()==this.PUBLISH){if(this.getHeader(this.EventHeader)==null){console.error("SIPRequest:checkHeaders(): "+c+this.EventHeader)}throw"SIPRequest:checkHeaders(): "+c+this.EventHeader}}if(this.requestLine.getMethod()==this.INVITE||this.requestLine.getMethod()==this.SUBSCRIBE||this.requestLine.getMethod()==this.REFER){if(this.getContactHeader()==null){if(this.getToTag()==null){console.error("SIPRequest:checkHeaders(): "+c+this.ContactHeader);throw"SIPRequest:checkHeaders(): "+c+this.ContactHeader}}if(this.requestLine.getUri() instanceof SipUri){var a=(this.requestLine.getUri()).getScheme();if("sips"==a.toLowerCase()){var b=this.getContactHeader().getAddress().getURI();if(b.getScheme()!="sips"){console.error("SIPRequest:checkHeaders(): scheme for contact should be sips:"+b);throw"SIPRequest:checkHeaders(): scheme for contact should be sips:"+b}}}}if(this.getContactHeader()==null&&(this.getMethod()==this.INVITE||this.getMethod()==this.REFER||this.getMethod()==this.SUBSCRIBE)){console.error("SIPRequest:checkHeaders(): Contact Header is Mandatory for a SIP INVITE");throw"SIPRequest:checkHeaders(): Scheme for contact should be sips:"+b}if(this.requestLine!=null&&this.requestLine.getMethod()!=null&&this.getCSeq().getMethod()!=null&&this.requestLine.getMethod()!=this.getCSeq().getMethod()){console.error("SIPRequest:checkHeaders(): CSEQ method mismatch with  Request-Line");throw"SIPRequest:checkHeaders(): CSEQ method mismatch with  Request-Line"}};SIPRequest.prototype.setDefaults=function(){if(this.requestLine==null){return}var c=this.requestLine.getMethod();if(c==null){return}var a=this.requestLine.getUri();if(a==null){return}if(c==this.REGISTER||c==this.INVITE){if(a instanceof SipUri){var b=a;b.setUserParam(this.DEFAULT_USER);b.setTransportParam(this.DEFAULT_TRANSPORT)}}};SIPRequest.prototype.setRequestLineDefaults=function(){var b=this.requestLine.getMethod();if(b==null){var a=this.getCSeq();if(a!=null){b=this.getCannonicalName(a.getMethod());this.requestLine.setMethod(b)}}};SIPRequest.prototype.getRequestURI=function(){if(this.requestLine==null){return null}else{return this.requestLine.getUri()}};SIPRequest.prototype.setRequestURI=function(a){if(a==null){console.error("SIPRequest:setRequestURI(): null request URI");throw"SIPRequest:setRequestURI(): null request URI"}if(this.requestLine==null){this.requestLine=new RequestLine()}this.requestLine.setUri(a);this.nullRequest=false};SIPRequest.prototype.setMethod=function(b){if(b==null){console.error("SIPRequest:setMethod(): null method");throw"SIPRequest:setMethod(): null method"}if(this.requestLine==null){this.requestLine=new RequestLine()}var a=this.getCannonicalName(b);this.requestLine.setMethod(a);if(this.cSeqHeader!=null){this.cSeqHeader.setMethod(a)}};SIPRequest.prototype.getMethod=function(){if(this.requestLine==null){return null}else{return this.requestLine.getMethod()}};SIPRequest.prototype.encode=function(){var a=null;if(this.requestLine!=null){this.setRequestLineDefaults();a=this.requestLine.encode()+this.superencode()}else{if(this.isNullRequest()){a="\r\n\r\n"}else{a=this.superencode()}}return a};SIPRequest.prototype.encodeMessage=function(){var a;if(this.requestLine!=null){this.setRequestLineDefaults();a=this.requestLine.encode()+this.encodeSIPHeaders()}else{if(this.isNullRequest()){a="\r\n\r\n"}else{a=this.encodeSIPHeaders()}}return a};SIPRequest.prototype.toString=function(){return this.encode()};SIPRequest.prototype.superencode=function(){var f="";for(var b=0;b<this.headers.length;b++){var a=this.headers[b];if(!(a instanceof ContentLength)){f=f+a.encode()}}for(b=0;b<this.unrecognizedHeaders.length;b++){var d=this.unrecognizedHeaders[b];f=f+d+this.NEWLINE}f=f+this.contentLengthHeader.encode()+this.NEWLINE;if(this.messageContentObject!=null){var c=this.getContent().toString();f=f+c}else{if(this.messageContent!=null||this.messageContentBytes!=null){var e="";if(this.messageContent!=null){e=this.messageContent}else{for(b=0;b<this.messageContentBytes.length;b++){e=e+this.messageContentBytes[b]}}f=f+e}}return f.toString()};SIPRequest.prototype.getMessageAsEncodedStrings=function(){var a=Object.getPrototypeOf(this).getMessageAsEncodedStrings();if(this.requestLine!=null){this.setRequestLineDefaults();a.addFirst(this.requestLine.encode())}return a};SIPRequest.prototype.getDialogId=function(){if(arguments.length==1){var a=arguments[0];return this.getDialogIdargu1(a)}else{if(arguments.length==2){a=arguments[0];var b=arguments[1];return this.getDialogIdargu2(a,b)}}};SIPRequest.prototype.getDialogIdargu1=function(b){var e=this.getCallId();var a=e.getCallId();var d=this.getFrom();var c=this.getTo();if(!b){if(d.getTag()!=null){a=a+this.COLON+d.getTag()}if(c.getTag()!=null){a=a+this.COLON+c.getTag()}}else{if(c.getTag()!=null){a=a+this.COLON+c.getTag()}if(d.getTag()!=null){a=a+this.COLON+d.getTag()}}return a.toString().toLowerCase()};SIPRequest.prototype.getDialogIdargu2=function(b,c){var e=this.getFrom();var d=this.getCallId();var a=d.getCallId();if(!b){if(e.getTag()!=null){a=a+this.COLON+e.getTag()}if(c!=null){a=a+this.COLON+c}}else{if(c!=null){a=a+this.COLON+c}if(e.getTag()!=null){a=a+this.COLON+e.getTag()}}return a.toString().toLowerCase()};SIPRequest.prototype.createResponse=function(){if(arguments.length==1){var c=arguments[0];return this.createResponseargu1(c)}else{if(arguments.length==2){c=arguments[0];var d=arguments[1];return this.createResponseargu2(c,d)}else{if(arguments.length==3){c=arguments[0];d=arguments[1];var b=arguments[2];var a=this.createResponseargu2(c,d);return this.createResponseargu3(a,b)}}}};SIPRequest.prototype.createResponseargu1=function(a){var c=new SIPResponse();var b=c.getReasonPhrase(a);return this.createResponseargu2(a,b)};SIPRequest.prototype.createResponseargu2=function(f,d){var e=new SIPResponse();var h=null;var m=null;try{e.setStatusCode(f)}catch(j){console.error("SIPRequest:createResponseargu2(): bad code "+f);throw"SIPRequest:createResponseargu2(): bad code "+f}if(d!=null){e.setReasonPhrase(d)}else{var l=new SIPResponse();e.setReasonPhrase(l.getReasonPhrase(f))}h=this.getHeaders();for(var g=0;g<h.length;g++){m=h[g];if(m instanceof To){if(!m.hasTag()){var b=new Date();var n=b.getTime();m.setTag(n)}}if(m instanceof ViaList){e.addViaHeaderList(m)}else{if(!(m instanceof ContactList)&&!(m instanceof UserAgent)){if(e.getStatusCode()==200){e.attachHeader(m,false)}else{if(!(m instanceof ContentLength)&&!(m instanceof ContentType)){e.attachHeader(m,false)}}}}}if(this.getMessageContent()!=null&&e.getStatusCode()==200){e.setMessageContent(this.getMessageContent())}var a=new MessageFactoryImpl();if(a.getDefaultServerHeader()!=null){e.setHeader(a.getDefaultServerHeader())}if(e.getStatusCode()==100){e.getTo().removeParameter("tag")}if(e.getStatusCode()==480&&e.getHeaders("recordroute")!=null){e.removeHeader("record-route")}var c=a.getDefaultServerHeader();if(c!=null){e.setHeader(c)}return e};SIPRequest.prototype.createResponseargu3=function(b,a){b.addContactUseragent(a);return b};SIPRequest.prototype.mustCopyRR=function(a){if(a>100&&a<300){return this.isDialogCreating(this.getMethod())&&this.getToTag()==null}else{return false}};SIPRequest.prototype.createCancelRequest=function(){if(this.getMethod()!=this.INVITE){console.error("SIPRequest:createCancelRequest(): Attempt to create CANCEL for "+this.getMethod());throw"SIPRequest:createCancelRequest(): Attempt to create CANCEL for "+this.getMethod()}var b=new SIPRequest();b.setRequestLine(this.requestLine);b.setMethod(this.CANCEL);b.setHeader(this.callIdHeader);b.setHeader(this.toHeader);b.setHeader(this.cSeqHeader);b.getCSeq().setMethod(this.CANCEL);b.setHeader(this.fromHeader);b.addFirst(this.getTopmostVia());b.setHeader(this.maxForwardsHeader);if(this.getRouteHeaders()!=null){b.setHeader(this.getRouteHeaders())}var a=new MessageFactoryImpl();if(a.getDefaultUserAgentHeader()!=null){b.setHeader(a.getDefaultUserAgentHeader())}return b};SIPRequest.prototype.createAckRequest=function(){if(arguments.length==1){var a=arguments[0];return this.createAckRequest_argu1(a)}else{return this.createACKRequest_argu0()}};SIPRequest.prototype.createAckRequest_argu1=function(f){var b=new SIPRequest();var e=null;b.setRequestLine(this.requestLine);b.setMethod(this.ACK);var g=this.getHeaders();for(var d=0;d<g.length;d++){e=g[d];if(e instanceof RouteList){continue}else{if(e instanceof ProxyAuthorization){continue}else{if(e instanceof ContentLength){e.setContentLength(0)}else{if(e instanceof ContentType){continue}else{if(e instanceof CSeq){var c=e;c.setMethod(this.ACK);e=c}else{if(e instanceof To){if(f!=null){e=f}else{e=e}}else{if(e instanceof ContactList||e instanceof Expires){continue}else{if(e instanceof ViaList){e=e.getFirst()}else{e=e}}}}}}}}b.attachHeader(e,false)}var a=new MessageFactoryImpl();if(a.getDefaultUserAgentHeader()!=null){b.setHeader(a.getDefaultUserAgentHeader())}return b};SIPRequest.prototype.createErrorAck=function(e){var b=new SIPRequest();var c=new RequestLine();c.setMethod(this.ACK);c.setUri(this.requestLine.getUri());var d=new CSeq();d.setMethod(this.ACK);d.setSeqNumber(this.cSeqHeader.getSequenceNumber());b.setRequestLine(c);b.setMethod(this.ACK);b.setHeader(this.callIdHeader);b.setHeader(this.maxForwardsHeader);b.setHeader(this.fromHeader);b.setHeader(e);b.addFirst(this.getTopmostVia());b.setHeader(d);if(this.getRouteHeaders()!=null){b.setHeader(this.getRouteHeaders())}var a=new MessageFactoryImpl();if(a.getDefaultUserAgentHeader()!=null){b.setHeader(a.getDefaultUserAgentHeader())}return b};SIPRequest.prototype.createSIPRequest=function(n,c){var d=new SIPRequest();d.requestLine=n;var e=this.getHeaders();var g=null;var q=null;for(var b=0;b<e.length;b++){var r=e[b];if(r instanceof CSeq){var h=r;r=h;h.setMethod(n.getMethod())}else{if(r.classname=="ViaList"){var p=r.getFirst();r=p}else{if(r instanceof To){var l=r;if(c){r=new From(l)}else{r=l}}else{if(r instanceof From){var j=r;if(c){r=new To(j)}else{r=j}}else{if(r instanceof ContentLength){var m=r;m.setContentLength(0);r=m}else{if(!(r instanceof CallID)&&!(r instanceof MaxForwards)&&!(r instanceof Expires)&&!(r instanceof UserAgent)&&!(r instanceof AllowList)&&!(r instanceof ContactList)){continue}}}}}}d.attachHeader(r,false)}var a=new MessageFactoryImpl();if(a.getDefaultUserAgentHeader()!=null){d.setHeader(a.getDefaultUserAgentHeader())}return d};SIPRequest.prototype.createBYERequest=function(a){var b=this.requestLine;this.requestLine.setMethod("BYE");return this.createSIPRequest(b,a)};SIPRequest.prototype.createACKRequest_argu0=function(){var a=this.requestLine;this.requestLine.setMethod(this.ACK);return this.createSIPRequest(a,false)};SIPRequest.prototype.getViaHost=function(){var a=this.getViaHeaders().getFirst();return a.getHost()};SIPRequest.prototype.getViaPort=function(){var a=this.getViaHeaders().getFirst();if(a.hasPort()){return a.getPort()}else{return 5060}};SIPRequest.prototype.getFirstLine=function(){if(this.requestLine==null){return null}else{return this.requestLine.encode()}};SIPRequest.prototype.setSIPVersion=function(a){if(a==null||(a.toLowerCase()!=("SIP/2.0").toLowerCase())){console.error("SIPRequest:setSIPVersion(): bad sipVersion",0);throw"SIPRequest:setSIPVersion(): bad sipVersion"}this.requestLine.setSipVersion(a)};SIPRequest.prototype.getSIPVersion=function(){return this.requestLine.getSipVersion()};SIPRequest.prototype.getTransaction=function(){return this.transactionPointer};SIPRequest.prototype.setTransaction=function(a){this.transactionPointer=a};SIPRequest.prototype.getMessageChannel=function(){return this.messageChannel};SIPRequest.prototype.setMessageChannel=function(a){this.messageChannel=a};SIPRequest.prototype.getMergeId=function(){var d=this.getFromTag();var b=this.cSeqHeader.toString();var c=this.callIdHeader.getCallId();var e=this.getRequestURI().toString();if(d!=null){var a="";a=(a+e+":"+d+":"+b+":"+c).toString();return a}else{return null}};SIPRequest.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPRequest.prototype.getInviteTransaction=function(){return this.inviteTransaction};SIPRequest.prototype.fortest=function(){var b=this.requestLine.encode();for(var d=0;d<this.headers.length;d++){var c=this.headers[d];if(!(c instanceof ContentLength)){var a=c.encode();b=b+a}}return b};function SIPResponse(){this.classname="SIPResponse";this.statusLine=new StatusLine();this.nameTable=new Array();this.unrecognizedHeaders=new Array();this.headers=new Array();this.attachHeader(new ContentLength(0),false)}SIPResponse.prototype=new SIPMessage();SIPResponse.prototype.constructor=SIPResponse;SIPResponse.prototype.TRYING=100;SIPResponse.prototype.RINGING=180;SIPResponse.prototype.CALL_IS_BEING_FORWARDED=181;SIPResponse.prototype.QUEUED=182;SIPResponse.prototype.SESSION_PROGRESS=183;SIPResponse.prototype.OK=200;SIPResponse.prototype.ACCEPTED=202;SIPResponse.prototype.MULTIPLE_CHOICES=300;SIPResponse.prototype.MOVED_PERMANENTLY=301;SIPResponse.prototype.MOVED_TEMPORARILY=302;SIPResponse.prototype.USE_PROXY=305;SIPResponse.prototype.ALTERNATIVE_SERVICE=380;SIPResponse.prototype.BAD_REQUEST=400;SIPResponse.prototype.UNAUTHORIZED=401;SIPResponse.prototype.PAYMENT_REQUIRED=402;SIPResponse.prototype.FORBIDDEN=403;SIPResponse.prototype.NOT_FOUND=404;SIPResponse.prototype.METHOD_NOT_ALLOWED=405;SIPResponse.prototype.NOT_ACCEPTABLE=406;SIPResponse.prototype.PROXY_AUTHENTICATION_REQUIRED=407;SIPResponse.prototype.REQUEST_TIMEOUT=408;SIPResponse.prototype.GONE=410;SIPResponse.prototype.TEMPORARILY_UNAVAILABLE=480;SIPResponse.prototype.REQUEST_ENTITY_TOO_LARGE=413;SIPResponse.prototype.REQUEST_URI_TOO_LONG=414;SIPResponse.prototype.UNSUPPORTED_MEDIA_TYPE=415;SIPResponse.prototype.UNSUPPORTED_URI_SCHEME=416;SIPResponse.prototype.BAD_EXTENSION=420;SIPResponse.prototype.EXTENSION_REQUIRED=421;SIPResponse.prototype.INTERVAL_TOO_BRIEF=423;SIPResponse.prototype.CALL_OR_TRANSACTION_DOES_NOT_EXIST=481;SIPResponse.prototype.LOOP_DETECTED=482;SIPResponse.prototype.TOO_MANY_HOPS=483;SIPResponse.prototype.ADDRESS_INCOMPLETE=484;SIPResponse.prototype.AMBIGUOUS=485;SIPResponse.prototype.BUSY_HERE=486;SIPResponse.prototype.REQUEST_TERMINATED=487;SIPResponse.prototype.NOT_ACCEPTABLE_HERE=488;SIPResponse.prototype.BAD_EVENT=489;SIPResponse.prototype.REQUEST_PENDING=491;SIPResponse.prototype.SERVER_INTERNAL_ERROR=500;SIPResponse.prototype.UNDECIPHERABLE=493;SIPResponse.prototype.NOT_IMPLEMENTED=501;SIPResponse.prototype.BAD_GATEWAY=502;SIPResponse.prototype.SERVICE_UNAVAILABLE=503;SIPResponse.prototype.SERVER_TIMEOUT=504;SIPResponse.prototype.VERSION_NOT_SUPPORTED=505;SIPResponse.prototype.MESSAGE_TOO_LARGE=513;SIPResponse.prototype.BUSY_EVERYWHERE=600;SIPResponse.prototype.DECLINE=603;SIPResponse.prototype.DOES_NOT_EXIST_ANYWHERE=604;SIPResponse.prototype.SESSION_NOT_ACCEPTABLE=606;SIPResponse.prototype.CONDITIONAL_REQUEST_FAILED=412;SIPResponse.prototype.CSeq="CSeq";SIPResponse.prototype.To="To";SIPResponse.prototype.From="From";SIPResponse.prototype.Via="Via";SIPResponse.prototype.CallID="Call-ID";SIPResponse.prototype.COLON=":";SIPResponse.prototype.CANCEL="CANCEL";SIPResponse.prototype.ACK="ACK";SIPResponse.prototype.getReasonPhrase=function(){if(arguments.length==1){var a=arguments[0];return this.getReasonPhrase_argu1(a)}else{return this.getReasonPhrase_argu0()}};SIPResponse.prototype.getReasonPhrase_argu1=function(b){var a=null;switch(b){case this.TRYING:a="Trying";break;case this.RINGING:a="Ringing";break;case this.CALL_IS_BEING_FORWARDED:a="Call is being forwarded";break;case this.QUEUED:a="Queued";break;case this.SESSION_PROGRESS:a="Session progress";break;case this.OK:a="OK";break;case this.ACCEPTED:a="Accepted";break;case this.MULTIPLE_CHOICES:a="Multiple choices";break;case this.MOVED_PERMANENTLY:a="Moved permanently";break;case this.MOVED_TEMPORARILY:a="Moved Temporarily";break;case this.USE_PROXY:a="Use proxy";break;case this.ALTERNATIVE_SERVICE:a="Alternative service";break;case this.BAD_REQUEST:a="Bad request";break;case this.UNAUTHORIZED:a="Unauthorized";break;case this.PAYMENT_REQUIRED:a="Payment required";break;case this.FORBIDDEN:a="Forbidden";break;case this.NOT_FOUND:a="Not found";break;case this.METHOD_NOT_ALLOWED:a="Method not allowed";break;case this.NOT_ACCEPTABLE:a="Not acceptable";break;case this.PROXY_AUTHENTICATION_REQUIRED:a="Proxy Authentication required";break;case this.REQUEST_TIMEOUT:a="Request timeout";break;case this.GONE:a="Gone";break;case this.TEMPORARILY_UNAVAILABLE:a="Temporarily Unavailable";break;case this.REQUEST_ENTITY_TOO_LARGE:a="Request entity too large";break;case this.REQUEST_URI_TOO_LONG:a="Request-URI too large";break;case this.UNSUPPORTED_MEDIA_TYPE:a="Unsupported media type";break;case this.UNSUPPORTED_URI_SCHEME:a="Unsupported URI Scheme";break;case this.BAD_EXTENSION:a="Bad extension";break;case this.EXTENSION_REQUIRED:a="Etension Required";break;case this.INTERVAL_TOO_BRIEF:a="Interval too brief";break;case this.CALL_OR_TRANSACTION_DOES_NOT_EXIST:a="Call leg/Transaction does not exist";break;case this.LOOP_DETECTED:a="Loop detected";break;case this.TOO_MANY_HOPS:a="Too many hops";break;case this.ADDRESS_INCOMPLETE:a="Address incomplete";break;case this.AMBIGUOUS:a="Ambiguous";break;case this.BUSY_HERE:a="Busy here";break;case this.REQUEST_TERMINATED:a="Request Terminated";break;case this.NOT_ACCEPTABLE_HERE:a="Not Acceptable here";break;case this.BAD_EVENT:a="Bad Event";break;case this.REQUEST_PENDING:a="Request Pending";break;case this.SERVER_INTERNAL_ERROR:a="Server Internal Error";break;case this.UNDECIPHERABLE:a="Undecipherable";break;case this.NOT_IMPLEMENTED:a="Not implemented";break;case this.BAD_GATEWAY:a="Bad gateway";break;case this.SERVICE_UNAVAILABLE:a="Service unavailable";break;case this.SERVER_TIMEOUT:a="Gateway timeout";break;case this.VERSION_NOT_SUPPORTED:a="SIP version not supported";break;case this.MESSAGE_TOO_LARGE:a="Message Too Large";break;case this.BUSY_EVERYWHERE:a="Busy everywhere";break;case this.DECLINE:a="Decline";break;case this.DOES_NOT_EXIST_ANYWHERE:a="Does not exist anywhere";break;case this.SESSION_NOT_ACCEPTABLE:a="Session Not acceptable";break;case this.CONDITIONAL_REQUEST_FAILED:a="Conditional request failed";break;default:a="Unknown Status"}return a};SIPResponse.prototype.setStatusCode=function(a){if(a<100||a>699){console.error("SIPResponse:setStatusCode(): bad status code");throw"SIPResponse:setStatusCode(): bad status code"}if(this.statusLine==null){this.statusLine=new StatusLine()}this.statusLine.setStatusCode(a)};SIPResponse.prototype.getStatusLine=function(){return this.statusLine};SIPResponse.prototype.getStatusCode=function(){return this.statusLine.getStatusCode()};SIPResponse.prototype.setReasonPhrase=function(a){if(a==null){console.error("SIPResponse:setReasonPhrase(): bad reason phrase");throw"SIPResponse:setReasonPhrase(): bad reason phrase"}if(this.statusLine==null){this.statusLine=new StatusLine()}this.statusLine.setReasonPhrase(a)};SIPResponse.prototype.getReasonPhrase_argu0=function(){if(this.statusLine==null||this.statusLine.getReasonPhrase()==null){return""}else{return this.statusLine.getReasonPhrase()}};SIPResponse.prototype.isFinalResponse=function(a){if(a==null){a=this.statusLine.getStatusCode()}if(a>=200&&a<700){return true}else{return false}};SIPResponse.prototype.setStatusLine=function(a){this.statusLine=a};SIPResponse.prototype.checkHeaders=function(){if(this.getCSeq()==null){console.error("SIPResponse:checkHeaders(): "+this.CSeq+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.CSeq+" is missing "}if(this.getTo()==null){console.error("SIPResponse:checkHeaders(): "+this.To+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.To+" is missing "}if(this.getFrom()==null){console.error("SIPResponse:checkHeaders(): "+this.From+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.From+" is missing "}if(this.getViaHeaders()==null){console.error("SIPResponse:checkHeaders(): "+this.Via+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.Via+" is missing "}if(this.getCallId()==null){console.error("SIPResponse:checkHeaders(): "+this.CallID+" is missing ",0);throw"SIPResponse:checkHeaders(): "+this.CallID+" is missing "}if(this.getStatusCode()>699){console.error("SIPResponse:checkHeaders(): unknown error code!"+this.getStatusCode(),0);throw"SIPResponse:checkHeaders(): unknown error code!"+this.getStatusCode()}};SIPResponse.prototype.encode=function(){var a;if(this.statusLine!=null){a=this.statusLine.encode()+this.superencode()}else{a=this.superencode()}return a};SIPResponse.prototype.encodeMessage=function(){var a;if(this.statusLine!=null){a=this.statusLine.encode()+this.encodeSIPHeaders()}else{a=this.encodeSIPHeaders()}return a};SIPResponse.prototype.superencode=function(){var f="";for(var b=0;b<this.headers.length;b++){var a=this.headers[b];if(!(a instanceof ContentLength)){f=f+a.encode()}}for(b=0;b<this.unrecognizedHeaders.length;b++){var d=this.unrecognizedHeaders[b];f=f+d+this.NEWLINE}f=f+this.contentLengthHeader.encode()+this.NEWLINE;if(this.messageContentObject!=null){var c=this.getContent().toString();f=f+c}else{if(this.messageContent!=null||this.messageContentBytes!=null){var e="";if(this.messageContent!=null){e=this.messageContent}else{for(b=0;b<this.messageContentBytes.length;b++){e=e+this.messageContentBytes[b]}}f=f+e}}return f.toString()};SIPResponse.prototype.getMessageAsEncodedStrings=function(){var b=Object.getPrototypeOf(this).getMessageAsEncodedStrings();if(this.statusLine!=null){var a=new Array();a[0]=this.statusLine.encode();for(var c=0;c<this.retval.length;c++){a[c+1]=this.retval[c]}b=a}return b};SIPResponse.prototype.encodeAsBytes=function(d){var b=new Array();if(this.statusLine!=null){b=this.getBytes(this.statusLine.encode())}var c=Object.getPrototypeOf(this).encodeAsBytes(d);var a=new Array();a=b.concat(c);return a};SIPResponse.prototype.getDialogId=function(){if(arguments.length==1){var a=arguments[0];return this.getDialogIdargu1(a)}else{if(arguments.length==2){a=arguments[0];var b=arguments[1];return this.getDialogIdargu2(a,b)}}};SIPResponse.prototype.getDialogIdargu1=function(b){var e=this.getCallId();var a=e.getCallId();var d=this.getFrom();var c=this.getTo();if(!b){if(d.getTag()!=null){a=a+this.COLON+d.getTag()}if(c.getTag()!=null){a=a+this.COLON+c.getTag()}}else{if(c.getTag()!=null){a=a+this.COLON+c.getTag()}if(d.getTag()!=null){a=a+this.COLON+d.getTag()}}return a.toString().toLowerCase()};SIPResponse.prototype.getDialogIdargu2=function(b,c){var e=this.getFrom();var d=this.getCallId();var a=d.getCallId();if(!b){if(e.getTag()!=null){a=a+this.COLON+e.getTag()}if(c!=null){a=a+this.COLON+c}}else{if(c!=null){a=a+this.COLON+c}if(e.getTag()!=null){a=a+this.COLON+e.getTag()}}return a.toString().toLowerCase()};SIPResponse.prototype.setBranch=function(b,d){var c;if(d==this.ACK){if(this.statusLine.getStatusCode()>=300){c=this.getTopmostVia().getBranch()}else{var a=new Utils();c=a.getInstance().generateBranchId()}}else{if(d==this.CANCEL){c=this.getTopmostVia().getBranch()}else{return}}b.setBranch(c)};SIPResponse.prototype.getFirstLine=function(){if(this.statusLine==null){return null}else{return this.statusLine.encode()}};SIPResponse.prototype.setSIPVersion=function(a){this.statusLine.setSipVersion(a)};SIPResponse.prototype.getSIPVersion=function(){return this.statusLine.getSipVersion()};SIPResponse.prototype.toString=function(){if(this.statusLine==null){return""}else{return this.statusLine.encode()+Object.getPrototypeOf(this).encode()}};SIPResponse.prototype.createRequest=function(d,m,b,j,l){var g=new SIPRequest();var a=b.getMethod();var e=this.getCallId();g.setMethod(a);g.setRequestURI(d);this.setBranch(m,a);g.setHeader(m);g.setHeader(j);g.setHeader(l);g.setHeader(b);g.setHeader(e);g.attachHeader(new MaxForwards(70),false);var h=g.getHeaders();for(var f=0;f<h.length;f++){var n=h[f];if(this.isResponseHeader(n)||n instanceof ViaList||n instanceof CSeq||n instanceof ContentType||n instanceof ContentLength||n instanceof RecordRouteList||n instanceof ContactList||n instanceof ContentLength||n instanceof Reason||n instanceof ReasonList){continue}if(n instanceof To){n=l}else{if(n instanceof From){n=j}}g.attachHeader(n,false)}var c=new MessageFactoryImpl();if(c.getDefaultUserAgentHeader()!=null){g.setHeader(c.getDefaultUserAgentHeader())}return g};SIPResponse.prototype.getBytes=function(b){var c=new Array();b=new String(b);for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};SIPResponse.prototype.addContactUseragent=function(c){var a=c.getContactHeader();var b=c.getHeader("User-Agent");this.addHeader(a);this.addHeader(b)};SIPResponse.prototype.fortest=function(){var b=this.statusLine.encode();for(var d=0;d<this.headers.length;d++){var c=this.headers[d];if(!(c instanceof ContentLength)){var a=c.encode();b=b+a}}return b};function HopImpl(){this.classname="HopImpl";this.host=null;this.port=null;this.transport="WS";this.defaultRoute=null;this.uriRoute=null;this.wsurl=null;if(arguments.length==1){var a=arguments[0];if(a==null){console.error("HopImpl:HopImpl(): null arg!");throw"HopImpl:HopImpl(): null arg!"}var c=a.indexOf("]");var f=a.indexOf(":",c);var e=a.indexOf("/",f);if(f>0){this.host=a.substring(0,f);var b;if(e>0){b=a.substring(f+1,e);this.transport=a.substring(e+1)}else{b=a.substring(f+1)}this.port=b-0}else{if(e>0){this.host=a.substring(0,e);this.transport=a.substring(e+1);this.port=8080}else{this.host=a;this.port=8080}}if(this.host==null||this.host.length==0){console.error("HopImpl:HopImpl(): no host!");throw"HopImpl:HopImpl(): no host!"}this.host=this.host.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"");this.transport=this.transport.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"");if((c>0)&&this.host.charAt(0)!="["){console.error("HopImpl:HopImpl(): bad IPv6 reference spec");throw"HopImpl:HopImpl(): bad IPv6 reference spec"}if((this.transport.toLowerCase()!="tcp")&&(this.transport.toLowerCase()!="ws")){console.error("HopImpl:HopImpl(): bad transport string "+this.transport);throw"HopImpl:HopImpl(): bad transport string "+this.transport}}else{if(arguments.length==3){var h=arguments[0];var g=arguments[1];var d=arguments[2];this.host=h;if(this.host.indexOf(":")>=0){if(this.host.indexOf("[")<0){this.host="["+this.host+"]"}}this.port=g;this.transport=d}}}HopImpl.prototype.toString=function(){return this.host+":"+this.port+"/"+this.transport};HopImpl.prototype.getHost=function(){return this.host};HopImpl.prototype.getPort=function(){return this.port};HopImpl.prototype.getTransport=function(){return this.transport};HopImpl.prototype.getURLWS=function(){return this.wsurl};HopImpl.prototype.isURIRoute=function(){return this.uriRoute};HopImpl.prototype.setURIRouteFlag=function(){this.uriRoute=true};HopImpl.prototype.setURLWS=function(a){this.wsurl=a};function SIPTransactionStack(){this.classname="SIPTransactionStack";this.messageProcessors=new Array();this.sipMessageFactory=null;this.activeClientTransactionCount=0;this.mergeTable=new Array();this.defaultRouter=null;this.needsLogging=null;this.stackName=null;this.router=null;this.maxConnections=-1;this.useRouterForAll=null;this.readTimeout=-1;this.outboundProxy=null;this.routerPath=null;this.isAutomaticDialogSupportEnabled=null;this.forkedEvents=new Array();this.generateTimeStampHeader=null;this.cancelClientTransactionChecked=true;this.remoteTagReassignmentAllowed=true;this.logStackTraceOnMessageSend=true;this.stackDoesCongestionControl=true;this.checkBranchId=false;this.isAutomaticDialogErrorHandlingEnabled=true;this.isDialogTerminatedEventDeliveredForNullDialog=false;this.serverTransactionTable=new Array();this.clientTransactionTable=new Array();this.terminatedServerTransactionsPendingAck=new Array();this.forkedClientTransactionTable=new Array();this.dialogCreatingMethods=new Array();this.dialogTable=new Array();this.earlyDialogTable=new Array();this.pendingTransactions=new Array();this.unlimitedServerTransactionTableSize=true;this.unlimitedClientTransactionTableSize=true;this.serverTransactionTableHighwaterMark=5000;this.serverTransactionTableLowaterMark=4000;this.clientTransactionTableHiwaterMark=1000;this.clientTransactionTableLowaterMark=800;this.rfc2543Supported=true;this.timer=0;this.maxForkTime=0;this.toExit=false;this.isBackToBackUserAgent=false;this.maxListenerResponseTime=-1;this.non2XXAckPassedToListener=null;this.maxMessageSize=null;this.addressResolver=new DefaultAddressResolver();this.stackAddress=null;this.dialogCreatingMethods.push("REFER");this.dialogCreatingMethods.push("INVITE");this.dialogCreatingMethods.push("SUBSCRIBE");this.dialogCreatingMethods.push("REGISTER")}SIPTransactionStack.prototype.BASE_TIMER_INTERVAL=500;SIPTransactionStack.prototype.CONNECTION_LINGER_TIME=8;SIPTransactionStack.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";SIPTransactionStack.prototype.TRYING=100;SIPTransactionStack.prototype.RINGING=180;SIPTransactionStack.prototype.reInit=function(){this.messageProcessors=new Array();this.pendingTransactions=new Array();this.clientTransactionTable=new Array();this.serverTransactionTable=new Array();this.mergeTable=new Array();this.dialogTable=new Array();this.earlyDialogTable=new Array();this.terminatedServerTransactionsPendingAck=new Array();this.forkedClientTransactionTable=new Array();this.timer=null;this.activeClientTransactionCount=0};SIPTransactionStack.prototype.addExtensionMethod=function(b){if(b!="NOTIFY"){var a=null;for(var c=0;c<this.dialogCreatingMethods.length;c++){if(this.dialogCreatingMethods[c]==b.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"").toUpperCase()){a=c}}if(a==null){this.dialogCreatingMethods.push(b.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"").toUpperCase())}}};SIPTransactionStack.prototype.removeDialog=function(){if(typeof arguments[0]=="objet"){var b=arguments[0];this.removeDialogobjet(b)}else{if(typeof arguments[0]=="string"){var a=arguments[0];this.removeDialogstring(a)}}};SIPTransactionStack.prototype.removeDialogstring=function(b){var a=null;for(var c=0;c<this.dialogTable.length;c++){if(this.dialogTable[c][0]==b){a=c}}if(a!=null){this.dialogTable.splice(a,1)}};SIPTransactionStack.prototype.removeDialogobjet=function(e){var g=e.getDialogId();var c=e.getEarlyDialogId();if(c!=null){var b=null;for(var d=0;d<this.earlyDialogTable.length;d++){if(this.earlyDialogTable[d][0]==c){b=d}}this.earlyDialogTable.splice(b,1);for(d=0;d<this.dialogTable.length;d++){if(this.dialogTable[d][0]==c){b=d}}if(b!=null){this.dialogTable.splice(b,1)}}if(g!=null){var a=null;for(d=0;d<this.dialogTable.length;d++){if(this.dialogTable[d][0]==g){a=this.dialogTable[d][1]}}if(a==e){for(d=0;d<this.dialogTable.length;d++){if(this.dialogTable[d][0]==g){b=d}}if(b!=null){this.dialogTable.splice(b,1)}}if(!e.testAndSetIsDialogTerminatedEventDelivered()){var f=new DialogTerminatedEvent(e.getSipProvider(),e);e.getSipProvider().handleEvent(f,null)}}};SIPTransactionStack.prototype.findSubscribeTransaction=function(h,j){var b=null;var f=h.getTo().getTag();if(f==null){return b}var a=h.getHeader("Event");if(a==null){return b}for(var d=0;d<this.clientTransactionTable.length;d++){var g=this.clientTransactionTable[d][1];if(g.getMethod()!="SUBSCRIBE"){continue}var c=g.from.getTag();var e=g.event;if(e==null){continue}if(c.toLowerCase()==f.toLowerCase()&&e!=null&&a.match(e)&&h.getCallId().getCallId().toLowerCase()==g.callId.getCallId().toLowerCase()){b=g;return b}}return b};SIPTransactionStack.prototype.removeTransactionPendingAck=function(e){var c=e.getRequest().getTopmostVia().getBranch();var a=null;for(var b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.terminatedServerTransactionsPendingAck[b][0]==c){a=b}}if(a!=null){var d=true}else{d=false}if(c!=null&&d){a=null;for(b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.terminatedServerTransactionsPendingAck[b][0]==c){a=b}}if(a!=null){this.terminatedServerTransactionsPendingAck.splice(a,1)}return true}else{return false}};SIPTransactionStack.prototype.removeTransactionHash=function(e){var d=e.getOriginalRequest();if(d==null){return}if(e instanceof SIPClientTransaction){var c=e.getTransactionId();var a=null;for(var b=0;b<this.clientTransactionTable.length;b++){if(this.clientTransactionTable[b][0]==c){a=b}}this.clientTransactionTable.splice(a,1)}else{if(e instanceof SIPServerTransaction){c=e.getTransactionId();a=null;for(b=0;b<this.serverTransactionTable.length;b++){if(this.serverTransactionTable[b][0]==c){a=b}}this.serverTransactionTable.splice(a,1)}}};SIPTransactionStack.prototype.removePendingTransaction=function(c){var a=null;for(var b=0;b<this.pendingTransactions.length;b++){if(this.pendingTransactions[b][0]==c.getTransactionId()){a=b}}if(a!=null){this.pendingTransactions.splice(a,1)}};SIPTransactionStack.prototype.isAlive=function(){if(!this.toExit){return true}else{return false}};SIPTransactionStack.prototype.getTimer=function(){return this.timer};SIPTransactionStack.prototype.findCancelTransaction=function(f,c){if(c){for(var a=0;a<this.serverTransactionTable.length;a++){var d=this.serverTransactionTable[a][1];var e=d;if(e.doesCancelMatchTransaction(f)){return e}}}else{for(a=0;a<this.clientTransactionTable.length;a++){d=this.clientTransactionTable[a][1];var b=d;if(b.doesCancelMatchTransaction(f)){return b}}}return null};SIPTransactionStack.prototype.getDialog=function(b){var a=null;for(var d=0;d<this.dialogTable.length;d++){if(this.dialogTable[d][0]==b){a=d}}if(a!=null){var c=this.dialogTable[a][1];return c}else{return null}};SIPTransactionStack.prototype.isDialogCreated=function(c){var a=null;for(var b=0;b<this.dialogCreatingMethods.length;b++){if(this.dialogCreatingMethods[b]==c){a=b}}if(a!=null){return true}else{return false}};SIPTransactionStack.prototype.isRfc2543Supported=function(){return this.rfc2543Supported};SIPTransactionStack.prototype.createDialog=function(){if(arguments.length==1){var b=arguments[0];return this.createDialogargu1(b)}else{if(arguments.length==2){if(arguments[0].classname=="SipProviderImpl"){var a=arguments[0];c=arguments[1];return new SIPDialog(a,c)}else{b=arguments[0];var c=arguments[1];return this.createDialogargu2(b,c)}}}};SIPTransactionStack.prototype.createDialogargu1=function(f){var c=null;if(f instanceof SIPClientTransaction){var b=f.getRequest().getDialogId(false);var a=null;for(var e=0;e<this.earlyDialogTable.length;e++){if(this.earlyDialogTable[e][0]==b){a=e}}if(a!=null){var d=this.earlyDialogTable[a][1];if(d.getState()==null||d.getState()=="EARLY"){c=d}else{c=new SIPDialog(f);this.earlyDialogTable[a][1]=c}}else{c=new SIPDialog(f);var g=new Array();g[0]=b;g[1]=c;this.earlyDialogTable.push(g)}}else{c=new SIPDialog(f)}return c};SIPTransactionStack.prototype.createDialogargu2=function(e,f){var c=e.getRequest().getDialogId(false);var b=null;var a=null;for(var d=0;d<this.earlyDialogTable.length;d++){if(this.earlyDialogTable[d][0]==c){a=d}}if(a!=null){b=this.earlyDialogTable[a][1];if(f.isFinalResponse()){this.earlyDialogTable.splice(a,1)}}else{b=new SIPDialog(e,f)}return b};SIPTransactionStack.prototype.createRawMessageChannel=function(){var a=null;for(var b=0;b<this.messageProcessors.length&&a==null;b++){var c=this.messageProcessors[b];if(c.getURLWS()==this.wsurl){a=c.createMessageChannel()}}return a};SIPTransactionStack.prototype.isNon2XXAckPassedToListener=function(){if(this.non2XXAckPassedToListener){return true}else{return false}};SIPTransactionStack.prototype.isTransactionPendingAck=function(d){var c=d.getRequest().getTopmostVia().getBranch();var a=null;for(var b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.terminatedServerTransactionsPendingAck[b][0]==c){a=b}}if(a!=null){return true}else{return false}};SIPTransactionStack.prototype.setNon2XXAckPassedToListener=function(a){this.non2XXAckPassedToListener=a};SIPTransactionStack.prototype.addForkedClientTransaction=function(b){var a=null;for(var c=0;c<this.forkedClientTransactionTable.length;c++){if(this.forkedClientTransactionTable[c][0]==b.getTransactionId()){a=c;this.forkedClientTransactionTable[c][1]=b}}if(a==null){var d=new Array();d[0]=b.getTransactionId();d[1]=b;this.forkedClientTransactionTable.push(d)}};SIPTransactionStack.prototype.getForkedTransaction=function(c){var a=null;for(var b=0;b<this.forkedClientTransactionTable.length;b++){if(this.forkedClientTransactionTable[b][0]==c){a=b}}if(a!=null){return this.forkedClientTransactionTable[a][1]}else{return null}};SIPTransactionStack.prototype.addTransactionPendingAck=function(d){var c=d.getRequest().getTopmostVia().getBranch();if(c!=null){var a=null;for(var b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.forkedClientTransactionTable[b][0]==c){a=b;this.forkedClientTransactionTable[b][1]=d}}if(a==null){var e=new Array();e[0]=c;e[1]=d;this.forkedClientTransactionTable.push(e)}}};SIPTransactionStack.prototype.findTransactionPendingAck=function(c){var a=null;for(var b=0;b<this.terminatedServerTransactionsPendingAck.length;b++){if(this.terminatedServerTransactionsPendingAck[b][0]==c.getTopmostVia().getBranch()){a=b}}if(a==null){return null}else{return this.terminatedServerTransactionsPendingAck[a][1]}};SIPTransactionStack.prototype.putDialog=function(d){var b=d.getDialogId();var a=null;for(var c=0;c<this.dialogTable.length;c++){if(this.dialogTable[c][0]==b){a=c}}if(a!=null){return}d.setStack(this);var e=new Array();e[0]=b;e[1]=d;this.dialogTable.push(e)};SIPTransactionStack.prototype.findPendingTransaction=function(b){var a=null;for(var c=0;c<this.pendingTransactions.length;c++){if(this.dialogTable[c][0]==b.getTransactionId()){a=c}}if(a==null){return null}else{return this.pendingTransactions[a][1]}};SIPTransactionStack.prototype.putPendingTransaction=function(c){var a=null;for(var b=0;b<this.pendingTransactions.length;b++){if(this.pendingTransactions[b][0]==c.getTransactionId()){a=b;this.pendingTransactions[b][1]=c}}if(a==null){var d=new Array();d[0]=c.getTransactionId();d[1]=c;this.pendingTransactions.push(d)}};SIPTransactionStack.prototype.removePendingTransaction=function(c){var a=null;for(var b=0;b<this.pendingTransactions.length;b++){if(this.pendingTransactions[b][0]==c.getTransactionId()){a=b}}this.pendingTransactions.splice(a,1)};SIPTransactionStack.prototype.getServerTransactionTableSize=function(){return this.serverTransactionTable.length};SIPTransactionStack.prototype.getClientTransactionTableSize=function(){return this.clientTransactionTable.length};SIPTransactionStack.prototype.findTransaction=function(g,f){var a=null;if(f){var c=g.getTopmostVia();if(c.getBranch()!=null){var e=g.getTransactionId();for(var d=0;d<this.serverTransactionTable.length;d++){if(this.serverTransactionTable[d][0]==e){a=this.serverTransactionTable[d][1]}}if(e.substring(0,7).toLowerCase()=="z9hg4bk"){return a}}for(d=0;d<this.serverTransactionTable.length;d++){var h=this.serverTransactionTable[d][1];if(h.isMessagePartOfTransaction(g)){a=h;return a}}}else{c=g.getTopmostVia();if(c.getBranch()!=null){e=g.getTransactionId();for(d=0;d<this.clientTransactionTable.length;d++){if(this.clientTransactionTable[d][0]==e){a=this.clientTransactionTable[d][1]}}if(e.substring(0,7).toLowerCase()=="z9hg4bk"){return a}}for(d=0;d<this.serverTransactionTable.length;d++){var b=this.clientTransactionTable[d][1];if(b.isMessagePartOfTransaction(g)){a=b;return a}}}return a};SIPTransactionStack.prototype.removeFromMergeTable=function(d){var c=d.getRequest().getMergeId();var a=null;if(c!=null){for(var b=0;b<this.mergeTable.length;b++){if(this.mergeTable[b][0]==c){a=b}}if(a!=null){this.mergeTable.splice(a,1)}}};SIPTransactionStack.prototype.putInMergeTable=function(d,c){var e=c.getMergeId();var a=null;if(e!=null){for(var b=0;b<this.mergeTable.length;b++){if(this.mergeTable[b][0]==e){this.mergeTable[b][1]=d;a=b}}if(a==null){var f=new Array();f[0]=e;f[1]=d;this.mergeTable.push(f)}}};SIPTransactionStack.prototype.addTransactionHash=function(e){var d=e.getOriginalRequest();if(e instanceof SIPClientTransaction){this.activeClientTransactionCount++;var a=null;var c=d.getTransactionId();for(var b=0;b<this.clientTransactionTable.length;b++){if(this.clientTransactionTable[b][0]==c){a=b;this.clientTransactionTable[b][1]=e}}if(a==null){var f=new Array();f[0]=c;f[1]=e;this.clientTransactionTable.push(f)}}else{a=null;c=d.getTransactionId();for(b=0;b<this.serverTransactionTable.length;b++){if(this.serverTransactionTable[b][0]==c){a=b;this.serverTransactionTable[b][1]=e}}if(a==null){f=new Array();f[0]=c;f[1]=e;this.serverTransactionTable.push(f)}}};SIPTransactionStack.prototype.setMessageFactory=function(a){this.sipMessageFactory=a};SIPTransactionStack.prototype.checkBranchIdFunction=function(){return this.checkBranchId};SIPTransactionStack.prototype.addMessageProcessor=function(c){var a=null;for(var b=0;b<this.messageProcessors.length;b++){if(this.messageProcessors[b]==c){a=b}}if(a==null){this.messageProcessors.push(c)}};SIPTransactionStack.prototype.findMergedTransaction=function(g){if(g.getMethod()!="INVITE"){return null}var f=g.getMergeId();var a=null;for(var e=0;e<this.mergeTable.length;e++){if(this.mergeTable[e][0]==f){a=this.mergeTable[e][1]}}if(f==null){return null}else{if(a!=null&&!a.isMessagePartOfTransaction(g)){return a}else{for(e=0;e<this.dialogTable.length;e++){var d=this.dialogTable[e][1];var b=d;if(b.getFirstTransaction()!=null&&b.getFirstTransaction() instanceof SIPServerTransaction){var h=b.getFirstTransaction();var c=b.getFirstTransaction().getOriginalRequest();if((!h.isMessagePartOfTransaction(g))&&g.getMergeId()==c.getMergeId()){return b.getFirstTransaction()}}}return null}}};SIPTransactionStack.prototype.mapTransaction=function(a){if(a.isMapped){return}this.addTransactionHash(a);a.isMapped=true};SIPTransactionStack.prototype.createTransaction=function(a,c,b){var d=null;if(c==null){return null}d=this.createClientTransaction(a,c);d.setViaPort(b.getPort());d.setViaHost(b.getHost());this.addTransactionHash(d);return d};SIPTransactionStack.prototype.createClientTransaction=function(b,c){var a=new SIPClientTransaction(this,c);a.setOriginalRequest(b);return a};SIPTransactionStack.prototype.addTransaction=function(a){if(a instanceof SIPServerTransaction){a.map()}this.addTransactionHash(a)};SIPTransactionStack.prototype.transactionErrorEvent=function(a){var b=a.getSource();if(a.getErrorID()==2){b.setState("TERMINATED");if(b instanceof SIPServerTransaction){b.collectionTime=0}b.disableTimeoutTimer()}};SIPTransactionStack.prototype.dialogErrorEvent=function(b){var a=b.getSource();if(a!=null){a.delet()}};SIPTransactionStack.prototype.stopStack=function(){if(this.timer!=null){clearTimeout(this.timer)}this.timer=null;this.pendingTransactions=new Array();this.toExit=true;var b=this.getMessageProcessors();for(var a=0;a<b.length;a++){this.removeMessageProcessor(b[a]);this.clientTransactionTable=new Array();this.serverTransactionTable=new Array();this.dialogTable=new Array()}};SIPTransactionStack.prototype.getMaxMessageSize=function(){return this.maxMessageSize};SIPTransactionStack.prototype.getNextHop=function(a){if(this.useRouterForAll){if(this.router!=null){return this.router.getNextHop(a)}else{return null}}else{if(a.getRequestURI().isSipURI()||a.getRouteHeaders()!=null){return this.defaultRouter.getNextHop(a)}else{if(this.router!=null){return this.router.getNextHop(a)}else{return null}}}};SIPTransactionStack.prototype.setStackName=function(a){this.stackName=a};SIPTransactionStack.prototype.setHostAddress=function(a){if(a.indexOf(":")!=a.lastIndexOf(":")&&a.replace(/^(\s|\xA0)+|(\s|\xA0)+$/g,"").charAt(0)!="["){this.stackAddress="["+a+"]"}else{this.stackAddress=a}this.stackInetAddress=a};SIPTransactionStack.prototype.getHostAddress=function(){return this.stackAddress};SIPTransactionStack.prototype.setRouter=function(a){this.router=a};SIPTransactionStack.prototype.getRouter=function(){if(arguments.length==0){this.getRouterargu0()}else{var a=arguments[0];this.getRouterargu1(a)}};SIPTransactionStack.prototype.getRouterargu0=function(){return this.router};SIPTransactionStack.prototype.getRouterargu1=function(a){if(a.getRequestLine()==null){return this.defaultRouter}else{if(this.useRouterForAll){return this.router}else{if(a.getRequestURI().getScheme()=="sip"||a.getRequestURI().getScheme()=="sips"){return this.defaultRouter}else{if(this.router!=null){return this.router}else{return this.defaultRouter}}}}};SIPTransactionStack.prototype.removeMessageProcessor=function(b){var a=null;for(var c=0;c<this.messageProcessors.lengt;c++){if(this.messageProcessors[c]==b){a=c}}if(a!=null){this.messageProcessors.splice(a,1);b.stop()}};SIPTransactionStack.prototype.getMessageProcessors=function(){return this.messageProcessors};SIPTransactionStack.prototype.isEventForked=function(c){var a=null;for(var b=0;b<this.forkedEvents.length;b++){if(this.forkedEvents[b]==c){a=b}}if(a!=null){return true}else{return false}};SIPTransactionStack.prototype.getActiveClientTransactionCount=function(){return this.activeClientTransactionCount};SIPTransactionStack.prototype.isCancelClientTransactionChecked=function(){return this.cancelClientTransactionChecked};SIPTransactionStack.prototype.isRemoteTagReassignmentAllowed=function(){return this.remoteTagReassignmentAllowed};SIPTransactionStack.prototype.getDialogs=function(){if(arguments.length==0){return this.getDialogsargu0()}else{var a=arguments[0];return this.getDialogsargu1(a)}};SIPTransactionStack.prototype.getDialogsargu0=function(){var d=new Array();for(var c=0;c<this.dialogTable.length;c++){var b=null;for(var a=0;a<d.legnth;a++){if(d[a]==this.dialogTable[c][1]){b=c}}if(b==null){d.push(this.dialogTable[c][1])}}for(c=0;c<this.earlyDialogTable.length;c++){b=null;for(a=0;a<d.legnth;a++){if(d[a]==this.earlyDialogTable[c][1]){b=c}}if(b==null){d.push(this.earlyDialogTable[c][1])}}return d};SIPTransactionStack.prototype.getDialogsargu1=function(f){var e=new Array();if("EARLY"==f){for(var d=0;d<this.earlyDialogTable.length;d++){var b=null;for(var a=0;a<e.legnth;a++){if(e[a]==this.earlyDialogTable[d][1]){b=d}}if(b==null){e.push(this.earlyDialogTable[d][1])}}}else{for(d=0;d<this.dialogTable.length;d++){var c=this.dialogTable[d][1];if(c.getState()!=null&&c.getState()==f){b=null;for(a=0;a<e.legnth;a++){if(e[a]==c){b=d}}if(b==null){e.push(c)}}}}return e};SIPTransactionStack.prototype.setTimer=function(a){this.timer=a};SIPTransactionStack.prototype.setDeliverDialogTerminatedEventForNullDialog=function(){this.isDialogTerminatedEventDeliveredForNullDialog=true};SIPTransactionStack.prototype.getAddressResolver=function(){return this.addressResolver};function SIPTransactionErrorEvent(b,a){this.classname="SIPTransactionErrorEvent";this.serialVersionUID="-2713188471978065031L";this.source=b;this.errorID=a}SIPTransactionErrorEvent.prototype.TIMEOUT_ERROR=1;SIPTransactionErrorEvent.prototype.TRANSPORT_ERROR=64;SIPTransactionErrorEvent.prototype.TIMEOUT_RETRANSMIT=64;SIPTransactionErrorEvent.prototype.getErrorID=function(){return this.errorID};SIPTransactionErrorEvent.prototype.getSource=function(){return this.source};function DefaultRouter(){this.classname="DefaultRouter";this.sipStack=null;this.defaultRoute=null;if(arguments.length!=0){var b=arguments[0];var a=arguments[1];this.sipStack=b;if(a!=null){this.defaultRoute=this.sipStack.getAddressResolver().resolveAddress(new HopImpl(a))}}}DefaultRouter.prototype.getNextHop=function(e){var f=e;var h=f.getRequestLine();if(h==null){return this.defaultRoute}var d=h.getUri();if(d==null){console.error("DefaultRouter:getNextHop(): bad message: Null requestURI");throw"ViaParser:getNextHop():  bad message: Null requestURI"}var j=f.getRouteHeaders();if((j!=null)&&(j.getFirst()!=null)){var g=j.getFirst();var c=g.getAddress().getURI();if(c.isSipURI()){var b=c;if(!b.hasLrParam()){this.fixStrictRouting(f)}var a=this.createHop(b,e);return a}else{console.error("DefaultRouter:getNextHop(): first Route not a SIP URI");throw"DefaultRouter:getNextHop(): first Route not a SIP URI"}}else{if(d.isSipURI()&&d.getMAddrParam()!=null){a=this.createHop(d,e);return a}else{if(this.defaultRoute!=null){return this.defaultRoute}else{if(d.isSipURI()){a=this.createHop(d,e);return a}else{return null}}}}};DefaultRouter.prototype.fixStrictRouting=function(d){var a=d.getRouteHeaders();var e=a.getFirst();var c=e.getAddress().getURI();a.removeFirst();var f=new AddressImpl();f.setAddress(d.getRequestURI());var b=new Route(f);a.add(b);d.setRequestURI(c)};DefaultRouter.prototype.createHop=function(e,d){var g=e.getTransportParam();if(g==null){var b=d.getHeader("Via");g=b.getTransport()}var a=null;if(e.getPort()!=-1){a=e.getPort()}else{a=5060}var c=e.getMAddrParam()!=null?e.getMAddrParam():e.getHost();var f=this.sipStack.getAddressResolver();return f.resolveAddress(new HopImpl(c,a,g))};DefaultRouter.prototype.getOutboundProxy=function(){return this.defaultRoute};DefaultRouter.prototype.getNextHops=function(c){try{var b=new Array();b.push(this.getNextHop(c));return b()}catch(a){console.error("DefaultRouter:getNextHops(): catched exception:"+a);return null}};function WSMessageChannel(){this.classname="WSMessageChannel";this.myParser=null;this.key=null;this.isCached=null;this.isRunning=null;this.sipStack=null;this.wsurl=null;this.infoApp=null;this.messageProcessor=null;this.alive=true;this.websocket=null;this.requestsent=null;if(arguments.length!=0){var a=arguments[0];var b=arguments[1];this.sipStack=a;this.peerProtocol="WS";this.messageProcessor=b;this.myAddress=this.sipStack.getHostAddress();this.wsurl=this.messageProcessor.getURLWS();this.websocket=this.createWebSocket(this.wsurl)}}WSMessageChannel.prototype.isReliable=function(){return true};WSMessageChannel.prototype.createWebSocket=function(b){this.websocket=new WebSocket(b,"sip");var a=this;this.websocket.onclose=function(){console.warn("WSMessageChannel:createWebSocket(): the websocket is closed, reconnecting...");a.sipStack.sipListener.processDisconnected();a.websocket=null;this.alive=false};this.websocket.onopen=function(){console.info("WSMessageChannel:createWebSocket(): the websocket is opened");a.sipStack.sipListener.processConnected()};this.websocket.onerror=function(c){console.error("WSMessageChannel:createWebSocket(): websocket connection has failed:"+c);a.sipStack.sipListener.processConnectionError(c)};this.websocket.onmessage=function(c){var d=c.data;a.myParser=new WSMsgParser(a.sipStack,d);a.myParser.parsermessage(a.requestsent)};return this.websocket};WSMessageChannel.prototype.close=function(){this.alive=false;this.websocket.close();this.websocket=null};WSMessageChannel.prototype.getSIPStack=function(){return this.sipStack};WSMessageChannel.prototype.getTransport=function(){return"WS"};WSMessageChannel.prototype.getURLWS=function(){return this.wsurl};WSMessageChannel.prototype.getPeerProtocol=function(){return this.peerProtocol};WSMessageChannel.prototype.sendMessage=function(b){if(b instanceof SIPRequest){this.requestsent=b}if(typeof b!="string"){var a=b.encode();b=a}this.websocket.send(b);console.info("SIP message sent: "+b)};WSMessageChannel.prototype.getKey=function(){if(this.key!=null){return this.key}else{var a=new WSMessageChannel();this.key=a.getKey(this.wsurl,"WS");return this.key}};WSMessageChannel.prototype.getViaHost=function(){return this.myAddress};WSMessageChannel.prototype.getViaHeader=function(){var a;a=new Via();a.setTransport(this.getTransport());a.setSentBy(this.getHostPort());return a};WSMessageChannel.prototype.getViaHost=function(){return this.myAddress};WSMessageChannel.prototype.getViaHostPort=function(){var a=new HostPort();a.setHost(new Host(this.getViaHost()));return a};WSMessageChannel.prototype.getPeerAddress=function(){if(this.peerAddress!=null){return this.peerAddress}else{return getHost()}};WSMessageChannel.prototype.getHost=function(){return this.sipStack.getHostAddress()};WSMessageChannel.prototype.createBadReqRes=function(b){var d=512;d=d+"SIP/2.0 400 Bad Request";if(!this.copyViaHeaders(b,d)){return null}if(!this.copyHeader(this.CSeqHeader,b,d)){return null}if(!this.copyHeader(this.CallIdHeader,b,d)){return null}if(!this.copyHeader(this.FromHeader,b,d)){return null}if(!this.copyHeader(this.ToHeader,b,d)){return null}var e=d.indexOf(ToHeader.NAME);if(e!=-1&&d.indexOf("tag",e)==-1){d=d+";tag=badreq"}var c=new MessageFactoryImpl();var f=c.getDefaultServerHeader();if(f!=null){d=d+"\r\n"+f.toString()}var a=b.length();var g=new ContentType("message","sipfrag");d=d+"\r\n"+g.toString();var h=new ContentLength(a);d=d+"\r\n"+h.toString();d=d+"\r\n\r\n"+b;return d.toString()};WSMessageChannel.prototype.copyHeader=function(d,a,c){var e=a.indexOf(d);if(e!=-1){var b=a.indexOf("\r\n",e);if(b!=-1){c=c+a.substring(e-2,b);return true}}return false};WSMessageChannel.prototype.copyViaHeaders=function(a,c){var e=a.indexOf(this.ViaHeader);var d=false;while(e!=-1){var b=a.indexOf("\r\n",e);if(b!=-1){c=c+a.substring(e-2,b);d=true;e=a.indexOf(this.ViaHeader,b)}else{return false}}return d};WSMessageChannel.prototype.getMessageProcessor=function(){return this.messageProcessor};WSMessageChannel.prototype.isSecure=function(){return false};WSMessageChannel.prototype.getWebSocket=function(){return this.websocket};function WSMessageProcessor(){this.classname="WSMessageProcessor";this.nConnections=null;this.isRunning=null;this.wsMessageChannels=new Array();this.incomingwsMessageChannels=null;this.websocket=null;this.useCount=0;if(arguments.length!=0){var a=arguments[0];this.sipStack=a;this.wsurl=this.sipStack.getUrlWs()}this.sentByHostPort=new HostPort();this.sentByHostPort.setHost(new Host(this.sipStack.getHostAddress()));this.transport="WS";this.sentBy=null;this.sentBySet=null}WSMessageProcessor.prototype.start=function(){return this.run()};WSMessageProcessor.prototype.run=function(){this.incomingwsMessageChannels=new WSMessageChannel(this);return this.incomingwsMessageChannels};WSMessageProcessor.prototype.getTransport=function(){return"WS"};WSMessageProcessor.prototype.getIncomingwsMessageChannels=function(){return this.incomingwsMessageChannels};WSMessageProcessor.prototype.getSIPStack=function(){return this.sipStack};WSMessageProcessor.prototype.getURLWS=function(){return this.wsurl};WSMessageProcessor.prototype.getInfoApp=function(){return this.infoApp};WSMessageProcessor.prototype.stop=function(){this.isRunning=false;this.incomingwsMessageChannels.close()};WSMessageProcessor.prototype.createMessageChannel=function(){this.incomingwsMessageChannels=new WSMessageChannel(this.sipStack,this);return this.incomingwsMessageChannels};WSMessageProcessor.prototype.getMaximumMessageSize=function(){return 2147483647};WSMessageProcessor.prototype.getViaHeader=function(){var a=new Via();if(this.sentByHostPort!=null){a.setSentBy(this.sentByHostPort);a.setTransport(this.getTransport())}else{var d=new Host();d.setHostname(this.sipStack.getHostAddress());a.setHost(d);a.setTransport(this.getTransport())}var c=new Date();var b="z9hG4bK"+new String(c.getTime());a.setBranch(b);return a};WSMessageProcessor.prototype.inUse=function(){if(this.useCount!=0){return true}else{return false}};WSMessageProcessor.prototype.getDefaultTargetPort=function(){return 5060};WSMessageProcessor.prototype.isSecure=function(){return false};WSMessageProcessor.prototype.getListeningPoint=function(){return this.listeningPoint};WSMessageProcessor.prototype.setListeningPoint=function(a){this.listeningPoint=a};WSMessageProcessor.prototype.initialize=function(b,a){this.sipStack=a;this.infoApp=b};WSMessageProcessor.prototype.setSentBy=function(c){var d=c.indexOf(":");if(d==-1){this.sentByHostPort=new HostPort();this.sentByHostPort.setHost(new Host(c))}else{this.sentByHostPort=new HostPort();this.sentByHostPort.setHost(new Host(c.substring(0,d)));var e=c.substring(d+1);try{var a=e;this.sentByHostPort.setPort(a)}catch(b){console.error("WSMessageProcessor:setSentBy(): bad format encountered at ",d);throw"WSMessageProcessor:setSentBy(): bad format encountered at "+d}}this.sentBySet=true;this.sentBy=c};WSMessageProcessor.prototype.getSentBy=function(){if(this.sentBy==null&&this.sentByHostPort!=null){this.sentBy=this.sentByHostPort.toString()}return this.sentBy};WSMessageProcessor.prototype.getPort=function(){return this.port};WSMessageProcessor.prototype.getDefaultPort=function(){var a=5060;return a};function SIPDialog(){this.classname="SIPDialog";this.serialVersionUID="-1429794423085204069L";this.dialogTerminatedEventDelivered=null;this.stackTrace=null;this.method=null;this.isAssigned=null;this.reInviteFlag=null;this.applicationData=null;this.originalRequest=null;this.lastResponse=null;this.firstTransaction=null;this.lastTransaction=null;this.dialogId=null;this.earlyDialogId=null;this.localSequenceNumber=0;this.remoteSequenceNumber=-1;this.myTag=null;this.hisTag=null;this.routeList=new RouteList();this.sipStack=null;this.dialogState=this.NULL_STATE;this.ackSeen=false;this.lastAckSent=null;this.lastAckReceived=null;this.ackProcessed=false;this.timerTask=null;this.nextSeqno=null;this.retransmissionTicksLeft=null;this.prevRetransmissionTicks=null;this.originalLocalSequenceNumber=null;this.ackLine=null;this.auditTag=0;this.localParty=null;this.remoteParty=null;this.callIdHeader=null;this.serverTransactionFlag=null;this.sipProvider=null;this.terminateOnBye=true;this.byeSent=null;this.remoteTarget=null;this.eventHeader=null;this.lastInviteOkReceived=null;this.reInviteWaitTime=100;this.dialogDeleteTask=null;this.timerdelete=null;this.dialogDeleteIfNoAckSentTask=null;this.isAcknowledged=null;this.highestSequenceNumberAcknowledged=-1;this.isBackToBackUserAgent=null;this.sequenceNumberValidation=true;this.eventListeners=new Array();this.firstTransactionSecure=null;this.firstTransactionSeen=null;this.firstTransactionMethod=null;this.firstTransactionId=null;this.firstTransactionIsServerTransaction=null;this.firstTransactionPort=5060;this.contactHeader=null;this.timer=null;this.inviteTransaction=null;if(arguments[0].classname=="SipProviderImpl"){this.terminateOnBye=true;this.routeList=new RouteList();this.dialogState=this.NULL_STATE;this.localSequenceNumber=0;this.remoteSequenceNumber=-1;this.sipProvider=arguments[0];if(arguments.length==2){c=arguments[1];this.sipStack=this.sipProvider.getSipStack();this.setLastResponse(null,c);this.localSequenceNumber=c.getCSeq().getSeqNumber();this.originalLocalSequenceNumber=this.localSequenceNumber;this.myTag=c.getFrom().getTag();this.hisTag=c.getTo().getTag();this.localParty=c.getFrom().getAddress();this.remoteParty=c.getTo().getAddress();this.method=c.getCSeq().getMethod();this.callIdHeader=c.getCallId();this.serverTransactionFlag=false;this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent;this.addEventListener(this.sipStack)}}else{if(arguments[0].classname!="SipProviderImpl"){var b=arguments[0];this.sipProvider=b.getSipProvider();this.firstTransactionSeen=false;this.terminateOnBye=true;this.routeList=new RouteList();this.dialogState=this.NULL_STATE;this.localSequenceNumber=0;this.remoteSequenceNumber=-1;var a=b.getRequest();this.callIdHeader=a.getCallId();this.earlyDialogId=a.getDialogId(false);if(b==null){console.error("SIPDialog:SIPDialog(): null transcation argument");throw"SIPDialog:SIPDialog(): null transcation argument"}this.sipStack=b.sipStack;if(this.sipProvider==null){console.error("SIPDialog:SIPDialog(): null sip provider argument");throw"SIPDialog:SIPDialog(): null sip provider argument"}this.addTransaction(b);if(arguments.length==2){var c=arguments[1];if(c==null){console.error("SIPDialog:SIPDialog(): null sip response argument");throw"SIPDialog:SIPDialog(): null sip response argument"}this.setLastResponse(b,c);this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent}this.isBackToBackUserAgent=this.sipStack.isBackToBackUserAgent;this.addEventListener(this.sipStack)}}}SIPDialog.prototype.NULL_STATE=-1;SIPDialog.prototype.EARLY_STATE=0;SIPDialog.prototype.CONFIRMED_STATE=1;SIPDialog.prototype.TERMINATED_STATE=2;SIPDialog.prototype.DIALOG_LINGER_TIME=8;SIPDialog.prototype.TimeStampHeader="Timestamp";SIPDialog.prototype.TIMER_H=64;SIPDialog.prototype.TIMER_J=64;SIPDialog.prototype.BASE_TIMER_INTERVAL=500;var timer=this.timer;var sipdialog=null;var variabletransaction=null;var variabledialog=null;var variablereinvite=null;function lingerTimerDialog(){var a=sipdialog;if(this.eventListeners!=null){this.eventListeners.clear()}this.timerTaskLock=null;a.sipStack.removeDialog(a)}function DialogDeleteTask(){sipdialog.dialogDeleteTask=null}function DialogTimerTask(){this.transaction=null;if(variabletransaction!=null){this.transaction=variabletransaction}var b=sipdialog;var c=sipdialog.transaction;if((!b.ackSeen)&&(c!=null)){var a=c.getLastResponse();if(a.getStatusCode()==200){c.fireTimer()}}if(b.isAckSeen()||b.dialogState==2){sipdialog.transaction=null;clearTimeout(sipdialog.timer)}}function DialogDeleteIfNoAckSentTask(g){this.seqno=g;var c=sipdialog;if(c.highestSequenceNumberAcknowledged<g){c.dialogDeleteIfNoAckSentTask=null;if(!c.isBackToBackUserAgent){if(c.sipProvider.getSipListener() instanceof SipListener){this.raiseErrorEvent(SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT)}else{this.delet()}}else{if(c.sipProvider.getSipListener() instanceof SipListener){this.raiseErrorEvent(SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT)}else{try{var f=c.createRequest("BYE");var a=new MessageFactoryImpl();if(a.getDefaultUserAgentHeader()!=null){f.addHeader(a.getDefaultUserAgentHeader())}var e=new Reason();e.setProtocol("SIP");e.setCause(1025);e.setText("Timed out waiting to send ACK");f.addHeader(e);var d=c.getSipProvider().getNewClientTransaction(f);c.sendRequest(d);return}catch(b){console.error("SIPDialog:DialogDeleteIfNoAckSentTask(): catched exception:"+b);c.delet()}}}}}SIPDialog.prototype.ackReceived=function(a){if(this.ackSeen){return}var b=this.getInviteTransaction();if(b!=null){if(b.getCSeq()==a.getCSeq().getSeqNumber()){this.ackSeen=true;this.setLastAckReceived(a);this.setRemoteTag(a.getFromTag());this.setLocalTag(a.getToTag());this.setDialogId(a.getDialogId(true));this.addRoute(a);this.setState(this.CONFIRMED_STATE);this.sipStack.putDialog(this)}}};SIPDialog.prototype.isTerminatedOnBye=function(){if(this.terminateOnBye){return true}else{return false}};SIPDialog.prototype.setState=function(a){this.dialogState=a;if(a==this.TERMINATED_STATE){if(this.sipStack.getTimer()!=null){this.timer=this.sipStack.getTimer();sipdialog=this;this.timer=setTimeout("lingerTimerDialog()",this.DIALOG_LINGER_TIME*1000)}}};SIPDialog.prototype.getLocalTag=function(){return this.myTag};SIPDialog.prototype.isAckSeen=function(){return this.ackSeen};SIPDialog.prototype.getLastAckSent=function(){return this.lastAckSent};SIPDialog.prototype.resendAck=function(){if(this.getLastAckSent()!=null){if(this.getLastAckSent().getHeader(this.TimeStampHeader)!=null&&this.sipStack.generateTimeStampHeader){var a=new TimeStamp();var b=new Date();a.setTimeStamp(b.getTime());this.getLastAckSent().setHeader(a)}this.sendAck(this.getLastAckSent(),false)}};SIPDialog.prototype.getMethod=function(){return this.method};SIPDialog.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};SIPDialog.prototype.getState=function(){var a=null;if(this.dialogState==this.NULL_STATE){a=null}if(this.dialogState==0){a="EARLY"}else{if(this.dialogState==1){a="CONFIRMED"}else{if(this.dialogState==2){a="TERMINATED"}}}return a};SIPDialog.prototype.delet=function(){this.setState(this.TERMINATED_STATE)};SIPDialog.prototype.isTerminatedOnBye=function(){return this.terminateOnBye};SIPDialog.prototype.getLastResponse=function(){return this.lastResponse};SIPDialog.prototype.setLastResponse=function(a,e){this.callIdHeader=e.getCallId();var c=e.getStatusCode();if(c==100){return}this.lastResponse=e;this.setAssigned();if(this.getState()=="TERMINATED"){if(e.getCSeq().getMethod()=="INVITE"&&c==200){this.lastInviteOkReceived=Math.max(e.getCSeq().getSeqNumber(),this.lastInviteOkReceived)}return}var g=e.getCSeq().getMethod();if(a==null||a instanceof SIPClientTransaction){if(this.sipStack.isDialogCreated(g)){if(this.getState()==null&&(100<=c&&c<=199)){this.setState(this.EARLY_STATE);if((e.getToTag()!=null||this.sipStack.rfc2543Supported)&&this.getRemoteTag()==null){this.setRemoteTag(e.getToTag());this.setDialogId(e.getDialogId(false));this.sipStack.putDialog(this);this.addRoute(e)}}else{if(this.getState()!=null&&this.getState()=="EARLY"&&100<=c&&c<=199){if(g==this.getMethod()&&a!=null&&(e.getToTag()!=null||this.sipStack.rfc2543Supported)){this.setRemoteTag(e.getToTag());this.setDialogId(e.getDialogId(false));this.sipStack.putDialog(this);this.addRoute(e)}}else{if(200<=c&&c<=299){if(g==this.getMethod()&&(e.getToTag()!=null||this.sipStack.rfc2543Supported)&&this.getState()!="CONFIRMED"){this.setRemoteTag(e.getToTag());this.setDialogId(e.getDialogId(false));this.sipStack.putDialog(this);this.addRoute(e);this.setState(this.CONFIRMED_STATE)}if(g=="INVITE"){this.lastInviteOkReceived=Math.max(e.getCSeq().getSeqNumber(),this.lastInviteOkReceived)}}else{if(c>=300&&c<=699&&(this.getState()==null||(g==this.getMethod()&&this.getState()=="EARLY"))){this.setState(this.TERMINATED_STATE)}}}}if(this.getState()!="CONFIRMED"&&this.getState()!="TERMINATED"){if(this.originalRequest!=null){var j=this.originalRequest.getRecordRouteHeaders();if(j!=null){for(var d=j.length;d>=0;d--){var b=j[d];var h=this.routeList.getFirst();if(h!=null&&b.getAddress()==h.getAddress()){this.routeList.removeFirst()}else{break}}}}}}else{if(g=="NOTIFY"&&(this.getMethod()=="SUBSCRIBE"||this.getMethod()=="REFER")&&e.getStatusCode()/100==2&&this.getState()==null){this.setDialogId(e.getDialogId(true));this.sipStack.putDialog(this);this.setState(this.CONFIRMED_STATE)}else{if(g=="BYE"&&c/100==2&&this.isTerminatedOnBye()){this.setState(this.TERMINATED_STATE)}}}}else{if(g=="BYE"&&c/100==2&&this.isTerminatedOnBye()){this.setState(this.TERMINATED_STATE)}else{var f=false;if(this.getLocalTag()==null&&e.getTo().getTag()!=null&&this.sipStack.isDialogCreated(g)&&g==this.getMethod()){this.setLocalTag(e.getTo().getTag());f=true}if(c/100!=2){if(c/100==1){if(f){this.setState(this.EARLY_STATE);this.setDialogId(e.getDialogId(true));this.sipStack.putDialog(this)}}else{if(!this.isReInvite()&&this.getState()!=this.CONFIRMED){this.setState(SIPDialog.TERMINATED_STATE)}}}else{if(this.dialogState<=this.EARLY_STATE&&(g=="INVITE"||g=="SUBSCRIBE"||g=="REFER")){this.setState(this.CONFIRMED_STATE)}if(f){this.setDialogId(e.getDialogId(true));this.sipStack.putDialog(this)}}}}};SIPDialog.prototype.getDialogId=function(){if(this.dialogId==null&&this.lastResponse!=null){this.dialogId=this.lastResponse.getDialogId(this.isServer())}return this.dialogId};SIPDialog.prototype.isAssignedFunction=function(){return this.isAssigned};SIPDialog.prototype.setResponseTags=function(b){if(this.getLocalTag()!=null||this.getRemoteTag()!=null){return}var a=b.getFromTag();if(a!=null){if(a==this.getLocalTag()){b.setToTag(this.getRemoteTag())}else{if(a==this.getRemoteTag()){b.setToTag(this.getLocalTag())}}}};SIPDialog.prototype.getSipProvider=function(){return this.sipProvider};SIPDialog.prototype.sendAck=function(f){var g=f;if(!g.getMethod()=="ACK"){console.error("SIPDialog:sendAck(): bad request method -- should be ACK");throw"SIPDialog:sendAck(): bad request method -- should be ACK"}if(this.getState()==null||this.getState()=="EARLY"){console.error("SIPDialog:sendAck(): bad dialog state "+this.getState());throw"SIPDialog:sendAck(): bad dialog state "+this.getState()}if(this.getCallId().getCallId()!=f.getCallId().getCallId()){console.error("SIPDialog:sendAck(): bad call ID in request");throw"SIPDialog:sendAck(): bad call ID in request"}try{if(this.getLocalTag()!=null){g.getFrom().setTag(this.getLocalTag())}if(this.getRemoteTag()!=null){g.getTo().setTag(this.getRemoteTag())}}catch(c){console.error("SIPDialog:sendAck(): catched exception:"+c);throw"SIPDialog:sendAck(): catched exception:"+c}var a=this.sipStack.getNextHop(g);if(a==null){console.error("SIPDialog:sendAck(): no route!");throw"SIPDialog:sendAck(): no route!"}var b=this.sipProvider.getListeningPoint();if(b==null){console.error("SIPDialog:sendAck(): no listening point for this provider registered at "+a);throw"SIPDialog:sendAck(): no listening point for this provider registered at "+a}var e=b.getMessageProcessor().getIncomingwsMessageChannels();this.setLastAckSent(g);e.sendMessage(g);this.isAcknowledged=true;this.highestSequenceNumberAcknowledged=Math.max(this.highestSequenceNumberAcknowledged,g.getCSeq().getSeqNumber());if(this.dialogDeleteTask!=null){}this.ackSeen=true;var d=f.encode();console.info("SIP message sent: "+d)};SIPDialog.prototype.getRemoteTag=function(){return this.hisTag};SIPDialog.prototype.isServer=function(){if(this.firstTransactionSeen==false){return this.serverTransactionFlag}else{return this.firstTransactionIsServerTransaction}};SIPDialog.prototype.addTransaction=function(b){var a=b.getOriginalRequest();if(this.firstTransactionSeen&&this.firstTransactionId!=(b.getBranchId())&&b.getMethod()==this.firstTransactionMethod){this.reInviteFlag=true}if(this.firstTransactionSeen==false){this.storeFirstTransactionInfo(this,b);if(a.getMethod()=="SUBSCRIBE"){this.eventHeader=a.getHeader("Event")}this.setLocalParty(a);this.setRemoteParty(a);this.setCallId(a);if(this.originalRequest==null){this.originalRequest=a}if(this.method==null){this.method=a.getMethod()}if(b instanceof SIPServerTransaction){this.hisTag=a.getFrom().getTag()}else{this.setLocalSequenceNumber(a.getCSeq().getSeqNumber());this.originalLocalSequenceNumber=this.localSequenceNumber;this.myTag=a.getFrom().getTag()}}else{if(b.getMethod()==this.firstTransactionMethod&&this.firstTransactionIsServerTransaction!=b.isServerTransaction()){this.storeFirstTransactionInfo(this,b);this.setLocalParty(a);this.setRemoteParty(a);this.setCallId(a);this.originalRequest=a;this.method=a.getMethod()}}if(b instanceof SIPServerTransaction){this.setRemoteSequenceNumber(a.getCSeq().getSeqNumber())}this.lastTransaction=b};SIPDialog.prototype.storeFirstTransactionInfo=function(d,f){d.firstTransaction=f;d.firstTransactionSeen=true;d.firstTransactionIsServerTransaction=f.isServerTransaction();d.firstTransactionSecure=true;d.firstTransactionId=f.getBranchId();d.firstTransactionMethod=f.getMethod();if(d.isServer()){var b=f;var a=b.getLastResponse();d.contactHeader=a!=null?a.getContactHeader():null}else{var c=f;if(c!=null){var e=c.getOriginalRequest();d.contactHeader=e.getContactHeader()}}};SIPDialog.prototype.setLocalParty=function(a){if(!this.isServer()){this.localParty=a.getFrom().getAddress()}else{this.localParty=a.getTo().getAddress()}};SIPDialog.prototype.setRemoteParty=function(a){if(!this.isServer()){this.remoteParty=a.getTo().getAddress()}else{this.remoteParty=a.getFrom().getAddress()}};SIPDialog.prototype.setCallId=function(a){this.callIdHeader=a.getCallId()};SIPDialog.prototype.setLocalSequenceNumber=function(a){this.localSequenceNumber=a};SIPDialog.prototype.getLocalParty=function(){return this.localParty};SIPDialog.prototype.getRemoteParty=function(){return this.remoteParty};SIPDialog.prototype.addEventListener=function(b){var a=null;for(var c=0;c<this.eventListeners;c++){if(this.eventListeners[c]==b){a=c}}if(a==null){this.eventListeners.push(b)}};SIPDialog.prototype.setAssigned=function(){this.isAssigned=true};SIPDialog.prototype.testAndSetIsDialogTerminatedEventDelivered=function(){var a=this.dialogTerminatedEventDelivered;this.dialogTerminatedEventDelivered=true;return a};SIPDialog.prototype.getFirstTransaction=function(){return this.firstTransaction};SIPDialog.prototype.isClientDialog=function(){var a=this.getFirstTransaction();if(a instanceof SIPClientTransaction){return true}else{return false}};SIPDialog.prototype.addRoute=function(){if(arguments[0] instanceof SIPResponse){var c=arguments[0];this.addRouteResponse(c)}else{if(arguments[0] instanceof SIPRequest){var a=arguments[0];this.addRouteRequest(a)}else{var b=arguments[0];this.addRouteList(b)}}};SIPDialog.prototype.addRouteResponse=function(d){if(d.getStatusCode()==100){return}else{if(this.dialogState==2){return}else{if(this.dialogState==1){if(200<=d.getStatusCode()&&d.getStatusCode()<=299&&!this.isServer()){var a=d.getContactHeaders();var b=new SIPRequest();if(a!=null&&b.isTargetRefresh(d.getCSeq().getMethod())){this.setRemoteTarget(a.getFirst())}}return}}}if(!this.isServer()){if(this.getState()!="CONFIRMED"&&this.getState()!="TERMINATED"){var c=d.getRecordRouteHeaders();if(c!=null){this.addRoute(c)}else{this.routeList=new RouteList()}}if(a!=null){this.setRemoteTarget(a.getFirst())}}};SIPDialog.prototype.addRouteRequest=function(b){var d=new SIPRequest();if(this.dialogState=="CONFIRMED"&&d.isTargetRefresh(b.getMethod())){this.doTargetRefresh(b)}if(this.dialogState=="CONFIRMED"||this.dialogState=="TERMINATED"){return}if(b.getToTag()!=null){return}var c=b.getRecordRouteHeaders();if(c!=null){this.addRoute(c)}else{this.routeList=new RouteList()}var a=b.getContactHeaders();if(a!=null){this.setRemoteTarget(a.getFirst())}};SIPDialog.prototype.addRouteList=function(e){if(this.isClientDialog()){this.routeList=new RouteList();for(var d=e.getHeaderList().length-1;d>=0;d--){var c=e.getHeaderList()[d];var b=new Route();var a=c.getAddress();b.setAddress(a);b.setParameters(c.getParameters());this.routeList.add(b)}}else{this.routeList=new RouteList();for(d=0;d<e.length;d--){c=e[d];b=new Route();a=c.getAddress();b.setAddress(a);b.setParameters(c.getParameters());this.routeList.add(b)}}};SIPDialog.prototype.setRemoteTarget=function(a){this.remoteTarget=a.getAddress()};SIPDialog.prototype.getRouteList=function(){return this.routeList};SIPDialog.prototype.setRouteList=function(a){this.routeList=a};SIPDialog.prototype.setStack=function(a){this.sipStack=a};SIPDialog.prototype.getStack=function(){return this.sipStack};SIPDialog.prototype.removeEventListener=function(b){var a=null;for(var c=0;c<this.eventListeners.length;c++){if(this.eventListeners[c]==b){a=c}}this.eventListeners.splice(a,1)};SIPDialog.prototype.setApplicationData=function(a){this.applicationData=a};SIPDialog.prototype.getApplicationData=function(){return this.applicationData};SIPDialog.prototype.requestConsumed=function(){this.nextSeqno=this.getRemoteSeqNumber()+1};SIPDialog.prototype.isRequestConsumable=function(a){if(a.getMethod()=="ACK"){console.error("SIPDialog:isRequestConsumable(): Illegal method");throw"SIPDialog:isRequestConsumable(): Illegal method"}if(!this.isSequnceNumberValidation()){return true}if(this.remoteSequenceNumber<=a.getCSeq().getSeqNumber()){return true}else{return false}};SIPDialog.prototype.doDeferredDelete=function(){if(this.sipStack.getTimer()==null){this.setState(this.TERMINATED_STATE)}else{this.timerdelete=this.sipStack.getTimer();sipdialog=this;this.timerdelete=setTimeout(function(){sipdialog.dialogDeleteTask=new DialogDeleteTask()},this.TIMER_H*this.BASE_TIMER_INTERVAL)}};SIPDialog.prototype.isAckSent=function(a){if(this.getLastTransaction()==null){return true}if(this.getLastTransaction() instanceof SIPClientTransaction){if(this.getLastAckSent()==null){return false}else{return a<=this.getLastAckSent().getCSeq().getSeqNumber()}}else{return true}};SIPDialog.prototype.getRouteSet=function(){if(this.routeList==null){this.routeList=new Array();return this.routeList}else{return this.getRouteList()}};SIPDialog.prototype.setDialogId=function(a){this.dialogId=a};SIPDialog.prototype.createFromNOTIFY=function(e,a){var c=new SIPDialog(a);c.serverTransactionFlag=false;c.lastTransaction=e;storeFirstTransactionInfo(c,e);c.terminateOnBye=false;c.localSequenceNumber=e.getCSeq();var b=a.getRequest();c.remoteSequenceNumber=b.getCSeq().getSeqNumber();c.setDialogId(b.getDialogId(true));c.setLocalTag(b.getToTag());c.setRemoteTag(b.getFromTag());c.setLastResponse(e,e.getLastResponse());c.localParty=b.getTo().getAddress();c.remoteParty=b.getFrom().getAddress();c.addRoute(b);c.setState(this.CONFIRMED_STATE);return c};SIPDialog.prototype.isReInvite=function(){return this.reInviteFlag};SIPDialog.prototype.setRemoteTag=function(a){if(this.hisTag!=null&&a!=null&&a!=this.hisTag){if(this.getState()!="EARLY"){return}else{if(this.sipStack.isRemoteTagReassignmentAllowed()){var b=false;if(this.sipStack.getDialog(this.dialogId)==this){this.sipStack.removeDialog(this.dialogId);b=true}this.dialogId=null;this.hisTag=a;if(b){this.sipStack.putDialog(this)}}}}else{if(a!=null){this.hisTag=a}}};SIPDialog.prototype.getLastTransaction=function(){return this.lastTransaction};SIPDialog.prototype.getInviteTransaction=function(){return this.inviteTransaction};SIPDialog.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPDialog.prototype.setLocalSequenceNumber=function(a){if(a<=this.localSequenceNumber){console.error("SIPDialog:setLocalSequenceNumber(): sequence number should not decrease !");throw"SIPDialog:setLocalSequenceNumber(): sequence number should not decrease !"}this.localSequenceNumber=a};SIPDialog.prototype.setRemoteSequenceNumber=function(a){this.remoteSequenceNumber=a};SIPDialog.prototype.incrementLocalSequenceNumber=function(){++this.localSequenceNumber};SIPDialog.prototype.getOriginalLocalSequenceNumber=function(){return this.originalLocalSequenceNumber};SIPDialog.prototype.getLocalSeqNumber=function(){return this.localSequenceNumber};SIPDialog.prototype.getRemoteSeqNumber=function(){return this.remoteSequenceNumber};SIPDialog.prototype.setLocalTag=function(a){this.myTag=a};SIPDialog.prototype.getCallId=function(){return this.callIdHeader};SIPDialog.prototype.getRemoteTarget=function(){return this.remoteTarget};SIPDialog.prototype.isSecure=function(){return this.firstTransactionSecure};SIPDialog.prototype.createRequest=function(){if(arguments.length==1){var b=arguments[0];return this.createRequestargu1(b)}else{b=arguments[0];var a=arguments[1];return this.createRequestargu2(b,a)}};SIPDialog.prototype.createRequestargu1=function(a){if(a=="ACK"){console.error("SIPDialog:createRequestargu1(): invalid method specified for createRequest:"+a);throw"SIPDialog:createRequestargu1(): invalid method specified for createRequest:"+a}if(this.lastResponse!=null){return this.createRequest(a,this.lastResponse)}else{console.error("SIPDialog:createRequestargu1(): dialog not yet established -- no response!");throw"SIPDialog:createRequestargu1(): dialog not yet established -- no response!"}};SIPDialog.prototype.createRequestargu2=function(a,f){if(a==null||f==null){console.error("SIPDialog:createRequestargu2(): null argument");throw"SIPDialog:createRequestargu2(): null argument"}if(a=="CANCEL"){console.error("SIPDialog:createRequestargu2(): invalid request");throw"SIPDialog:createRequestargu2(): invalid request"}if(this.getState()==null||(this.getState()=="TERMINATED"&&a.toUpperCase()!="BYE")||(this.isServer()&&this.getState()=="EARLY"&&a.toUpperCase()=="BYE")){console.error("SIPDialog:createRequestargu2(): dialog  "+this.getDialogId()+" not yet established or terminated "+this.getState());throw"SIPDialog:createRequestargu2(): dialog  "+this.getDialogId()+" not yet established or terminated "+this.getState()}var c=null;if(this.isServer()){var h=this.getInviteTransaction().getOriginalRequest().getContactHeader();c=h.getAddress().getURI()}else{c=f.getContactHeader().getAddress().getURI()}var b=new CSeq();b.setMethod(a);b.setSeqNumber(this.getLocalSeqNumber()+1);if(a=="SUBSCRIBE"){if(this.eventHeader!=null){g.addHeader(this.eventHeader)}}var e=this.sipProvider.getListeningPoint();if(e==null){console.error("SIPDialog:createRequestargu2(): cannot find listening point for transport "+f.getTopmostVia().getTransport());throw"SIPDialog:createRequestargu2(): cannot find listening point for transport "+f.getTopmostVia().getTransport()}var m=e.getViaHeader();var l=new From();l.setAddress(this.localParty);var j=new To();j.setAddress(this.remoteParty);if(this.getLocalTag()!=null){l.setTag(this.getLocalTag())}else{l.removeTag()}if(this.getRemoteTag()!=null){j.setTag(this.getRemoteTag())}else{j.removeTag()}var g=f.createRequest(c,m,b,l,j);var d=new SIPRequest();if(d.isTargetRefresh(a)){var h=this.sipProvider.getListeningPoint().createContactHeader();h.getAddress().getURI().setSecure(this.isSecure());g.setHeader(h)}this.updateRequest(g);return g};SIPDialog.prototype.sendRequest=function(e){var f=e.getOriginalRequest();if(e==null){console.error("SIPDialog:sendRequest(): null parameter");throw"SIPDialog:sendRequest(): null parameter"}if(f.getMethod()=="ACK"||f.getMethod()=="CANCEL"){console.error("SIPDialog:sendRequest(): bad request method. "+f.getMethod());throw"SIPDialog:sendRequest(): bad request method. "+f.getMethod()}if(this.byeSent&&this.isTerminatedOnBye()&&f.getMethod()!="BYE"){console.error("SIPDialog:sendRequest(): cannot send request; BYE already sent");throw"SIPDialog:sendRequest(): cannot send request; BYE already sent"}if(f.getTopmostVia()==null){var a=e.getOutgoingViaHeader();f.addHeader(a)}if(this.getCallId().getCallId().toLowerCase()!=f.getCallId().getCallId().toLowerCase()){console.error("SIPDialog:sendRequest(): bad call ID in request");throw"SIPDialog:sendRequest(): bad call ID in request"}e.setDialog(this,this.dialogId);this.addTransaction(e);e.isMapped=true;var h=f.getFrom();var g=f.getTo();if(this.getLocalTag()!=null&&h.getTag()!=null&&h.getTag()!=this.getLocalTag()){console.error("SIPDialog:sendRequest(): from tag mismatch expecting  "+this.getLocalTag());throw"SIPDialog:sendRequest(): from tag mismatch expecting  "+this.getLocalTag()}if(this.getLocalTag()==null&&f.getMethod()=="NOTIFY"){if(this.getMethod()!="SUBSCRIBE"){console.error("SIPDialog:sendRequest(): trying to send NOTIFY without SUBSCRIBE Dialog!");throw"SIPDialog:sendRequest(): trying to send NOTIFY without SUBSCRIBE Dialog!"}this.setLocalTag(h.getTag())}if(this.getLocalTag()!=null){h.setTag(this.getLocalTag())}if(this.getRemoteTag()!=null){g.setTag(this.getRemoteTag())}var d=this.sipStack.getChannel();if(d==null){var c=this.sipStack.getRouter(f).getOutboundProxy();if(c==null){console.error("SIPDialog:sendRequest(): no route found!");throw"SIPDialog:sendRequest(): no route found!"}d=this.sipStack.createRawMessageChannel(this.getSipProvider().getListeningPoint(c.getTransport()).getHostAddress(),this.firstTransactionPort,c);if(d!=null){e.setEncapsulatedChannel(d)}}else{e.setEncapsulatedChannel(d)}if(d!=null){d.useCount++}this.localSequenceNumber++;f.getCSeq().setSeqNumber(this.getLocalSeqNumber());try{e.sendMessage(f);if(f.getMethod()=="BYE"){this.byeSent=true;if(this.isTerminatedOnBye()){this.setState(this.TERMINATED_STATE)}}}catch(b){console.error("SIPDialog:sendRequest():  catched execption, error sending message",b);throw"SIPDialog:sendRequest():  catched execption, error sending message"}};SIPDialog.prototype.startTimer=function(a){if(this.timerTask!=null&&this.timerTask.transaction==a){return}this.ackSeen=false;if(this.timerTask!=null){this.timerTask.transaction=a}else{variabletransaction=a;this.timer=this.sipStack.getTimer();sipdialog=this;this.timer=setTimeout(function(){sipdialog.timer=setInterval(function(){sipdialog.timerTask=new DialogTimerTask(variabletransaction)},sipdialog.BASE_TIMER_INTERVAL)},this.BASE_TIMER_INTERVAL)}};SIPDialog.prototype.stopTimer=function(){if(this.timerTask!=null){clearTimeout(this.timer);this.timerTask=null}};SIPDialog.prototype.updateRequest=function(b){var c=this.getRouteList();if(!c.isEmpty()){b.setHeader(c)}else{b.removeHeader("Route")}var a=new MessageFactoryImpl();if(a.getDefaultUserAgentHeader()!=null){b.setHeader(a.getDefaultUserAgentHeader())}};SIPDialog.prototype.createAck=function(e){if(this.method!="INVITE"){console.error("SIPDialog:createAck(): dialog was not created with an INVITE"+this.method);throw"SIPDialog:createAck(): dialog was not created with an INVITE"+this.method}if(e<=0){console.error("SIPDialog:createAck(): bad cseq <= 0");throw"SIPDialog:createAck(): bad cseq <= 0"}if(this.remoteTarget==null){console.error("SIPDialog:createAck(): cannot create ACK - no remote Target!");throw"SIPDialog:createAck(): cannot create ACK - no remote Target!"}if(this.lastInviteOkReceived<e){console.error("SIPDialog:createAck(): dialog not yet established -- no OK response!");throw"SIPDialog:createAck(): dialog not yet established -- no OK response!"}try{var p=null;if(this.routeList!=null&&!this.routeList.isEmpty()){var a=this.routeList.getFirst();p=a.getAddress().getURI()}else{p=this.remoteTarget.getURI()}var b=p.getTransportParam();if(b==null){b="WS"}var f=this.sipProvider.getListeningPoint(b);if(f==null){console.error("SIPDialog:createAck(): cannot create ACK - no ListeningPoint for transport towards next hop found:"+b);throw"SIPDialog:createAck(): cannot create ACK - no ListeningPoint for transport towards next hop found:"+b}var j=new SIPRequest();j.setMethod("ACK");j.setRequestURI(getRemoteTarget().getURI());j.setCallId(this.callIdHeader);j.setCSeq(new CSeq(e,"ACK"));var c=new Array();var q=this.lastResponse.getTopmostVia();q.removeParameters();if(this.originalRequest!=null&&this.originalRequest.getTopmostVia()!=null){var d=this.originalRequest.getTopmostVia().getParameters();if(d!=null&&d.size()>0){q.setParameters(d.clone())}}var n=new Utils();q.setBranch(n.generateBranchId());c.add(q);j.setVia(c);var m=new From();m.setAddress(this.localParty);m.setTag(this.myTag);j.setFrom(m);var l=new To();l.setAddress(this.remoteParty);if(this.hisTag!=null){l.setTag(this.hisTag)}j.setTo(l);j.setMaxForwards(new MaxForwards(70));if(this.originalRequest!=null){var g=this.originalRequest.getAuthorization();if(g!=null){j.setHeader(g)}}this.updateRequest(j);return j}catch(h){console.error("SIPDialog:createAck(): catched unexpected exception ",h);throw"SIPDialog:createAck(): catched unexpected exception"}};SIPDialog.prototype.setSipProvider=function(a){this.sipProvider=a};SIPDialog.prototype.doTargetRefresh=function(c){var b=c.getContactHeaders();if(b!=null){var a=b.getFirst();this.setRemoteTarget(a)}};SIPDialog.prototype.createReliableProvisionalResponse=function(e){if(!(this.firstTransactionIsServerTransaction)){console.error("SIPDialog:createReliableProvisionalResponse(): not a Server Dialog!");throw"SIPDialog:createReliableProvisionalResponse(): not a Server Dialog!"}if(e<=100||e>199){console.error("SIPDialog:createReliableProvisionalResponse(): bad status code ");throw"SIPDialog:createReliableProvisionalResponse(): bad status code "}var f=this.originalRequest;if(f.getMethod()!="INVITE"){console.error("SIPDialog:createReliableProvisionalResponse(): bad method");throw"SIPDialog:createReliableProvisionalResponse(): bad method"}var g=f.getHeaders("Supported");if(g==null&&!optionPresent(g,"100rel")){g=f.getHeaders("Require");if(g==null&&!optionPresent(g,"100rel")){console.error("SIPDialog:createReliableProvisionalResponse(): no Supported/Require 100rel header in the request");throw"SIPDialog:createReliableProvisionalResponse(): no Supported/Require 100rel header in the request"}}var b=f.createResponse(e);var c=new Require();c.setOptionTag("100rel");b.addHeader(c);var a=new RSeq();a.setSeqNumber("1L");var d=f.getRecordRouteHeaders();if(d!=null){var h=d;b.setHeader(h)}return b};SIPDialog.prototype.sendReliableProvisionalResponse=function(g){if(!this.isServer()){console.error("SIPDialog:sendReliableProvisionalResponse(): not a Server Dialog!");throw"SIPDialog:sendReliableProvisionalResponse(): not a Server Dialog!"}var h=g;if(g.getStatusCode()==100){console.error("SIPDialog:sendReliableProvisionalResponse(): cannot send 100 as a reliable provisional response");throw"SIPDialog:sendReliableProvisionalResponse(): cannot send 100 as a reliable provisional response"}if(g.getStatusCode()/100>2){console.error("SIPDialog:sendReliableProvisionalResponse(): response code is not a 1xx response - should be in the range 101 to 199 ");throw"SIPDialog:sendReliableProvisionalResponse(): response code is not a 1xx response - should be in the range 101 to 199 "}if(h.getToTag()==null){console.error("SIPDialog:sendReliableProvisionalResponse(): badly formatted response -- To tag mandatory for Reliable Provisional Response");throw"SIPDialog:sendReliableProvisionalResponse(): badly formatted response -- To tag mandatory for Reliable Provisional Response"}var c=g.getHeaders("Require");var f=false;if(c!=null){for(var d=0;d<c.length&&!f;d++){var a=c[d];if(a.getOptionTag().toLowerCase()=="100rel"){f=true}}}if(!f){var b=new Require("100rel");g.addHeader(b)}var e=this.getFirstTransaction();this.setLastResponse(e,h);this.setDialogId(h.getDialogId(true));e.sendReliableProvisionalResponse(g)};SIPDialog.prototype.terminateOnBye=function(a){this.terminateOnBye=a};SIPDialog.prototype.getMyContactHeader=function(){return this.contactHeader};SIPDialog.prototype.handleAck=function(){return true};SIPDialog.prototype.setEarlyDialogId=function(a){this.earlyDialogId=a};SIPDialog.prototype.getEarlyDialogId=function(){return this.earlyDialogId};SIPDialog.prototype.optionPresent=function(a,d){for(var c=0;c<a.length;c++){var b=a[c];if(b!=null&&d.toLowerCase()==b.getOptionTag().toLowerCase()){return true}}return false};SIPDialog.prototype.setLastAckReceived=function(a){this.lastAckReceived=a};SIPDialog.prototype.getLastAckReceived=function(){return this.lastAckReceived};SIPDialog.prototype.setLastAckSent=function(a){this.lastAckSent=a};SIPDialog.prototype.isAtleastOneAckSent=function(){return this.isAcknowledged};SIPDialog.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};SIPDialog.prototype.doDeferredDeleteIfNoAckSent=function(b){if(this.sipStack.getTimer()==null){this.setState(this.TERMINATED_STATE)}else{if(this.dialogDeleteIfNoAckSentTask==null){variabledialog=b;var a=this.sipStack.getTimer();sipdialog=this;a=setTimeout(function(){sipdialog.dialogDeleteIfNoAckSentTask=new DialogDeleteIfNoAckSentTask(variabledialog)},this.TIMER_J*this.BASE_TIMER_INTERVAL)}}};SIPDialog.prototype.setBackToBackUserAgent=function(){this.isBackToBackUserAgent=true};SIPDialog.prototype.getEventHeader=function(){return eventHeader};SIPDialog.prototype.setEventHeader=function(a){this.eventHeader=a};SIPDialog.prototype.setServerTransactionFlag=function(a){this.serverTransactionFlag=a};SIPDialog.prototype.setReInviteFlag=function(a){this.reInviteFlag=a};SIPDialog.prototype.isSequnceNumberValidation=function(){return this.sequenceNumberValidation};SIPDialog.prototype.disableSequenceNumberValidation=function(){this.sequenceNumberValidation=false};SIPDialog.prototype.raiseErrorEvent=function(d){var a=null;var c=new SIPDialogErrorEvent(this,d);for(var b=0;b<this.eventListeners.length;b++){a=this.eventListeners[b];a.dialogErrorEvent(c)}this.eventListeners=new Array();if(d!=SIPDialogErrorEvent.DIALOG_ACK_NOT_SENT_TIMEOUT&&d!=SIPDialogErrorEvent.DIALOG_ACK_NOT_RECEIVED_TIMEOUT&&d!=SIPDialogErrorEvent.DIALOG_REINVITE_TIMEOUT){this.delet()}this.stopTimer()};function SIPDialogErrorEvent(a,b){this.classname="SIPDialogErrorEvent";this.errorID=b;this.source=a}SIPDialogErrorEvent.prototype.DIALOG_ACK_NOT_RECEIVED_TIMEOUT=1;SIPDialogErrorEvent.prototype.DIALOG_ACK_NOT_SENT_TIMEOUT=2;SIPDialogErrorEvent.prototype.DIALOG_REINVITE_TIMEOUT=3;SIPDialogErrorEvent.prototype.getErrorID=function(){return this.errorID};SIPDialogErrorEvent.prototype.getSource=function(){return this.source};function SIPDialogEventListener(a){this.classname="SIPDialogEventListener"}SIPDialogEventListener.prototype.dialogErrorEvent=function(){};var siptransaction;function SIPTransaction(b,a){this.classname="SIPTransaction";this.toListener=null;this.applicationData=null;this.lastResponse=null;this.isMapped=null;this.transactionId=null;this.auditTag=0;this.sipStack=b;this.originalRequest=null;this.encapsulatedChannel=a;if(arguments.length==0){this.wsurl=null}else{this.wsurl=this.encapsulatedChannel.wsurl;this.disableTimeoutTimer();this.addEventListener(b)}this.eventListeners=new Array();this.transactionTimerStarted=false;this.branch=null;this.method=null;this.cSeq=null;this.currentState=null;this.timeoutTimerTicksLeft=null;this.from=null;this.to=null;this.event=null;this.callId=null;this.collectionTime=null;this.toTag=null;this.fromTag=null;this.terminatedEventDelivered=null}SIPTransaction.prototype=new WSMessageChannel();SIPTransaction.prototype.constructor=SIPTransaction;SIPTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPTransaction.prototype.T4=5000/SIPTransaction.prototype.BASE_TIMER_INTERVAL;SIPTransaction.prototype.T2=4000/SIPTransaction.prototype.BASE_TIMER_INTERVAL;SIPTransaction.prototype.TIMER_I=SIPTransaction.prototype.T4;SIPTransaction.prototype.TIMER_K=SIPTransaction.prototype.T4;SIPTransaction.prototype.TIMER_D=32000/SIPTransaction.prototype.BASE_TIMER_INTERVAL;SIPTransaction.prototype.T1=1;SIPTransaction.prototype.TIMER_A=1;SIPTransaction.prototype.TIMER_B=64;SIPTransaction.prototype.TIMER_J=64;SIPTransaction.prototype.TIMER_F=64;SIPTransaction.prototype.TIMER_H=64;SIPTransaction.prototype.INITIAL_STATE=null;SIPTransaction.prototype.TRYING_STATE="TRYING";SIPTransaction.prototype.CALLING_STATE="CALLING";SIPTransaction.prototype.PROCEEDING_STATE="PROCEEDING";SIPTransaction.prototype.COMPLETED_STATE="COMPLETED";SIPTransaction.prototype.CONFIRMED_STATE="CONFIRMED";SIPTransaction.prototype.TERMINATED_STATE="TERMINATED";SIPTransaction.prototype.MAXIMUM_RETRANSMISSION_TICK_COUNT=8;SIPTransaction.prototype.TIMEOUT_RETRANSMIT=3;SIPTransaction.prototype.CONNECTION_LINGER_TIME=8;function lingerTimer(){var b=siptransaction;var a=b.getSIPStack();if(b instanceof SIPClientTransaction){a.removeTransaction(b)}else{if(b instanceof ServerTransaction){a.removeTransaction(b)}}}SIPTransaction.prototype.getBranchId=function(){return this.branch};SIPTransaction.prototype.setOriginalRequest=function(a){var b=null;if(this.originalRequest!=null&&(this.originalRequest.getTransactionId()!=a.getTransactionId())){this.sipStack.removeTransactionHash(this)}this.originalRequest=a;this.method=a.getMethod();this.from=a.getFrom();this.to=a.getTo();this.toTag=this.to.getTag();this.fromTag=this.from.getTag();this.callId=a.getCallId();this.cSeq=a.getCSeq().getSeqNumber();this.event=a.getHeader("Event");this.transactionId=a.getTransactionId();this.originalRequest.setTransaction(this);b=a.getViaHeaders().getFirst().getBranch();if(b!=null){this.setBranch(b)}else{this.setBranch(a.getTransactionId())}};SIPTransaction.prototype.getOriginalRequest=function(){return this.originalRequest};SIPTransaction.prototype.getRequest=function(){return this.originalRequest};SIPTransaction.prototype.isInviteTransaction=function(){if(this.getMethod()=="INVITE"){return true}else{return false}};SIPTransaction.prototype.isCancelTransaction=function(){if(this.getMethod()=="CANCEL"){return true}else{return false}};SIPTransaction.prototype.isByeTransaction=function(){if(this.getMethod()=="BYE"){return true}else{return false}};SIPTransaction.prototype.getMessageChannel=function(){return this.encapsulatedChannel};SIPTransaction.prototype.setBranch=function(a){this.branch=a};SIPTransaction.prototype.getBranch=function(){if(this.branch==null){this.branch=this.getOriginalRequest().getTopmostVia().getBranch()}return this.branch};SIPTransaction.prototype.getMethod=function(){return this.method};SIPTransaction.prototype.getCSeq=function(){return this.cSeq};SIPTransaction.prototype.setState=function(a){if(this.currentState=="COMPLETED"){if(a!="TERMINATED"&&a!="CONFIRMED"){a="COMPLETED"}}if(this.currentState=="CONFIRMED"){if(a!="TERMINATED"){a="CONFIRMED"}}if(this.currentState!="TERMINATED"){this.currentState=a}else{a=this.currentState}};SIPTransaction.prototype.getState=function(){return this.currentState};SIPTransaction.prototype.enableTimeoutTimer=function(a){this.timeoutTimerTicksLeft=a};SIPTransaction.prototype.disableTimeoutTimer=function(){this.timeoutTimerTicksLeft=-1};SIPTransaction.prototype.fireTimer=function(){if(this.timeoutTimerTicksLeft!=-1){if(--this.timeoutTimerTicksLeft==0){this.fireTimeoutTimer()}}};SIPTransaction.prototype.isTerminated=function(){if(this.getState()=="TERMINATED"){return true}else{return false}};SIPTransaction.prototype.getURLWS=function(){return this.encapsulatedChannel.getURLWS()};SIPTransaction.prototype.getKey=function(){return this.encapsulatedChannel.getKey()};SIPTransaction.prototype.getSIPStack=function(){return this.sipStack};SIPTransaction.prototype.getTransport=function(){return this.encapsulatedChannel.getTransport()};SIPTransaction.prototype.isReliable=function(){return true};SIPTransaction.prototype.getViaHeader=function(){var a=WSMessageChannel.prototype.getViaHeader.call(this);a.setBranch(this.branch);return a};SIPTransaction.prototype.sendMessage=function(a){this.encapsulatedChannel.sendMessage(a)};SIPTransaction.prototype.addEventListener=function(b){var a=null;for(var c=0;c<this.eventListeners.length;c++){if(this.eventListeners[c]==b){a=c}}if(a==null){this.eventListeners.push(b)}};SIPTransaction.prototype.removeEventListener=function(b){var a=null;for(var c=0;c<this.eventListeners.length;c++){if(this.eventListeners[c]==b){a=c}}this.eventListeners.splice(a,1)};SIPTransaction.prototype.raiseErrorEvent=function(a){var b=null;var d=new SIPTransactionErrorEvent(this,a);for(var c=0;c<this.eventListeners.length;c++){b=this.eventListeners[c];b.transactionErrorEvent(d)}if(a!=this.TIMEOUT_RETRANSMIT){this.eventListeners=new Array();this.setState("TERMINATED");if(this instanceof SIPServerTransaction&&this.isByeTransaction()&&this.getDialog()!=null){this.getDialog().setState("TERMINATED")}}};SIPTransaction.prototype.isServerTransaction=function(){if(this instanceof SIPServerTransaction){return true}else{return false}};SIPTransaction.prototype.getDialog=function(){};SIPTransaction.prototype.setDialog=function(b,a){};SIPTransaction.prototype.getViaHost=function(){return this.getViaHeader().getHost()};SIPTransaction.prototype.getLastResponse=function(){return this.lastResponse};SIPTransaction.prototype.getResponse=function(){return this.lastResponse};SIPTransaction.prototype.getTransactionId=function(){return this.transactionId};SIPTransaction.prototype.hashCode=function(){if(this.transactionId==null){return -1}else{var d=0;var a=this.transactionId;if(!(a==null||a.value=="")){for(var b=0;b<a.length;b++){d=d*31+a.charCodeAt(b);var c=2147483647;var e=-2147483648;if(d>c||d<e){d&=4294967295}}}return d}};SIPTransaction.prototype.getViaPort=function(){return this.getViaHeader().getPort()};SIPTransaction.prototype.getPort=function(){return this.encapsulatedChannel.getPort()};SIPTransaction.prototype.doesCancelMatchTransaction=function(e){var c;var a;var d;var b=false;if(this.getOriginalRequest()==null||this.getOriginalRequest().getMethod()=="CANCEL"){return false}c=e.getViaHeaders();if(c!=null){a=c.getFirst();d=a.getBranch();if(d!=null){if(d.toLowerCase().substring(0,7)!="z9hg4bk"){d=null}}if(d!=null&&this.getBranch()!=null){if(this.getBranch().toLowerCase()==d.toLowerCase()&&a.getSentBy()==this.getOriginalRequest().getViaHeaders().getFirst().getSentBy()){b=true}}else{if(this.getOriginalRequest().getRequestURI()==e.getRequestURI()&&this.getOriginalRequest().getTo()==e.getTo()&&this.getOriginalRequest().getFrom()==e.getFrom()&&this.getOriginalRequest().getCallId().getCallId()==e.getCallId().getCallId()&&this.getOriginalRequest().getCSeq().getSeqNumber()==e.getCSeq().getSeqNumber()&&a==this.getOriginalRequest().getViaHeaders().getFirst()){b=true}}}if(b){this.setPassToListener()}return b};SIPTransaction.prototype.close=function(){this.encapsulatedChannel.close()};SIPTransaction.prototype.isSecure=function(){return this.encapsulatedChannel.isSecure()};SIPTransaction.prototype.getMessageProcessor=function(){return this.encapsulatedChannel.getMessageProcessor()};SIPTransaction.prototype.setApplicationData=function(a){this.applicationData=a};SIPTransaction.prototype.getURLWS=function(){return this.wsurl};SIPTransaction.prototype.getApplicationData=function(){return this.applicationData};SIPTransaction.prototype.setEncapsulatedChannel=function(a){this.encapsulatedChannel=a};SIPTransaction.prototype.getSipProvider=function(){return this.getMessageProcessor().getListeningPoint().getProvider()};SIPTransaction.prototype.raiseIOExceptionEvent=function(){this.setState("TERMINATED")};SIPTransaction.prototype.passToListener=function(){return this.toListener};SIPTransaction.prototype.setPassToListener=function(){this.toListener=true};SIPTransaction.prototype.testAndSetTransactionTerminatedEvent=function(){var a=!this.terminatedEventDelivered;this.terminatedEventDelivered=true;return a};SIPTransaction.prototype.startTransactionTimer=function(){};SIPTransaction.prototype.isMessagePartOfTransaction=function(){};SIPTransaction.prototype.fireTimeoutTimer=function(){};function SIPClientTransaction(c,b){this.classname="SIPClientTransaction";this.encapsulatedChannel=b;this.wsurl=this.encapsulatedChannel.wsurl;this.disableTimeoutTimer();this.sipStack=c;this.infoApp=c.infoApp;this.addEventListener(c);this.originalRequest=null;this.eventListeners=new Array();var a=new Utils();this.setBranch(a.generateBranchId());this.notifyOnRetransmit=false;this.timeoutIfStillInCallingState=false;this.setEncapsulatedChannel(b);this.messageProcessor=b.messageProcessor;this.sipDialogs=new Array();this.lastRequest=null;this.viaPort=null;this.viaHost=null;this.respondTo=null;this.defaultDialog=null;this.nextHop=null;this.callingStateTimeoutCount=null;this.timer=null;this.oldmessage=null}SIPClientTransaction.prototype=new SIPTransaction();SIPClientTransaction.prototype.constructor=SIPClientTransaction;SIPClientTransaction.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";SIPClientTransaction.prototype.MAXIMUM_RETRANSMISSION_TICK_COUNT=8;SIPClientTransaction.prototype.COMPLETED="COMPLETED";SIPClientTransaction.prototype.PROCEEDING="PROCEEDING";SIPClientTransaction.prototype.CALLING="CALLING";SIPClientTransaction.prototype.TERMINATED="TERMINATED";SIPClientTransaction.prototype.ACK="ACK";SIPClientTransaction.prototype.INVITE="INVITE";SIPClientTransaction.prototype.TRYING="TRYING";SIPClientTransaction.prototype.CANCEL="CANCEL";SIPClientTransaction.prototype.BYE="BYE";SIPClientTransaction.prototype.SUBSCRIBE="SUBSCRIBE";SIPClientTransaction.prototype.NOTIFY="NOTIFY";SIPClientTransaction.prototype.TIMER_B=64;SIPClientTransaction.prototype.TIMER_D=SIPTransaction.prototype.TIMER_D;SIPClientTransaction.prototype.TIMER_F=64;SIPClientTransaction.prototype.TIMER_K=SIPTransaction.prototype.T4;SIPClientTransaction.prototype.TIMER_J=64;SIPClientTransaction.prototype.TimeStampHeader="Timestamp";SIPClientTransaction.prototype.RouteHeader="Route";SIPClientTransaction.prototype.RETRANSMIT="RETRANSMIT";SIPClientTransaction.prototype.TRANSPORT_ERROR=2;SIPClientTransaction.prototype.TIMEOUT_ERROR=1;SIPClientTransaction.prototype.EARLY="EARLY";SIPClientTransaction.prototype.CONNECTION_LINGER_TIME=8;SIPClientTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPClientTransaction.prototype.setResponseInterface=function(a){this.respondTo=a};SIPClientTransaction.prototype.getRequestChannel=function(){return this};SIPClientTransaction.prototype.isMessagePartOfTransaction=function(e){var c=e.getViaHeaders();var b=false;var d=c.getFirst().getBranch();if(this.getBranch()!=null&&d!=null&&this.getBranch().toLowerCase().substring(0,7)==(this.BRANCH_MAGIC_COOKIE_LOWER_CASE)&&d.toLowerCase().substring(0,7)==(this.BRANCH_MAGIC_COOKIE_LOWER_CASE)){var a=true}else{a=false}if(this.COMPLETED==this.getState()){if(a){if(this.getBranch()().toLowerCase()==c.getFirst().getBranch().toLowerCase()&&this.getMethod()==e.getCSeq().getMethod()){b=true}else{b=false}}else{if(this.getBranch()==e.getTransactionId()){b=true}else{b=false}}}else{if(!this.isTerminated()){if(a){if(c!=null){if(this.getBranch().toLowerCase()==c.getFirst().getBranch().toLowerCase()){if(this.getOriginalRequest().getCSeq().getMethod()==e.getCSeq().getMethod()){b=true}else{b=false}}}}else{if(this.getBranch()!=null){if(this.getBranch().toLowerCase()==e.getTransactionId().toLowerCase()){b=true}else{b=false}}else{if(this.getOriginalRequest().getTransactionId().toLowerCase()==e.getTransactionId().toLowerCase()){b=true}else{b=false}}}}}return b};SIPClientTransaction.prototype.sendMessage=function(d){var b=d;var c=b.getViaHeaders().getFirst();c.setBranch(this.getBranch());if(this.PROCEEDING==this.getState()||this.CALLING==this.getState()){if(b.getMethod()==this.ACK){if(this.isReliable()){this.setState(this.TERMINATED)}else{this.setState(this.COMPLETED)}SIPTransaction.prototype.sendMessage.call(this,b);return}}try{this.lastRequest=b;if(this.getState()==null){this.setOriginalRequest(b);if(b.getMethod()==this.INVITE){this.setState(this.CALLING)}else{if(b.getMethod()==this.ACK){this.setState(this.TERMINATED)}else{this.setState(this.TRYING)}}if(this.isInviteTransaction()){this.enableTimeoutTimer(this.TIMER_B)}else{this.enableTimeoutTimer(this.TIMER_F)}}SIPTransaction.prototype.sendMessage.call(this,b)}catch(a){console.error("SIPClientTransaction:sendMessage(): catched exception:"+a);this.setState(this.TERMINATED)}this.isMapped=true;this.startTransactionTimer()};SIPClientTransaction.prototype.processResponse=function(){if(arguments.length==2){var e=arguments[0];var d=arguments[1];this.processResponseargu2(e,d)}else{var a=arguments[0];var c=arguments[1];var b=arguments[2];this.processResponseargu3(a,c,b)}};SIPClientTransaction.prototype.processResponseargu2=function(f,h){var g=null;var a=f.getCSeq().getMethod();var j=f.getDialogId(false);if(a==this.CANCEL&&this.lastRequest!=null){var d=this.lastRequest.getInviteTransaction();if(d!=null){g=d.defaultDialog}}else{g=this.getDialog(j)}if(g==null){var b=f.getStatusCode();if((b>100&&b<300)&&(f.getToTag()!=null||this.sipStack.isRfc2543Supported())&&this.sipStack.isDialogCreated(a)){if(this.defaultDialog!=null){if(f.getFromTag()!=null){var e=this.defaultDialog.getLastResponse();var c=this.defaultDialog.getDialogId();if(e==null||a==this.SUBSCRIBE&&c==j&&e.getCSeq().getMethod()==this.NOTIFY){this.defaultDialog.setLastResponse(this,f);g=this.defaultDialog}else{g=this.sipStack.getDialog(j);if(g==null){if(this.defaultDialog.isAssignedFunction()){g=this.sipStack.createDialog(this,f)}}}if(g!=null){this.setDialog(g,g.getDialogId())}}else{console.error("SIPClientTransaction:processResponseargu2(): response without from-tag");throw"SIPClientTransaction:processResponseargu2(): response without from-tag"}}else{if(this.sipStack.isAutomaticDialogSupportEnabled){g=this.sipStack.createDialog(this,f);this.setDialog(g,g.getDialogId())}}}else{g=this.defaultDialog}}else{g.setLastResponse(this,f)}this.processResponse(f,h,g)};SIPClientTransaction.prototype.processResponseargu3=function(a,d,c){if(this.getState()==null){return}if((this.COMPLETED==this.getState()||this.TERMINATED==this.getState())&&a.getStatusCode()/100==1){return}this.lastResponse=a;try{if(this.isInviteTransaction()){this.inviteClientTransaction(a,d,c)}else{this.nonInviteClientTransaction(a,d,c)}}catch(b){console.error("SIPClientTransaction:processResponseargu3(): catched exception:"+b);this.setState(this.TERMINATED)}};SIPClientTransaction.prototype.nonInviteClientTransaction=function(a,d,b){var c=a.getStatusCode();if(this.TRYING==this.getState()){if(100<=c&&c<=199){this.setState(this.PROCEEDING);this.enableTimeoutTimer(this.TIMER_F);if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(200<=c&&c<=699){if(!this.isReliable()){this.setState(this.COMPLETED);this.enableTimeoutTimer(this.TIMER_K)}else{this.setState(this.TERMINATED);this.sipStack.removeTransaction(this);clearTimeout(this.timer)}if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}}}else{if(this.PROCEEDING==this.getState()){if(100<=c&&c<=199){if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(200<=c&&c<=699){if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}this.disableTimeoutTimer();if(!this.isReliable()){this.setState(this.COMPLETED);this.enableTimeoutTimer(this.TIMER_K)}else{this.setState(this.TERMINATED)}}}}}};SIPClientTransaction.prototype.inviteClientTransaction=function(a,d,b){var c=a.getStatusCode();if(this.TERMINATED==this.getState()){var e=false;if(b!=null&&b.isAckSeen()&&b.getLastAckSent()!=null){if(b.getLastAckSent().getCSeq().getSeqNumber()==a.getCSeq().getSeqNumber()&&a.getFromTag()==b.getLastAckSent().getFromTag()){e=true}}if(b!=null&&!e&&a.getCSeq().getMethod()==b.getMethod()){b.resendAck()}this.sipStack.removeTransaction(this);clearTimeout(this.timer);return}else{if(this.CALLING==this.getState()){if(200<=c&&c<=299){this.disableTimeoutTimer();this.setState(this.TERMINATED);if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(100<=c&&c<=199){this.disableTimeoutTimer();this.setState(this.PROCEEDING);if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(300<=c&&c<=699){this.sendMessage(this.createErrorAck());if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}if(!this.isReliable()){this.setState(this.COMPLETED);this.enableTimeoutTimer(this.TIMER_D)}else{this.setState(this.TERMINATED)}}}}}else{if(this.PROCEEDING==this.getState()){if(100<=c&&c<=199){if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(200<=c&&c<=299){this.setState(this.TERMINATED);this.sipStack.removeTransaction(this);clearTimeout(this.timer);if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}else{if(300<=c&&c<=699){this.sendMessage(this.createErrorAck());if(!this.isReliable()){this.setState(this.COMPLETED);this.enableTimeoutTimer(this.TIMER_D)}else{this.setState(this.TERMINATED);this.sipStack.removeTransaction(this);clearTimeout(this.timer)}if(this.respondTo!=null){this.respondTo.processResponse(a,this,b)}}}}}else{if(this.COMPLETED==this.getState()){this.setState(this.TERMINATED);this.sipStack.removeTransaction(this);clearTimeout(this.timer);if(300<=c&&c<=699){this.sendMessage(this.createErrorAck())}}}}}};SIPClientTransaction.prototype.sendRequest=function(){var d=this.getOriginalRequest();if(this.getState()!=null){console.error("SIPClientTransaction:sendRequest(): request already sent");throw"SIPClientTransaction:sendRequest(): request already sent"}try{d.checkHeaders()}catch(c){console.error("SIPClientTransaction:sendRequest(): "+c);throw"SIPClientTransaction:sendRequest(): "+c}try{if(this.getOriginalRequest().getMethod()==this.CANCEL&&this.sipStack.isCancelClientTransactionChecked()){var b=this.sipStack.findCancelTransaction(this.getOriginalRequest(),false);if(b==null){console.error("SIPClientTransaction:sendRequest(): could not find original tx to cancel. RFC 3261 9.1");throw"SIPClientTransaction:sendRequest(): could not find original tx to cancel. RFC 3261 9.1"}else{if(b.getState()==null){console.error("SIPClientTransaction:sendRequest(): state is null no provisional response yet -- cannot cancel RFC 3261 9.1");throw"SIPClientTransaction:sendRequest(): state is null no provisional response yet -- cannot cancel RFC 3261 9.1"}else{if(b.getMethod()!=this.INVITE){console.error("SIPClientTransaction:sendRequest(): cannot cancel non-invite requests RFC 3261 9.1");throw"SIPClientTransaction:sendRequest(): cannot cancel non-invite requests RFC 3261 9.1"}}}}else{if(this.getOriginalRequest().getMethod()==this.BYE||this.getOriginalRequest().getMethod()==this.NOTIFY){var a=this.sipStack.getDialog(this.getOriginalRequest().getDialogId(false));if(this.getSipProvider().isAutomaticDialogSupportEnabled()&&a!=null){console.error("SIPClientTransaction:sendRequest(): Dialog is present and AutomaticDialogSupport is enabled for the provider -- Send the Request using the Dialog.sendRequest(transaction)");throw"SIPClientTransaction:sendRequest(): Dialog is present and AutomaticDialogSupport is enabled for the provider -- Send the Request using the Dialog.sendRequest(transaction)"}}}if(this.getOriginalRequest().getMethod()==this.INVITE){a=this.getDefaultDialog()}this.isMapped=true;this.sendMessage(d)}catch(c){this.setState(this.TERMINATED);console.error("SIPClientTransaction:sendRequest(): catched exception:"+c);throw"SIPClientTransaction:sendRequest(): catched exception:"+c}};SIPClientTransaction.prototype.fireTimeoutTimer=function(){clearTimeout(this.timer);var b=this.getDialog();if(this.CALLING==this.getState()||this.TRYING==this.getState()||this.PROCEEDING==this.getState()){if(b!=null&&(b.getState()==null||b.getState()==this.EARLY)){if(this.getSIPStack().isDialogCreated(this.getOriginalRequest().getMethod())){b.delet()}}else{if(b!=null){if(this.getOriginalRequest().getMethod().toLowerCase()==this.BYE.toLowerCase()&&b.isTerminatedOnBye()){b.delet()}}}}if(this.COMPLETED!=this.getState()){this.raiseErrorEvent(this.TIMEOUT_ERROR);if(this.getOriginalRequest().getMethod().toLowerCase()==this.CANCEL.toLowerCase()){var a=this.getOriginalRequest().getInviteTransaction();if(a!=null&&a.getDialog()!=null&&(a.getState()==this.CALLING||a.getState()==this.PROCEEDING)){a.setState(this.TERMINATED)}}}else{this.setState(this.TERMINATED)}};SIPClientTransaction.prototype.createCancel=function(){var a=this.getOriginalRequest();if(a==null){console.error("SIPClientTransaction:createCancel(): bad state "+this.getState());throw"SIPClientTransaction:createCancel(): bad state "+this.getState()}if(a.getMethod()!=this.INVITE){console.error("SIPClientTransaction:createCancel(): only INIVTE may be cancelled");throw"SIPClientTransaction:createCancel(): only INIVTE may be cancelled"}if(a.getMethod().toLowerCase()==this.ACK.toLowerCase()){console.error("SIPClientTransaction:createCancel(): cannot Cancel ACK!");throw"SIPClientTransaction:createCancel(): cannot Cancel ACK!"}else{var b=a.createCancelRequest();b.setInviteTransaction(this);return b}};SIPClientTransaction.prototype.createAck=function(){var l=this.getOriginalRequest();if(l==null){console.error("SIPClientTransaction:createAck(): bad state "+getState());throw"SIPClientTransaction:createAck(): bad state "+getState()}if(this.getMethod().toLowerCase()==this.ACK.toLowerCase()){console.error("SIPClientTransaction:createAck(): cannot ACK an ACK!");throw"SIPClientTransaction:createAck(): cannot ACK an ACK!"}else{if(this.lastResponse==null){console.error("SIPClientTransaction:createAck(): bad Transaction state");throw"SIPClientTransaction:createAck(): bad Transaction state"}else{if(this.lastResponse.getStatusCode()<200){console.error("SIPClientTransaction:createAck() : cannot ACK a provisional response!");throw"SIPClientTransaction:createAck(): cannot ACK a provisional response!"}}}var c=l.createAckRequest(this.lastResponse.getTo());var f=this.lastResponse.getRecordRouteHeaders();if(f==null){if(this.lastResponse.getContactHeaders()!=null&&this.lastResponse.getStatusCode()/100!=3){var g=this.lastResponse.getContactHeaders().getFirst();var a=g.getAddress().getURI();c.setRequestURI(a)}return c}c.removeHeader(this.RouteHeader);var h=new RouteList();for(var e=f.length-1;e>=0;e--){var d=f[e];var j=new Route();j.setAddressrr.getAddress();j.setParameters(d.getParameters());h.add(j)}g=null;if(this.lastResponse.getContactHeaders()!=null){g=this.lastResponse.getContactHeaders().getFirst()}if(!h.getFirst().getAddress().getURI().hasLrParam()){j=null;if(g!=null){j=new Route();j.setAddress(g.getAddress())}var b=h.getFirst();h.removeFirst();a=b.getAddress().getURI();c.setRequestURI(a);if(j!=null){h.add(j)}c.addHeader(h)}else{if(g!=null){a=g.getAddress().getURI();c.setRequestURI(a);c.addHeader(h)}}return c};SIPClientTransaction.prototype.createErrorAck=function(){var a=this.getOriginalRequest();if(a==null){console.error("SIPClientTransaction:createErrorAck(): bad state "+getState());throw"SIPClientTransaction:createErrorAck(): bad state "+getState()}if(this.getMethod()!=this.INVITE){console.error("SIPClientTransaction:createErrorAck(): can only ACK an INVITE!");throw"SIPClientTransaction:createErrorAck(): can only ACK an INVITE!"}else{if(this.lastResponse==null){console.error("SIPClientTransaction:createErrorAck(): bad Transaction state");throw"SIPClientTransaction:createErrorAck():  bad Transaction state"}else{if(this.lastResponse.getStatusCode()<200){console.error("SIPClientTransaction:createErrorAck(): cannot ACK a provisional response!");throw"SIPClientTransaction:createErrorAck(): cannot ACK a provisional response!"}}}return a.createErrorAck(this.lastResponse.getTo())};SIPClientTransaction.prototype.setViaPort=function(a){this.viaPort=a};SIPClientTransaction.prototype.setViaHost=function(a){this.viaHost=a};SIPClientTransaction.prototype.getViaPort=function(){return this.viaPort};SIPClientTransaction.prototype.getViaHost=function(){return this.viaHost};SIPClientTransaction.prototype.getOutgoingViaHeader=function(){return this.getMessageProcessor().getViaHeader()};SIPClientTransaction.prototype.clearState=function(){};SIPClientTransaction.prototype.setState=function(a){if(a==this.TERMINATED&&this.isReliable()){this.collectionTime=this.TIMER_J}SIPTransaction.prototype.setState.call(this,a)};SIPClientTransaction.prototype.startTransactionTimer=function(){if(this.transactionTimerStarted==false){this.transactionTimerStarted=true;if(this.sipStack.getTimer()!=null){var a=this;this.timer=setInterval(function(){if(a.isTerminated()){var b=a.getSIPStack();b.removeTransaction(a)}else{a.fireTimer()}},this.BASE_TIMER_INTERVAL)}}};SIPClientTransaction.prototype.terminate=function(){this.setState(this.TERMINATED)};SIPClientTransaction.prototype.checkFromTag=function(b){var a=this.getRequest().getFromTag();if(this.defaultDialog!=null){if(a==null^b.getFrom().getTag()==null){return false}if(a.toLowerCase()!=b.getFrom().getTag().toLowerCase()&&a!=null){return false}}return true};SIPClientTransaction.prototype.getDialog=function(){if(arguments.length==0){return this.getDialogargu0()}else{if(arguments.length==1){var a=arguments[0];return this.getDialogargu1(a)}}};SIPClientTransaction.prototype.getDialogargu0=function(){var b=null;if(this.lastResponse!=null&&this.lastResponse.getFromTag()!=null&&this.lastResponse.getToTag()!=null&&this.lastResponse.getStatusCode()!=100){var a=this.lastResponse.getDialogId(false);b=this.getDialog(a)}if(b==null){b=this.defaultDialog}return b};SIPClientTransaction.prototype.getDialogargu1=function(b){var a=null;for(var c=0;c<this.sipDialogs.length;c++){if(this.sipDialogs[c][0]==b){a=this.sipDialogs[c][1]}}return a};SIPClientTransaction.prototype.setDialog=function(c,b){if(c==null){console.error("SIPClientTransaction:setDialog(): bad dialog argument");throw"SIPClientTransaction:setDialog(): bad dialog argument"}if(this.defaultDialog==null){this.defaultDialog=c}if(b!=null&&c.getDialogId()!=null){var a=null;for(var d=0;d<this.sipDialogs.length;d++){if(this.sipDialogs[d][0]==b){a=d}}if(a!=null){this.sipDialogs[a][1]=c}else{var e=new Array();e[0]=b;e[1]=c;this.sipDialogs.push(e)}}};SIPClientTransaction.prototype.getDefaultDialog=function(){return this.defaultDialog};SIPClientTransaction.prototype.setNextHop=function(a){this.nextHop=a};SIPClientTransaction.prototype.getNextHop=function(){return this.nextHop};SIPClientTransaction.prototype.alertIfStillInCallingStateBy=function(a){this.timeoutIfStillInCallingState=true;this.callingStateTimeoutCount=a};var sipservertransaction=this;function SIPServerTransaction(b,a){this.classname="SIPServerTransaction";this.auditTag=0;this.sipStack=b;this.originalRequest=null;this.encapsulatedChannel=a;this.wsurl=this.encapsulatedChannel.wsurl;this.disableTimeoutTimer();this.eventListeners=new Array();this.addEventListener(b);this.timert=null;this.timer=null;if(b.maxListenerResponseTime!=-1){this.timer=b.getTimer();this.timer=setTimeout(this.listenerExecutionMaxTimer(),b.maxListenerResponseTime*1000)}this.rseqNumber=(Math.random()*1000);this.requestOf=null;this.dialog=null;this.pendingReliableResponse=null;this.provisionalResponseTask=null;this.isAckSeen=null;this.pendingSubscribeTransaction=null;this.inviteTransaction=null;sipservertransaction=this}SIPServerTransaction.prototype=new SIPTransaction();SIPServerTransaction.prototype.constructor=SIPServerTransaction;SIPServerTransaction.prototype.TERMINATED_STATE=2;SIPServerTransaction.prototype.TIMEOUT_ERROR=1;SIPServerTransaction.prototype.RECEIVED="received";SIPServerTransaction.prototype.INVITE="INVITE";SIPServerTransaction.prototype.CANCEL="CANCEL";SIPServerTransaction.prototype.BRANCH="branch";SIPServerTransaction.prototype.BRANCH_MAGIC_COOKIE_LOWER_CASE="z9hg4bk";SIPServerTransaction.prototype.TIMER_H=64;SIPServerTransaction.prototype.TIMER_J=64;SIPServerTransaction.prototype.TIMER_I=SIPTransaction.prototype.TIMER_I;SIPServerTransaction.prototype.CONNECTION_LINGER_TIME=8;SIPServerTransaction.prototype.BASE_TIMER_INTERVAL=500;SIPServerTransaction.prototype.ExpiresHeader="Expires";SIPServerTransaction.prototype.ContactHeader="Contact";function listenerExecutionMaxTimer(){var b=sipservertransaction;if(b.getState()==null){b.terminate();var a=b.getSIPStack();a.removePendingTransaction(b);a.removeTransaction(b)}}SIPServerTransaction.prototype.setRequestInterface=function(a){this.requestOf=a};SIPServerTransaction.prototype.getResponseChannel=function(){return this};SIPServerTransaction.prototype.isMessagePartOfTransaction=function(e){var f=false;var a=e.getCSeq().getMethod();if(a==this.INVITE||!this.isTerminated()){var g=e.getViaHeaders();if(g!=null){var d=g.getFirst();var c=d.getBranch();if(c!=null){if(c.toLowerCase().substring(0,7)!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE){c=null}}if(c!=null&&this.getBranch()!=null){if(a==this.CANCEL){if(this.getMethod()==this.CANCEL&&this.getBranch().toLowerCase()==c.toLowerCase()&&d.getSentBy()==this.getOriginalRequest().getViaHeaders().getFirst().getSentBy()){f=true}else{f=false}}else{if(this.getBranch().toLowerCase()==c.toLowerCase()&&d.getSentBy()==this.getOriginalRequest().getViaHeaders().getFirst().getSentBy()){f=true}else{f=false}}}else{var j=SIPTransaction.prototype.fromTag;var n=e.getFrom().getTag();if(j==null||n==null){var m=true}else{m=false}var p=SIPTransaction.prototype.toTag;var h=e.getTo().getTag();if(p==null||h==null){var l=true}else{l=false}if(e instanceof SIPResponse){var b=true}else{b=false}if(e.getCSeq().getMethod().toLowerCase()==this.CANCEL.toLowerCase()&&getOriginalRequest().getCSeq().getMethod().toLowerCase()!=this.CANCEL.toLowerCase()){f=false}else{if((b||this.getOriginalRequest().getRequestURI()==e.getRequestURI())&&(m||j!=null&&j.toLowerCase()==n.toLowerCase())&&(l||p!=null&&p.toLowerCase()==h.toLowerCase())&&this.getOriginalRequest().getCallId().getCallId().toLowerCase()==e.getCallId().getCallId().toLowerCase()&&this.getOriginalRequest().getCSeq().getSeqNumber()==e.getCSeq().getSeqNumber()&&((e.getCSeq().getMethod()!=(this.CANCEL))||this.getOriginalRequest().getMethod()==e.getCSeq().getMethod())&&d==getOriginalRequest().getViaHeaders().getFirst()){f=true}}}}}return f};SIPServerTransaction.prototype.isTransactionMapped=function(){return this.isMapped};SIPServerTransaction.prototype.processRequest=function(b,c){var d=false;if(this.getRealState()==null){this.setOriginalRequest(b);this.setState("TRYING");d=true;this.setPassToListener()}else{if(this.isInviteTransaction()&&"COMPLETED"==this.getRealState()&&b.getMethod()=="ACK"){this.setState("CONFIRMED");if(!this.isReliable()){this.enableTimeoutTimer(this.TIMER_I)}else{this.setState("TERMINATED")}if(this.sipStack.isNon2XXAckPassedToListener()){this.requestOf.processRequest(b,this)}return}else{if(b.getMethod()==this.getOriginalRequest().getMethod()){if("PROCEEDING"==this.getRealState()||"COMPLETED"==this.getRealState()){if(this.lastResponse!=null){SIPTransaction.prototype.sendMessage.call(this,this.lastResponse)}}else{if(b.getMethod()=="ACK"){if(this.requestOf!=null){this.requestOf.processRequest(b,this)}}}return}}}if("COMPLETED"!=this.getRealState()&&"TERMINATED"!=this.getRealState()&&this.requestOf!=null){if(this.getOriginalRequest().getMethod()==b.getMethod()){if(d){this.requestOf.processRequest(b,this)}}else{if(this.requestOf!=null){this.requestOf.processRequest(b,this)}}}else{if(this.getSIPStack().isDialogCreated(this.getOriginalRequest().getMethod())&&this.getRealState()=="TERMINATED"&&b.getMethod()=="ACK"&&this.requestOf!=null){var a=this.dialog;if(a==null||!a.ackProcessed){if(a!=null){a.ackReceived(b);a.ackProcessed=true}this.requestOf.processRequest(b,this)}}else{if(b.getMethod()=="CANCEL"){this.sendMessage(b.createResponse("OK"))}}}};SIPServerTransaction.prototype.sendMessage=function(d){var a=d;var c=a.getStatusCode();if(this.getOriginalRequest().getTopmostVia().getBranch()!=null){a.getTopmostVia().setBranch(this.getBranch())}else{a.getTopmostVia().removeParameter(ParameterNames.BRANCH)}if(!this.getOriginalRequest().getTopmostVia().hasPort()){a.getTopmostVia().removePort()}if(!a.getCSeq().getMethod()==this.getOriginalRequest().getMethod()){this.sendResponseSRT(a);return}if(this.getRealState()=="TRYING"){if(c<=199&&c>=100){this.setState("PROCEEDING")}else{if(200<=c&&c<=699){if(!this.isInviteTransaction()){if(!this.isReliable()){this.setState("COMPLETED");this.enableTimeoutTimer(this.TIMER_J)}else{this.setState("TERMINATED")}}else{if(c<=299&&c>=200){this.disableTimeoutTimer();this.collectionTime=this.TIMER_J;this.setState("TERMINATED")}else{this.setState("COMPLETED");this.enableTimeoutTimer(this.TIMER_H)}}}}}else{if(this.getRealState()=="PROCEEDING"){if(this.isInviteTransaction()){if(c<=299&&c>=100){this.disableTimeoutTimer();this.collectionTime=this.TIMER_J;this.setState("TERMINATED")}else{if(300<=c&&c<=699){this.setState("COMPLETED");this.enableTimeoutTimer(this.TIMER_H)}}}else{if(200<=c&&c<=699){this.setState("COMPLETED");if(!this.isReliable()){this.enableTimeoutTimer(this.TIMER_J)}else{this.setState("TERMINATED")}}}}else{if("COMPLETED"==this.getRealState()){return}}}try{this.lastResponse=a;this.sendResponseSRT(a)}catch(b){this.setState("TERMINATED");this.collectionTime=0;console.error("SIPServerTransaction:sendMessage(): catched exception:"+b)}};SIPServerTransaction.prototype.getViaHost=function(){return this.getMessageChannel().getViaHost()};SIPServerTransaction.prototype.getViaPort=function(){return this.getMessageChannel().getViaPort()};SIPServerTransaction.prototype.fireTimeoutTimer=function(){clearTimeout(this.timer);if(this.getMethod()=="INVITE"&&this.sipStack.removeTransactionPendingAck(this)){return}var a=this.dialog;if(this.getSIPStack().isDialogCreated(this.getOriginalRequest().getMethod())&&("CALLING"==this.getRealState()||"TRYING"==this.getRealState())){a.setState(this.TERMINATED_STATE)}else{if(this.getOriginalRequest().getMethod()=="BYE"){if(a!=null&&a.isTerminatedOnBye()){a.setState(this.TERMINATED_STATE)}}}if("COMPLETED"==this.getRealState()&&this.isInviteTransaction()){this.raiseErrorEvent(this.TIMEOUT_ERROR);this.setState("TERMINATED");this.sipStack.removeTransaction(this)}else{if("COMPLETED"==this.getRealState()&&!this.isInviteTransaction()){this.setState("TERMINATED");this.sipStack.removeTransaction(this)}else{if("CONFIRMED"==this.getRealState()&&this.isInviteTransaction()){this.setState("TERMINATED");this.sipStack.removeTransaction(this)}else{if(!isInviteTransaction()&&("COMPLETED"==this.getRealState()||"CONFIRMED"==this.getRealState())){this.setState("TERMINATED")}else{if(isInviteTransaction()&&"TERMINATED"==this.getRealState()){this.raiseErrorEvent(this.TIMEOUT_ERROR);if(a!=null){a.setState(this.TERMINATED_STATE)}}}}}}};SIPServerTransaction.prototype.getLastResponse=function(){return this.lastResponse};SIPServerTransaction.prototype.sendResponseSRT=function(a){this.getMessageChannel().sendMessage(a);this.startTransactionTimer()};SIPServerTransaction.prototype.sendResponse=function(e){var g=e;var h=this.dialog;if(e==null){console.error("SIPServerTransaction:sendResponse(): null response argument");throw"SIPServerTransaction:sendResponse(): null response argument"}try{g.checkHeaders()}catch(j){console.error("SIPServerTransaction:sendMessage(): catched exception:"+j);throw"SIPServerTransaction:sendResponse(): catched exception:"+j}if(g.getCSeq().getMethod()!=this.getMethod()){console.error("SIPServerTransaction:sendResponse(): CSeq method does not match Request method of request that created the tx.");throw"SIPServerTransaction:sendResponse(): CSeq method does not match Request method of request that created the tx."}if(this.getMethod()==("SUBSCRIBE")&&e.getStatusCode()/100==2){if(e.getHeader(this.ExpiresHeader)==null){console.error("SIPServerTransaction:sendResponse(): Expires header is mandatory in 2xx response of SUBSCRIBE");throw"SIPServerTransaction:sendResponse(): Expires header is mandatory in 2xx response of SUBSCRIBE"}else{var f=this.getOriginalRequest().getExpires();var b=e.getExpires();if(f!=null&&b.getExpires()>f.getExpires()){console.error("SIPServerTransaction:sendResponse(): response Expires time exceeds request Expires time : See RFC 3265 3.1.1");throw"SIPServerTransaction:sendResponse():Response Expires time exceeds request Expires time : See RFC 3265 3.1.1"}}}if(g.getStatusCode()==200&&g.getCSeq().getMethod()=="INVITE"&&g.getHeader(this.ContactHeader)==null){console.error("SIPServerTransaction:sendResponse(): Contact Header is mandatory for the OK to the INVITE");throw"SIPServerTransaction:sendResponse(): Contact Header is mandatory for the OK to the INVITE"}if(!this.isMessagePartOfTransaction(e)){console.error("SIPServerTransaction:sendResponse(): response does not belong to this transaction.");throw"SIPServerTransaction:sendResponse(): response does not belong to this transaction."}try{if(h!=null){if(g.getStatusCode()/100==2&&this.sipStack.isDialogCreated(g.getCSeq().getMethod())){if(h.getLocalTag()==null&&g.getTo().getTag()==null){var l=new Utils();g.getTo().setTag(l.generateTag())}else{if(h.getLocalTag()!=null&&g.getToTag()==null){g.setToTag(h.getLocalTag())}else{if(h.getLocalTag()!=null&&g.getToTag()!=null&&h.getLocalTag()!=g.getToTag()){console.error("SIPServerTransaction:sendResponse(): tag mismatch dialogTag is "+h.getLocalTag()+" responseTag is "+g.getToTag());throw"SIPServerTransaction:sendResponse(): tag mismatch dialogTag is "+h.getLocalTag()+" responseTag is "+g.getToTag()}}}}if(g.getCallId().getCallId()!=h.getCallId().getCallId()){console.error("SIPServerTransaction:sendResponse(): dialog mismatch!");throw"SIPServerTransaction:sendResponse(): dialog mismatch!"}}var c=this.getRequest().getFrom().getTag();if(c!=null&&g.getFromTag()!=null&&g.getFromTag()!=c){console.error("SIPServerTransaction:sendResponse(): from tag of request does not match response from tag");throw"SIPServerTransaction:sendResponse(): from tag of request does not match response from tag"}else{if(c!=null){g.getFrom().setTag(c)}}if(h!=null&&e.getStatusCode()!=100){h.setResponseTags(g);var d=h.getState();h.setLastResponse(this,e);if(d==null&&h.getState()=="TERMINATED"){var a=new DialogTerminatedEvent(h.getSipProvider(),h);h.getSipProvider().handleEvent(a,this)}}this.sendMessage(e)}catch(j){this.setState("TERMINATED");this.raiseErrorEvent(this.TRANSPORT_ERROR);console.error("SIPServerTransaction:sendMessage(): catched exception:"+j)}};SIPServerTransaction.prototype.getRealState=function(){return SIPTransaction.prototype.getState.call(this)};SIPServerTransaction.prototype.getState=function(){if(this.isInviteTransaction()&&"TRYING"==SIPTransaction.prototype.getState.call(this)){return"PROCEEDING"}else{return SIPTransaction.prototype.getState.call(this)}};SIPServerTransaction.prototype.setState=function(a){if(a=="TERMINATED"&&this.isReliable()){this.collectionTime=this.TIMER_J}SIPTransaction.prototype.setState.call(this,a)};SIPServerTransaction.prototype.startTransactionTimer=function(){if(this.transactionTimerStarted==false){this.transactionTimerStarted=true}if(this.transactionTimerStarted){if(this.sipStack.getTimer()!=null){this.timer=this.sipStack.getTimer();var a=this;this.timer=setInterval(function(){if(!a.isTerminated()){a.fireTimer()}},this.BASE_TIMER_INTERVAL)}}};SIPServerTransaction.prototype.getDialog=function(){return this.dialog};SIPServerTransaction.prototype.setDialog=function(b,a){this.dialog=b;if(a!=null){this.dialog.setAssigned()}};SIPServerTransaction.prototype.terminate=function(){this.setState("TERMINATED")};SIPServerTransaction.prototype.setAckSeen=function(){this.isAckSeen=true};SIPServerTransaction.prototype.ackSeen=function(){return this.isAckSeen};SIPServerTransaction.prototype.setMapped=function(a){this.isMapped=true};SIPServerTransaction.prototype.setPendingSubscribe=function(a){this.pendingSubscribeTransaction=a};SIPServerTransaction.prototype.setInviteTransaction=function(a){this.inviteTransaction=a};SIPServerTransaction.prototype.getCanceledInviteTransaction=function(){return this.inviteTransaction};SIPServerTransaction.prototype.scheduleAckRemoval=function(){if(this.getMethod()==null||this.getMethod()!="ACK"){console.error("SIPServerTransaction:scheduleAckRemoval():  method is null["+(this.getMethod()==null)+"] or method is not ACK["+this.getMethod()+"]");throw"SIPServerTransaction:scheduleAckRemoval():  method is null["+(this.getMethod()==null)+"] or method is not ACK["+this.getMethod()+"]"}this.startTransactionTimer()};SIPServerTransaction.prototype.map=function(){var a=this.getRealState();if(a==null||a=="TRYING"){this.isMapped=true}this.sipStack.removePendingTransaction(this)};function Utils(){this.classname="Utils";this.rand=Math.random();this.counter=0;this.callIDCounter=null;this.toHex=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];this.signature=this.toHexString(this.getBytes(Math.round(this.rand*1000).toString()));this.instance="Utils"}Utils.prototype.BRANCH_MAGIC_COOKIE="z9hG4bK";Utils.prototype.getInstance=function(){return new Function("return new "+this.instance)()};Utils.prototype.toHexString=function(a){var e="";for(var d=0;d<a.length;d++){e=e+this.toHex[(a[d]>>4)&15];e=e+this.toHex[a[d]&15]}return e};Utils.prototype.getQuotedString=function(a){return'"'+a.replace('"','\\"')+'"'};Utils.prototype.reduceString=function(c){var e=c.toLowerCase();var a=e.length();var b="";for(var d=0;d<a;d++){if(e.charAt(d)==" "||e.charAt(d)=="\t"){continue}else{b=b+e.charAt(d)}}return b};Utils.prototype.generateCallIdentifier=function(c){var d=new Date().getTime()+this.callIDCounter+Math.round(this.rand*100000000000000000000);var a=new String(this.getBytes(d.toString()));var e=this.digest(a);var b=e;return b+"@"+c};Utils.prototype.generateTag=function(){var a=Math.round(this.rand*10000000000);return a.toString(16)};Utils.prototype.generateBranchId=function(){var d=new Date().getTime();var c=Math.round(this.rand*100000000000000000000)+this.counter+d;var a=new String(this.getBytes(c.toString()));var b=this.digest(a);return this.BRANCH_MAGIC_COOKIE+b+this.signature};Utils.prototype.responseBelongsToUs=function(c){var b=c.getTopmostVia();var f=b.getBranch();var a=f.length-1;var d=0;for(var e=this.signature.length-1;e>=0;e--){if(this.signature[e]==f[a]){d=d+1;a=a-1}}if(f!=null&&d==this.signature.length){return true}else{return false}};Utils.prototype.getSignature=function(){return this.signature};Utils.prototype.randomString=function(a){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";var c="";for(var d=0;d<a;d++){var b=Math.floor(Math.random()*e.length);c+=e.substring(b,b+1)}return c};Utils.prototype.getBytes=function(b){var c=new Array();b=new String(b);for(var a=0;a<b.length;a++){c[a]=b.charCodeAt(a)}return c};Utils.prototype.digest=function(u){function N(b,a){return(b<<a)|(b>>>(32-a))}function M(x,b){var G,a,d,F,c;d=(x&2147483648);F=(b&2147483648);G=(x&1073741824);a=(b&1073741824);c=(x&1073741823)+(b&1073741823);if(G&a){return(c^2147483648^d^F)}if(G|a){if(c&1073741824){return(c^3221225472^d^F)}else{return(c^1073741824^d^F)}}else{return(c^d^F)}}function t(a,c,b){return(a&c)|((~a)&b)}function s(a,c,b){return(a&b)|(c&(~b))}function r(a,c,b){return(a^c^b)}function p(a,c,b){return(c^(a|(~b)))}function w(H,G,af,ae,F,I,ad){H=M(H,M(M(t(G,af,ae),F),ad));return M(N(H,I),G)}function f(H,G,af,ae,F,I,ad){H=M(H,M(M(s(G,af,ae),F),ad));return M(N(H,I),G)}function J(H,G,af,ae,F,I,ad){H=M(H,M(M(r(G,af,ae),F),ad));return M(N(H,I),G)}function v(H,G,af,ae,F,I,ad){H=M(H,M(M(p(G,af,ae),F),ad));return M(N(H,I),G)}function e(x){var H;var d=x.length;var c=d+8;var b=(c-(c%64))/64;var G=(b+1)*16;var I=Array(G-1);var a=0;var F=0;while(F<d){H=(F-(F%4))/4;a=(F%4)*8;I[H]=(I[H]|(x.charCodeAt(F)<<a));F++}H=(F-(F%4))/4;a=(F%4)*8;I[H]=I[H]|(128<<a);I[G-2]=d<<3;I[G-1]=d>>>29;return I}function D(c){var b="",d="",x,a;for(a=0;a<=3;a++){x=(c>>>(a*8))&255;d="0"+x.toString(16);b=b+d.substr(d.length-2,2)}return b}function L(b){b=b.replace(/\r\n/g,"\n");var a="";for(var x=0;x<b.length;x++){var d=b.charCodeAt(x);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a}var E=Array();var T,h,K,y,g,ac,ab,aa,Z;var W=7,U=12,R=17,P=22;var C=5,B=9,A=14,z=20;var q=4,n=11,m=16,l=23;var Y=6,X=10,V=15,S=21;u=L(u);E=e(u);ac=1732584193;ab=4023233417;aa=2562383102;Z=271733878;for(T=0;T<E.length;T+=16){h=ac;K=ab;y=aa;g=Z;ac=w(ac,ab,aa,Z,E[T+0],W,3614090360);Z=w(Z,ac,ab,aa,E[T+1],U,3905402710);aa=w(aa,Z,ac,ab,E[T+2],R,606105819);ab=w(ab,aa,Z,ac,E[T+3],P,3250441966);ac=w(ac,ab,aa,Z,E[T+4],W,4118548399);Z=w(Z,ac,ab,aa,E[T+5],U,1200080426);aa=w(aa,Z,ac,ab,E[T+6],R,2821735955);ab=w(ab,aa,Z,ac,E[T+7],P,4249261313);ac=w(ac,ab,aa,Z,E[T+8],W,1770035416);Z=w(Z,ac,ab,aa,E[T+9],U,2336552879);aa=w(aa,Z,ac,ab,E[T+10],R,4294925233);ab=w(ab,aa,Z,ac,E[T+11],P,2304563134);ac=w(ac,ab,aa,Z,E[T+12],W,1804603682);Z=w(Z,ac,ab,aa,E[T+13],U,4254626195);aa=w(aa,Z,ac,ab,E[T+14],R,2792965006);ab=w(ab,aa,Z,ac,E[T+15],P,1236535329);ac=f(ac,ab,aa,Z,E[T+1],C,4129170786);Z=f(Z,ac,ab,aa,E[T+6],B,3225465664);aa=f(aa,Z,ac,ab,E[T+11],A,643717713);ab=f(ab,aa,Z,ac,E[T+0],z,3921069994);ac=f(ac,ab,aa,Z,E[T+5],C,3593408605);Z=f(Z,ac,ab,aa,E[T+10],B,38016083);aa=f(aa,Z,ac,ab,E[T+15],A,3634488961);ab=f(ab,aa,Z,ac,E[T+4],z,3889429448);ac=f(ac,ab,aa,Z,E[T+9],C,568446438);Z=f(Z,ac,ab,aa,E[T+14],B,3275163606);aa=f(aa,Z,ac,ab,E[T+3],A,4107603335);ab=f(ab,aa,Z,ac,E[T+8],z,1163531501);ac=f(ac,ab,aa,Z,E[T+13],C,2850285829);Z=f(Z,ac,ab,aa,E[T+2],B,4243563512);aa=f(aa,Z,ac,ab,E[T+7],A,1735328473);ab=f(ab,aa,Z,ac,E[T+12],z,2368359562);ac=J(ac,ab,aa,Z,E[T+5],q,4294588738);Z=J(Z,ac,ab,aa,E[T+8],n,2272392833);aa=J(aa,Z,ac,ab,E[T+11],m,1839030562);ab=J(ab,aa,Z,ac,E[T+14],l,4259657740);ac=J(ac,ab,aa,Z,E[T+1],q,2763975236);Z=J(Z,ac,ab,aa,E[T+4],n,1272893353);aa=J(aa,Z,ac,ab,E[T+7],m,4139469664);ab=J(ab,aa,Z,ac,E[T+10],l,3200236656);ac=J(ac,ab,aa,Z,E[T+13],q,681279174);Z=J(Z,ac,ab,aa,E[T+0],n,3936430074);aa=J(aa,Z,ac,ab,E[T+3],m,3572445317);ab=J(ab,aa,Z,ac,E[T+6],l,76029189);ac=J(ac,ab,aa,Z,E[T+9],q,3654602809);Z=J(Z,ac,ab,aa,E[T+12],n,3873151461);aa=J(aa,Z,ac,ab,E[T+15],m,530742520);ab=J(ab,aa,Z,ac,E[T+2],l,3299628645);ac=v(ac,ab,aa,Z,E[T+0],Y,4096336452);Z=v(Z,ac,ab,aa,E[T+7],X,1126891415);aa=v(aa,Z,ac,ab,E[T+14],V,2878612391);ab=v(ab,aa,Z,ac,E[T+5],S,4237533241);ac=v(ac,ab,aa,Z,E[T+12],Y,1700485571);Z=v(Z,ac,ab,aa,E[T+3],X,2399980690);aa=v(aa,Z,ac,ab,E[T+10],V,4293915773);ab=v(ab,aa,Z,ac,E[T+1],S,2240044497);ac=v(ac,ab,aa,Z,E[T+8],Y,1873313359);Z=v(Z,ac,ab,aa,E[T+15],X,4264355552);aa=v(aa,Z,ac,ab,E[T+6],V,2734768916);ab=v(ab,aa,Z,ac,E[T+13],S,1309151649);ac=v(ac,ab,aa,Z,E[T+4],Y,4149444226);Z=v(Z,ac,ab,aa,E[T+11],X,3174756917);aa=v(aa,Z,ac,ab,E[T+2],V,718787259);ab=v(ab,aa,Z,ac,E[T+9],S,3951481745);ac=M(ac,h);ab=M(ab,K);aa=M(aa,y);Z=M(Z,g)}var j=D(ac)+D(ab)+D(aa)+D(Z);return j.toLowerCase()};function EventWrapper(a,b){this.classname="EventWrapper";this.sipEvent=a;this.transaction=b}function EventScanner(a){this.classname="EventScanner";this.isStopped=null;this.refCount=null;this.pendingEvents=new Array();this.eventMutex=new Array();this.eventMutex[0]=0;this.sipStack=a}EventScanner.prototype.BRANCH_MAGIC_COOKIE="z9hG4bK";EventScanner.prototype.incrementRefcount=function(){};EventScanner.prototype.addEvent=function(a){this.pendingEvents.push(a)};EventScanner.prototype.stop=function(){if(this.refCount>0){this.refCount--}if(this.refCount==0){this.isStopped=true}};EventScanner.prototype.forceStop=function(){this.isStopped=true;this.refCount=0};EventScanner.prototype.deliverEvent=function(l){var g=l.sipEvent;var d=this.sipStack.getSipListener();if(g instanceof RequestEvent){var h=g.getRequest();var c=this.sipStack.findTransaction(h,true);if(c!=null&&!c.passToListener()){return}else{if(this.sipStack.findPendingTransaction(h)!=null){return}else{var m=l.transaction;this.sipStack.putPendingTransaction(m)}}h.setTransaction(l.transaction);if(d!=null){d.processRequest(g)}if(l.transaction!=null){var j=l.transaction.getDialog();if(j!=null){j.requestConsumed()}}if(l.transaction!=null){this.sipStack.removePendingTransaction(l.transaction)}if(l.transaction.getOriginalRequest().getMethod()=="ACK"){l.transaction.setState("TERMINATED")}}else{if(g instanceof ResponseEvent){var a=g;var f=a.getResponse();var b=a.getDialog();if(d!=null){c=l.transaction;if(c!=null){c.setPassToListener()}d.processResponse(g)}if((b!=null&&(b.getState()==null||b.getState()!="TERMINATED"))&&(f.getStatusCode()==481||f.getStatusCode()==408)){b.doDeferredDelete()}if(f.getCSeq().getMethod()=="INVITE"&&b!=null&&f.getStatusCode()==200){b.doDeferredDeleteIfNoAckSent(f.getCSeq().getSeqNumber())}var e=l.transaction;if(e!=null&&"COMPLETED"==e.getState()&&e.getOriginalRequest()!=null&&e.getOriginalRequest().getMethod()!="INVITE"){e.clearState()}}else{if(g instanceof TimeoutEvent){if(d!=null){d.processTimeout(g)}}else{if(g instanceof DialogTimeoutEvent){if(d!=null&&d instanceof SipListenerExt){d.processDialogTimeout(g)}}else{if(g instanceof TransactionTerminatedEvent){if(d!=null){d.processTransactionTerminated(g)}}else{if(g instanceof DialogTerminatedEvent){if(d!=null){d.processDialogTerminated(g)}}}}}}}};EventScanner.prototype.run=function(){while(true){var a=null;var b;while(this.pendingEvents.length==0){if(this.isStopped){return}try{}catch(d){console.error("EventScanner:run(): catched exception:"+d);return}}b=this.pendingEvents;this.pendingEvents=new Array();for(var c=0;c<b.length;c++){a=b[c];this.deliverEvent(a)}}};function DialogTerminatedEvent(b,a){this.classname="DialogTerminatedEvent";this.mDialog=a;this.source=b}DialogTerminatedEvent.prototype.getDialog=function(){return this.mDialog};function DialogTimeoutEvent(b,a,c){this.classname="DialogTimeoutEvent";this.serialVersionUID="-2514000059989311925L";this.source=b;this.m_dialog=a;this.m_reason=c}DialogTimeoutEvent.prototype.AckNotReceived="AckNotReceived";DialogTimeoutEvent.prototype.AckNotSent="AckNotSent";DialogTimeoutEvent.prototype.ReInviteTimeout="ReInviteTimeout";DialogTimeoutEvent.prototype.getDialog=function(){return this.m_dialog};DialogTimeoutEvent.prototype.getReason=function(){return this.m_reason};function TransactionTerminatedEvent(){this.classname="TransactionTerminatedEvent";this.mTimeout=null;this.mIsServerTransaction=null;this.mServerTransaction=null;this.mClientTransaction=null;this.source=null;if(arguments[1] instanceof SIPServerTransaction){var c=arguments[0];var b=arguments[1];this.source=c;this.mServerTransaction=b;this.mIsServerTransaction=true}else{if(arguments[1] instanceof SIPClientTransaction){c=arguments[0];var a=arguments[1];this.source=c;this.mClientTransaction=a;this.mIsServerTransaction=false}}}TransactionTerminatedEvent.prototype.isServerTransaction=function(){return this.mIsServerTransaction};TransactionTerminatedEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};TransactionTerminatedEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function RequestEvent(d,c,a,b){this.classname="RequestEvent";this.mDialog=a;this.mRequest=b;this.mServerTransaction=c;this.source=d}RequestEvent.prototype.getDialog=function(){return this.mDialog};RequestEvent.prototype.getRequest=function(){return this.mRequest};RequestEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function TimeoutEvent(){this.classname="TimeoutEvent";this.mTimeout=null;this.mIsServerTransaction=null;this.mServerTransaction=null;this.mClientTransaction=null;this.source=null;if(arguments[1] instanceof SIPServerTransaction){var d=arguments[0];var c=arguments[1];var b=arguments[2];this.source=d;this.mTimeout=b;this.mServerTransaction=c;this.mIsServerTransaction=true}else{if(arguments[1] instanceof SIPClientTransaction){d=arguments[0];var a=arguments[1];b=arguments[2];this.source=d;this.mTimeout=b;this.mClientTransaction=a;this.mIsServerTransaction=false}}}TimeoutEvent.prototype=new TransactionTerminatedEvent();TimeoutEvent.prototype.constructor=TimeoutEvent;TimeoutEvent.prototype.getTimeout=function(){return this.mTimeout};function TransactionTerminatedEvent(){this.classname="TransactionTerminatedEvent";this.mTimeout=null;this.mIsServerTransaction=null;this.mServerTransaction=null;this.mClientTransaction=null;this.source=null;if(arguments[1] instanceof SIPServerTransaction){var c=arguments[0];var b=arguments[1];this.source=c;this.mServerTransaction=b;this.mIsServerTransaction=true}else{if(arguments[1] instanceof SIPClientTransaction){c=arguments[0];var a=arguments[1];this.source=c;this.mClientTransaction=a;this.mIsServerTransaction=false}}}TransactionTerminatedEvent.prototype.isServerTransaction=function(){return this.mIsServerTransaction};TransactionTerminatedEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};TransactionTerminatedEvent.prototype.getServerTransaction=function(){return this.mServerTransaction};function DefaultAddressResolver(){this.classname="DefaultAddressResolver"}DefaultAddressResolver.prototype.resolveAddress=function(a){if(a.getPort()!=-1){return a}else{var b=new MessageProcessor();return new HopImpl(a.getHost(),b.getDefaultPort(),a.getTransport())}};function ResponseEvent(d,c,b,a){this.classname="ResponseEvent";this.mDialog=b;this.mResponse=a;this.mServerTransaction=c;this.source=d}ResponseEvent.prototype.getDialog=function(){return this.mDialog};ResponseEvent.prototype.getResponse=function(){return this.mResponse};ResponseEvent.prototype.getClientTransaction=function(){return this.mClientTransaction};function ResponseEventExt(d,b,c,a){this.classname="ResponseEventExt";this.mDialog=c;this.mResponse=a;this.mServerTransaction=b;this.source=d;this.m_originalTransaction=b}ResponseEventExt.prototype=new ResponseEvent();ResponseEventExt.prototype.constructor=ResponseEventExt;ResponseEventExt.prototype.isForkedResponse=function(){return this.mServerTransaction==null&&this.m_originalTransaction!=null};ResponseEventExt.prototype.setOriginalTransaction=function(a){this.m_originalTransaction=a};ResponseEventExt.prototype.getOriginalTransaction=function(){return this.m_originalTransaction};function DialogFilter(a){this.classname="DialogFilter";this.sipStack=a;this.transactionChannel=null;this.listeningPoint=null}DialogFilter.prototype.processResponse=function(){if(arguments.length==2){var e=arguments[0];var d=arguments[1];this.processResponseargu2(e,d)}else{var a=arguments[0];var c=arguments[1];var b=arguments[2];this.processResponseargu3(a,c,b)}};DialogFilter.prototype.processResponseargu2=function(l,p){var f=l.getDialogId(false);var h=this.sipStack.getDialog(f);var a=l.getCSeq().getMethod();var m=new Utils();if(this.sipStack.checkBranchId&&!m.responseBelongsToUs(l)){return}if(this.listeningPoint==null){return}var b=this.listeningPoint.getProvider();if(b==null){return}if(b.getSipListener()==null){return}var d=this.transactionChannel;if(h==null&&d!=null){h=d.getDialog(f);if(h!=null&&h.getState()=="TERMINATED"){h=null}}if(this.transactionChannel!=null){var e=this.transactionChannel.getRequest().getFromTag();if(e==null^l.getFrom().getTag()==null){return}if(e!=null&&e.toLowerCase()!=l.getFrom().getTag().toLowerCase()){return}}if(this.sipStack.isDialogCreated(a)&&l.getStatusCode()!=100&&l.getFrom().getTag()!=null&&l.getTo().getTag()!=null&&h==null){if(b.isAutomaticDialogSupportEnabled()){if(this.transactionChannel!=null){if(h==null){h=this.sipStack.createDialog(this.transactionChannel,l);this.transactionChannel.setDialog(h,l.getDialogId(false))}}else{h=this.sipStack.createDialog(b,l)}}}else{if(h!=null&&d==null&&h.getState()!="TERMINATED"){if(h.getState()=="TERMINATED"&&(l.getStatusCode()>=200||l.getStatusCode()<=299)){if((l.getStatusCode()>=200||l.getStatusCode()<=299)&&l.getCSeq().getMethod()=="INVITE"){var g=h.createAck(l.getCSeq().getSeqNumber());h.sendAck(g)}return}else{var n=false;if(h.isAckSeen()&&h.getLastAckSent()!=null){if(h.getLastAckSent().getCSeq().getSeqNumber()==l.getCSeq().getSeqNumber()&&l.getDialogId(false)==h.getLastAckSent().getDialogId(false)){n=true}}if(n&&l.getCSeq().getMethod()==h.getMethod()){h.resendAck();return}}}}if(h!=null&&l.getStatusCode()!=100&&l.getTo().getTag()!=null){h.setLastResponse(d,l)}var c=new ResponseEventExt(b,d,h,l);if(l.getCSeq().getMethod()=="INVITE"){var j=this.sipStack.getForkedTransaction(l.getTransactionId());c.setOriginalTransaction(j)}b.handleEvent(c,d)};DialogFilter.prototype.processResponseargu3=function(e,a,g){if(this.listeningPoint==null){return}var j=new Utils();if(this.sipStack.checkBranchId&&!j.responseBelongsToUs(e)){return}var b=this.listeningPoint.getProvider();if(b==null){return}if(b.getSipListener()==null){return}var d=this.transactionChannel;if(d==null){if(g!=null){if(e.getStatusCode()<200||e.getStatusCode()>299){return}else{if(g.getState()=="TERMINATED"){return}else{var l=false;if(g.isAckSeen()&&g.getLastAckSent()!=null){if(g.getLastAckSent().getCSeq().getSeqNumber()==e.getCSeq().getSeqNumber()){l=true}}if(l&&e.getCSeq().getMethod()==g.getMethod()){g.resendAck();return}}}}var f=new ResponseEventExt(b,d,g,e);if(e.getCSeqHeader().getMethod()=="INVITE"){var h=this.sipStack.getForkedTransaction(e.getTransactionId());f.setOriginalTransaction(h)}b.handleEvent(f,d);return}var c=null;c=new ResponseEventExt(b,d,g,e);if(e.getCSeqHeader().getMethod()=="INVITE"){c.setOriginalTransaction(d)}if(g!=null&&e.getStatusCode()!=100){g.setLastResponse(d,e);d.setDialog(g,g.getDialogId())}b.handleEvent(c,d)};DialogFilter.prototype.getSipStack=function(){return this.sipStack};DialogFilter.prototype.sendBadRequestResponse=function(c,e,d){var f=c.createResponse(400);if(d!=null){f.setReasonPhrase(d)}var b=new MessageFactoryImpl();var a=b.getDefaultServerHeader();if(a!=null){f.setHeader(a)}if(c.getMethod()=="INVITE"){this.sipStack.addTransactionPendingAck(e)}e.sendResponse(f)};DialogFilter.prototype.sendCallOrTransactionDoesNotExistResponse=function(c,d){var e=c.createResponse(481);var b=new MessageFactoryImpl();var a=b.getDefaultServerHeader();if(a!=null){e.setHeader(a)}if(c.getMethod()=="INVITE"){this.sipStack.addTransactionPendingAck(d)}d.sendResponse(e)};DialogFilter.prototype.sendLoopDetectedResponse=function(c,d){var e=c.createResponse(482);var b=new MessageFactoryImpl();var a=b.getDefaultServerHeader();if(a!=null){e.setHeader(a)}this.sipStack.addTransactionPendingAck(d);d.sendResponse(e)};DialogFilter.prototype.processRequest=function(m,j){if(this.listeningPoint==null){return}var u=this.transactionChannel.getSIPStack();var c=this.listeningPoint.getProvider();if(c==null){return}var p=this.transactionChannel;var s=m.getDialogId(true);var q=u.getDialog(s);if(q!=null&&c!=q.getSipProvider()){var n=q.getMyContactHeader();if(n!=null){var b=n.getAddress().getURI();var l=b.getHost();var e=b.getPort();if(e==-1){e=5060}if(l!=null&&(l!=this.listeningPoint.getHostAddress()||e!=this.listeningPoint.getPort())){q=null}}}if(c.isAutomaticDialogSupportEnabled()&&c.isDialogErrorsAutomaticallyHandled()&&m.getToTag()==null){var t=u.findMergedTransaction(m);if(t!=null){this.sendLoopDetectedResponse(m,p);return}}if(m.getMethod()=="ACK"){if(q==null){var f=u.findTransactionPendingAck(m);if(f!=null){f.setAckSeen();u.removeTransaction(f);u.removeTransactionPendingAck(f);return}}else{if(!q.handleAck(p)){f=u.findTransactionPendingAck(m);if(f!=null){f.setAckSeen();u.removeTransaction(f);u.removeTransactionPendingAck(f)}return}else{p.passToListener();q.addTransaction(p);q.addRoute(m);p.setDialog(q,s);if(m.getMethod()=="INVITE"&&c.isDialogErrorsAutomaticallyHandled()){u.putInMergeTable(p,m)}if(u.deliverTerminatedEventForAck){u.addTransaction(p);p.scheduleAckRemoval()}else{p.setMapped(true)}}}}else{if(m.getMethod()=="BYE"){if(q!=null&&!q.isRequestConsumable(m)){if(q.getRemoteSeqNumber()>=m.getCSeq().getSeqNumber()&&p.getState()=="TRYING"){this.sendServerInternalErrorResponse(m,p)}if(p!=null){u.removeTransaction(p)}return}else{if(q==null&&c.isAutomaticDialogSupportEnabled()){var a=m.createResponse(481);a.setReasonPhrase("Dialog Not Found");p.sendResponse(a);if(p!=null){u.removeTransaction(p);p=null}return}}if(p!=null&&q!=null){if(c==q.getSipProvider()){u.addTransaction(p);q.addTransaction(p);p.setDialog(q,s)}}}else{if(m.getMethod()=="CANCEL"){var h=u.findCancelTransaction(m,true);if(m.getMethod()=="CANCEL"){if(h!=null&&h.getState()=="TERMINATED"){p.sendResponse(m.createResponse("OK"));return}}if(p!=null&&h!=null&&h.getDialog()!=null){p.setDialog(h.getDialog(),s);q=h.getDialog()}else{if(h==null&&c.isAutomaticDialogSupportEnabled()&&p!=null){a=m.createResponse(481);c.sendResponse(a);if(p!=null){u.removeTransaction(p)}return}}if(h!=null){if(p!=null){u.addTransaction(p);p.setPassToListener();p.setInviteTransaction(h)}}}else{if(m.getMethod()=="INVITE"){var g=q==null?null:q.getInviteTransaction();if(q!=null&&p!=null&&g!=null&&m.getCSeq().getSeqNumber()>q.getRemoteSeqNumber()&&g instanceof SIPServerTransaction&&c.isDialogErrorsAutomaticallyHandled()&&q.isSequnceNumberValidation()&&g.isInviteTransaction()&&g.getState()!="COMPLETED"&&g.getState()!="TERMINATED"&&g.getState()!="CONFIRMED"){this.sendServerInternalErrorResponse(m,p);return}g=(q==null?null:q.getLastTransaction());if(q!=null&&c.isDialogErrorsAutomaticallyHandled()&&g!=null&&g.isInviteTransaction()&&g instanceof SIPClientTransaction&&g.getLastResponse()!=null&&g.getLastResponse().getStatusCode()==200&&!q.isAckSent(g.getLastResponse().getCSeq().getSeqNumber())){this.sendRequestPendingResponse(m,p);return}if(q!=null&&g!=null&&c.isDialogErrorsAutomaticallyHandled()&&g.isInviteTransaction()&&g instanceof ServerTransaction&&!q.isAckSeen()){this.sendRequestPendingResponse(m,p);return}}}}}if(q!=null&&p!=null&&m.getMethod()!="BYE"&&m.getMethod()!="CANCEL"&&m.getMethod()!="ACK"){if(!q.isRequestConsumable(m)){if(q.getRemoteSeqNumber()>=m.getCSeq().getSeqNumber()&&c.isDialogErrorsAutomaticallyHandled()&&(p.getState()=="TRYING"||p.getState()=="PROCEEDING")){this.sendServerInternalErrorResponse(m,p)}return}try{if(c==q.getSipProvider()){u.addTransaction(p);q.addTransaction(p);q.addRoute(m);p.setDialog(q,s)}}catch(r){console.error("DialogFilter:processRequest(): catched exception:"+r);u.removeTransaction(p);return}}var d;if(p!=null){d=new RequestEvent(c,p,q,m)}else{d=new RequestEvent(c,null,q,m)}c.handleEvent(d,p)};DialogFilter.prototype.getProcessingInfo=function(){return null};function ListeningPointImpl(){this.classname="ListeningPointImpl";this.transport="ws";this.messageProcessor=null;this.sipProvider=null;if(arguments.length!=0){var a=arguments[0];this.sipStack=a}}ListeningPointImpl.prototype.makeKey=function(b,c){var a="";a=(a+b+"/"+c).toLowerCase();return a};ListeningPointImpl.prototype.getKey=function(){return this.makeKey(this.sipStack.getHostAddress(),this.transport)};ListeningPointImpl.prototype.getUserAgent=function(){return this.sipStack.getUserAgent()};ListeningPointImpl.prototype.setSipProvider=function(a){this.sipProvider=a};ListeningPointImpl.prototype.removeSipProvider=function(){this.sipProvider=null};ListeningPointImpl.prototype.getURLWS=function(){return this.messageProcessor.getURLWS()};ListeningPointImpl.prototype.getTransport=function(){return this.messageProcessor.getTransport()};ListeningPointImpl.prototype.getProvider=function(){return this.sipProvider};ListeningPointImpl.prototype.setSentBy=function(a){this.messageProcessor.setSentBy(a)};ListeningPointImpl.prototype.getSentBy=function(){return this.messageProcessor.getSentBy()};ListeningPointImpl.prototype.isSentBySet=function(){return this.messageProcessor.isSentBySet()};ListeningPointImpl.prototype.getViaHeader=function(){return this.messageProcessor.getViaHeader()};ListeningPointImpl.prototype.getMessageProcessor=function(){return this.messageProcessor};ListeningPointImpl.prototype.getHost=function(){return this.hostname};ListeningPointImpl.prototype.createContactHeader=function(e){try{var c=this.sipStack.getHostAddress();var f=new SipUri();f.setHost_String(c);f.setUser(e);f.setTransportParam(this.transport);var a=new Contact();var b=new AddressImpl();b.setURI(f);a.setAddress(b);return a}catch(d){console.error("ListeningPointImpl:createContactHeader(): catched exception:"+d);return null}};ListeningPointImpl.prototype.sendHeartbeat=function(c){var a=this.messageProcessor.createMessageChannel(c);var b=new SIPRequest();b.setNullRequest();a.sendMessage(b)};ListeningPointImpl.prototype.createViaHeader=function(){return this.getViaHeader()};ListeningPointImpl.prototype.getPort=function(){return this.messageProcessor.getPort()};ListeningPointImpl.prototype.getHostAddress=function(){return this.sipStack.getHostAddress()};function NistSipMessageFactoryImpl(a){this.classname="NistSipMessageFactoryImpl";this.sipStack=a}NistSipMessageFactoryImpl.prototype.newSIPServerRequest=function(d,c){if(c==null||d==null){console.error("NistSipMessageFactoryImpl:newSIPServerRequest(): null Arg!");throw"NistSipMessageFactoryImpl:newSIPServerRequest(): null Arg!"}var b=c.getSIPStack();var a=new DialogFilter(b);if(c instanceof SIPTransaction){a.transactionChannel=c}a.listeningPoint=c.getMessageProcessor().getListeningPoint();if(a.listeningPoint==null){return null}return a};NistSipMessageFactoryImpl.prototype.newSIPServerResponse=function(e,c){var b=c.getSIPStack();var d=b.findTransaction(e,false);if(d!=null){if(d.getState()==null){return null}else{if("COMPLETED"==d.getState()&&e.getStatusCode()/100==1){return null}}}var a=new DialogFilter(this.sipStack);a.transactionChannel=d;a.listeningPoint=c.getMessageProcessor().getListeningPoint();return a};function SipProviderImpl(){this.classname="SipProviderImpl";this.sipListener=null;this.sipStack=null;this.listeningPoints=new Array();this.eventScanner=null;this.address=null;this.port=null;this.automaticDialogSupportEnabled=null;this.dialogErrorsAutomaticallyHandled=true;if(arguments.length!=0){var a=arguments[0];this.sipStack=a;this.eventScanner=a.getEventScanner();this.eventScanner.incrementRefcount();this.listeningPoints=new Array();this.automaticDialogSupportEnabled=this.sipStack.isAutomaticDialogSupportEnabledFunction();this.dialogErrorsAutomaticallyHandled=this.sipStack.isAutomaticDialogErrorHandlingEnabledFunction()}}SipProviderImpl.prototype.getListeningPoint=function(){if(this.listeningPoints.length>0){return this.listeningPoints[0][1]}else{return null}};SipProviderImpl.prototype.isAutomaticDialogSupportEnabled=function(){return this.automaticDialogSupportEnabled};SipProviderImpl.prototype.handleEvent=function(b,c){var a=new EventWrapper(b,c);if(!this.sipStack.reEntrantListener){this.eventScanner.addEvent(a)}else{this.eventScanner.deliverEvent(a)}};SipProviderImpl.prototype.addSipListener=function(a){if(this.sipStack.sipListener==null){this.sipStack.sipListener=a}else{if(this.sipStack.sipListener!=a){console.error("SipProviderImpl:addSipListener(): stack already has a listener. Only one listener per stack allowed");throw"SipProviderImpl:addSipListener(): stack already has a listener. Only one listener per stack allowed"}}this.sipListener=a};SipProviderImpl.prototype.setListeningPoint=function(b){if(b==null){console.error("SipProviderImpl:setListeningPoint(): null listeningPoint argument");throw"SipProviderImpl:setListeningPoint(): null listeningPoint argument "}var a=b;a.sipProvider=this;var d=a.getTransport().toUpperCase();this.address=b.getHostAddress();this.port=b.getPort();this.listeningPoints=new Array();var c=new Array();c[0]=d;c[1]=b;this.listeningPoints.push(c)};SipProviderImpl.prototype.getSipListener=function(){return this.sipListener};SipProviderImpl.prototype.stop=function(){for(var a=0;a<this.listeningPoints.length;a++){var b=this.listeningPoints[a][1];b.removeSipProvider()}this.eventScanner.stop()};SipProviderImpl.prototype.getNewCallId=function(){var a=new Utils();var c=a.generateCallIdentifier(this.getListeningPoint().getHostAddress());var b=new CallID();b.setCallId(c);return b};SipProviderImpl.prototype.getNewClientTransaction=function(g){if(g==null){console.error("SipProviderImpl:getNewClientTransaction(): null request argument");throw"SipProviderImpl:getNewClientTransaction(): null request argument "}if(!this.sipStack.isAlive()){console.error("SipProviderImpl:getNewClientTransaction(): stack is stopped");throw"SipProviderImpl:getNewClientTransaction(): stack is stopped"}var n=g;if(n.getTransaction()!=null){console.error("SipProviderImpl:getNewClientTransaction(): transaction already assigned to request");throw"SipProviderImpl:getNewClientTransaction(): transaction already assigned to request"}if(n.getMethod()=="ACK"){console.error("SipProviderImpl:getNewClientTransaction(): cannot create client transaction for  ACK");throw"SipProviderImpl:getNewClientTransaction(): cannot create client transaction for  ACK"}if(n.getTopmostVia()==null){var l=this.getListeningPoint();var r=l.getViaHeader();g.setHeader(r)}try{n.checkHeaders()}catch(p){console.error("SipProviderImpl:getNewClientTransaction(): catched exception: "+p);throw"SipProviderImpl:getNewClientTransaction(): catched exception: "+p}var c=null;if(n.getTopmostVia().getBranch().substring(0,7)=="z9hG4bK"){c=true}else{c=false}if(n.getTopmostVia().getBranch()!=null&&c&&this.sipStack.findTransaction(g,false)!=null){console.error("SipProviderImpl:getNewClientTransaction(): transaction already exists!");throw"SipProviderImpl:getNewClientTransaction(): transaction already exists!"}if(g.getMethod().toUpperCase()=="CANCEL"){var j=this.sipStack.findCancelTransaction(g,false);if(j!=null){var b=this.sipStack.createClientTransaction(g,j.getMessageChannel());b.addEventListener(this);this.sipStack.addTransaction(b);if(j.getDialog()!=null){b.setDialog(j.getDialog(),n.getDialogId(false))}return b}}var a=null;a=this.sipStack.getNextHop(g);if(a==null){console.error("SipProviderImpl:getNewClientTransaction(): cannot resolve next hop -- transaction unavailable");throw"SipProviderImpl:getNewClientTransaction(): cannot resolve next hop -- transaction unavailable"}var d=a.getTransport();var s=n.getDialogId(false);var m=this.sipStack.getDialog(s);if(m!=null&&m.getState()=="TERMINATED"){this.sipStack.removeDialog(m)}var e=null;c=null;if(n.getTopmostVia().getBranch().substring(0,7)!="z9hG4bK"){c=true}else{c=false}if(n.getTopmostVia().getBranch()==null||c||this.sipStack.checkBranchIdFunction()){var q=new Utils();e=q.generateBranchId();n.getTopmostVia().setBranch(e)}var h=n.getTopmostVia();if(h.getTransport()==null){h.setTransport(d)}e=n.getTopmostVia().getBranch();j=this.sipStack.createTransaction(n,this.sipStack.getChannel(),a);if(j==null){console.error("SipProviderImpl:getNewClientTransaction(): cannot create transaction");throw"SipProviderImpl:getNewClientTransaction(): cannot create transaction"}j.setNextHop(a);j.setOriginalRequest(n);j.setBranch(e);if(this.sipStack.isDialogCreated(g.getMethod())){if(m!=null){j.setDialog(m,n.getDialogId(false))}else{if(this.isAutomaticDialogSupportEnabled()){var f=this.sipStack.createDialog(j);j.setDialog(f,n.getDialogId(false))}}}else{if(m!=null){j.setDialog(m,n.getDialogId(false))}}j.addEventListener(this);return j};SipProviderImpl.prototype.getNewServerTransaction=function(f){if(!this.sipStack.isAlive()){console.error("SipProviderImpl:getNewServerTransaction(): stack is stopped");throw"SipProviderImpl:getNewServerTransaction(): stack is stopped"}var h=null;var e=f;try{e.checkHeaders()}catch(d){console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d);throw"SipProviderImpl:getNewServerTransaction(): catched exception:"+d}if(f.getMethod()=="ACK"){console.error("SipProviderImpl:getNewServerTransaction(): cannot create Server transaction for  ACK");throw"SipProviderImpl:getNewServerTransaction(): cannot Server client transaction for  ACK"}if(e.getMethod()=="NOTIFY"&&e.getFromTag()!=null&&e.getToTag()==null){var c=this.sipStack.findSubscribeTransaction(e,this.getListeningPoint());if(c==null&&!this.sipStack.deliverUnsolicitedNotify){console.error("SipProviderImpl:getNewServerTransaction(): cannot find matching Subscription (and gov.nist.javax.sip.DELIVER_UNSOLICITED_NOTIFY not set)");throw"SipProviderImpl:getNewServerTransaction(): cannot find matching Subscription (and gov.nist.javax.sip.DELIVER_UNSOLICITED_NOTIFY not set)"}}if(this.sipStack.isDialogCreated(e.getMethod())){if(this.sipStack.findTransaction(f,true)!=null){console.error("SipProviderImpl:getNewServerTransaction(): server transaction already exists!");throw"SipProviderImpl:getNewServerTransaction(): server transaction already exists!)"}h=f.getTransaction();if(h==null){console.error("SipProviderImpl:getNewServerTransaction(): transaction not available");throw"SipProviderImpl:getNewServerTransaction(): transaction not available"}if(h.getOriginalRequest()==null){h.setOriginalRequest(e)}try{this.sipStack.addTransaction(h)}catch(d){console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d);throw"SipProviderImpl:getNewServerTransaction(): catched exception:"+d}h.addEventListener(this);if(this.isAutomaticDialogSupportEnabled()){var a=e.getDialogId(true);var b=this.sipStack.getDialog(a);if(b==null){b=this.sipStack.createDialog(h)}h.setDialog(b,e.getDialogId(true));if(e.getMethod()=="INVITE"&&this.isDialogErrorsAutomaticallyHandled()){this.sipStack.putInMergeTable(h,e)}if(b.getRemoteTag()!=null&&b.getLocalTag()!=null){this.sipStack.putDialog(b)}b.setInviteTransaction(h);b.setState(b.EARLY_STATE)}}else{if(this.isAutomaticDialogSupportEnabled()){h=this.sipStack.findTransaction(f,true);if(h!=null){console.error("SipProviderImpl:getNewServerTransaction(): transaction exists!");throw"SipProviderImpl:getNewServerTransaction(): transaction exists!"}h=f.getTransaction();if(h==null){console.error("SipProviderImpl:getNewServerTransaction(): transaction not available");throw"SipProviderImpl:getNewServerTransaction():transaction not available"}if(h.getOriginalRequest()==null){h.setOriginalRequest(e)}try{this.sipStack.addTransaction(h)}catch(d){console.error("SipProviderImpl:getNewServerTransaction(): catched exception:"+d);throw"SipProviderImpl:getNewServerTransaction():  catched exception:"+d}a=e.getDialogId(true);b=this.sipStack.getDialog(a);if(b!=null){b.addTransaction(h);b.addRoute(e);h.setDialog(b,e.getDialogId(true))}}else{h=this.sipStack.findTransaction(f,true);if(h!=null){console.error("SipProviderImpl:getNewServerTransaction(): transaction exists!");throw"SipProviderImpl:getNewServerTransaction(): transaction exists!"}h=f.getTransaction();if(h!=null){if(h.getOriginalRequest()==null){h.setOriginalRequest(e)}this.sipStack.mapTransaction(h);a=e.getDialogId(true);b=this.sipStack.getDialog(a);if(b!=null){b.addTransaction(h);b.addRoute(e);h.setDialog(b,e.getDialogId(true))}return h}else{var g=e.getMessageChannel();h=this.sipStack.createServerTransaction(g);if(h==null){console.error("SipProviderImpl:getNewServerTransaction(): transaction unavailable -- too many servrer transactions");throw"SipProviderImpl:getNewServerTransaction(): transaction unavailable -- too many servrer transactions"}h.setOriginalRequest(e);this.sipStack.mapTransaction(h);a=e.getDialogId(true);b=this.sipStack.getDialog(a);if(b!=null){b.addTransaction(h);b.addRoute(e);h.setDialog(b,e.getDialogId(true))}return h}}}return h};SipProviderImpl.prototype.getSipStack=function(){return this.sipStack};SipProviderImpl.prototype.removeSipListener=function(b){if(b==this.getSipListener()){this.sipListener=null}var e=false;var d=this.sipStack.getSipProviders();for(var a=0;a<d.length;a++){var c=d[a];if(c.getSipListener()!=null){e=true}}if(!e){this.sipStack.sipListener=null}};SipProviderImpl.prototype.sendRequest=function(h){if(!this.sipStack.isAlive()){console.error("SipProviderImpl:sendRequest(): stack is stopped");throw"SipProviderImpl:sendRequest(): stack is stopped"}var a=this.sipStack.getRouter(h).getNextHop(h);if(a==null){console.error("SipProviderImpl:sendRequest(): could not determine next hop!");throw"SipProviderImpl:sendRequest():  could not determine next hop!"}var g=h;if((!g.isNullRequest())&&g.getTopmostVia()==null){console.error("SipProviderImpl:sendRequest(): invalid SipRequest -- no via header!");throw"SipProviderImpl:sendRequest(): invalid SipRequest -- no via header!"}if(!g.isNullRequest()){var c=g.getTopmostVia();var e=c.getBranch();if(e==null||e.length()==0){c.setBranch(g.getTransactionId())}}var f=null;var b=null;for(var d=0;d<this.listeningPoints.length;d++){if(a.getTransport().toUpperCase()==this.listeningPoints[d][0]){b=d}}if(b!=null){b=true}else{b=false}if(b){f=this.sipStack.createRawMessageChannel()}if(f!=null){f.sendMessage(g)}else{console.error("SipProviderImpl:sendRequest(): could not create a message channel for "+a.toString());throw"SipProviderImpl:sendRequest(): could not create a message channel for "+a.toString()}};SipProviderImpl.prototype.sendResponse=function(a){if(!this.sipStack.isAlive()){console.error("SipProviderImpl:sendResponse(): stack is stopped");throw"SipProviderImpl:sendResponse(): stack is stopped"}var g=a;var c=g.getTopmostVia();if(c==null){console.error("SipProviderImpl:sendResponse(): no via header in response!");throw"SipProviderImpl:sendResponse(): no via header in response!"}var b=this.sipStack.findTransaction(a,true);if(b!=null&&b.getState()!="TERMINATED"&&this.isAutomaticDialogSupportEnabled()){console.error("SipProviderImpl:sendResponse(): transaction exists -- cannot send response statelessly");throw"SipProviderImpl:sendResponse(): transaction exists -- cannot send response statelessly"}try{var e=this.getListeningPoint();if(e==null){console.error("SipProviderImpl:sendResponse(): whoopsa daisy! no listening point found for transport "+transport);throw"SipProviderImpl:sendResponse(): whoopsa daisy! no listening point found for transport "+transport}var f=this.sipStack.getChannel();f.sendMessage(g)}catch(d){console.error("SipProviderImpl:sendResponse(): catched exception: "+d);throw"SipProviderImpl:sendResponse(): catched exception:"+d}};SipProviderImpl.prototype.getNewDialog=function(a){if(a==null){console.error("SipProviderImpl:sendResponse(): null transaction!");throw"SipProviderImpl:sendResponse():  null transaction!"}if(!this.sipStack.isAlive()){console.error("SipProviderImpl:sendResponse(): stack is stopped");throw"SipProviderImpl:sendResponse(): stack is stopped"}if(this.isAutomaticDialogSupportEnabled()){console.error("SipProviderImpl:sendResponse(): error - AUTOMATIC_DIALOG_SUPPORT is on");throw"SipProviderImpl:sendResponse(): error - AUTOMATIC_DIALOG_SUPPORT is on"}if(!this.sipStack.isDialogCreated(a.getRequest().getMethod())){console.error("SipProviderImpl:sendResponse(): dialog cannot be created for this method "+a.getRequest().getMethod());throw"SipProviderImpl:sendResponse(): dialog cannot be created for this method "+a.getRequest().getMethod()}var g=null;var d=a;if(a instanceof SIPServerTransaction){var h=a;var b=h.getLastResponse();if(b!=null){if(b.getStatusCode()!=100){console.error("SipProviderImpl:sendResponse(): cannot set dialog after response has been sent");throw"SipProviderImpl:sendResponse(): cannot set dialog after response has been sent"}}var f=a.getRequest();var j=f.getDialogId(true);g=this.sipStack.getDialog(j);if(g==null){g=this.sipStack.createDialog(a);g.addTransaction(d);g.addRoute(f);d.setDialog(g,null)}else{d.setDialog(g,f.getDialogId(true))}if(f.getMethod()=="INVITE"&&this.isDialogErrorsAutomaticallyHandled()){this.sipStack.putInMergeTable(h,f)}}else{var e=a;b=e.getLastResponse();if(b==null){var c=e.getRequest();j=c.getDialogId(false);g=this.sipStack.getDialog(j);if(g!=null){console.error("SipProviderImpl:sendResponse(): dialog already exists!");throw"SipProviderImpl:sendResponse(): dialog already exists!"}else{g=this.sipStack.createDialog(d)}e.setDialog(g,null)}else{console.error("SipProviderImpl:sendResponse(): cannot call this method after response is received!");throw"SipProviderImpl:sendResponse(): cannot call this method after response is received!"}}g.addEventListener(this);return g};SipProviderImpl.prototype.transactionErrorEvent=function(d){var h=d.getSource();if(d.getErrorID()==2){var f=d.getSource();var g="TRANSACTION";var e=null;if(f instanceof SIPServerTransaction){e=new TimeoutEvent(this,f,g)}else{var c=f;var b=c.getNextHop();e=new TimeoutEvent(this,f,g)}this.handleEvent(e,f)}else{if(d.getErrorID()==1){f=d.getSource();g="TRANSACTION";e=null;if(f instanceof SIPServerTransaction){e=new TimeoutEvent(this,f,g)}else{c=f;b=c.getNextHop();e=new TimeoutEvent(this,f,g)}this.handleEvent(e,f)}else{if(d.getErrorID()==3){f=d.getSource();var a=f;g=Timeout.RETRANSMIT;e=null;if(f instanceof SIPServerTransaction){e=new TimeoutEvent(this,f,g)}else{e=new TimeoutEvent(this,f,g)}this.handleEvent(e,f)}}}};SipProviderImpl.prototype.dialogErrorEvent=function(b){var a=b.getSource();var d="AckNotReceived";if(b.getErrorID()==2){d="AckNotSent"}else{if(b.getErrorID()==3){d="ReInviteTimeout"}}var c=new DialogTimeoutEvent(this,a,d);this.handleEvent(c,null)};SipProviderImpl.prototype.getListeningPoints=function(){var a=new Array();for(var b=0;b<this.listeningPoints.length;b++){a[b]=this.listeningPoints[b][1]}return a};SipProviderImpl.prototype.addListeningPoint=function(e){var d=e;if(d.sipProvider!=null&&d.sipProvider!=this){console.error("SipProviderImpl:addListeningPoint(): listening point assigned to another provider");throw"SipProviderImpl:addListeningPoint(): listening point assigned to another provider"}var h=d.getTransport().toUpperCase();if(this.listeningPoints.length==0){this.address=e.getHostAddress();this.port=e.getPort()}else{if((this.address!=e.getHostAddress())||this.port!=e.getPort()){console.error("SipProviderImpl:addListeningPoint(): provider already has different IP Address associated");throw"SipProviderImpl:addListeningPoint(): provider already has different IP Address associated"}}var b=null;var a=null;for(var c=0;c<this.listeningPoints.length;c++){if(h==this.listeningPoints[c][0]){b=c;a=c}}if(b!=null){b=true}else{b=false}if(a!=null){var f=this.listeningPoints[a][1]}if(b&&f!=e){console.error("SipProviderImpl:addListeningPoint(): listening point already assigned for transport!");throw"SipProviderImpl:addListeningPoint(): listening point already assigned for transport!"}d.sipProvider=this;var g=new Array();g[0]=h;g[1]=d;this.listeningPoints.push(g)};SipProviderImpl.prototype.removeListeningPoint=function(d){var c=d;var a=null;for(var b=0;b<this.listeningPoints.length;b++){if(c.getTransport().toUpperCase()==this.listeningPoints[b][0]){a=b}}this.listeningPoints.splice(a,1)};SipProviderImpl.prototype.removeListeningPoints=function(){for(var b=0;b<this.listeningPoints.length;b++){var a=this.listeningPoints[b][1];a.messageProcessor.stop()}this.listeningPoints=new Array()};SipProviderImpl.prototype.setAutomaticDialogSupportEnabled=function(a){this.automaticDialogSupportEnabled=a;if(this.automaticDialogSupportEnabled){this.dialogErrorsAutomaticallyHandled=true}};SipProviderImpl.prototype.setDialogErrorsAutomaticallyHandled=function(){this.dialogErrorsAutomaticallyHandled=true};SipProviderImpl.prototype.isDialogErrorsAutomaticallyHandled=function(){return this.dialogErrorsAutomaticallyHandled};function SipStackImpl(){this.classname="SipStackImpl";this.stackName=null;this.serverTransactionTable=new Array();this.clientTransactionTable=new Array();this.dialogCreatingMethods=new Array();this.earlyDialogTable=new Array();this.isBackToBackUserAgent=false;this.eventScanner=new EventScanner(this);this.listeningPoints=new Array();this.sipProviders=new Array();this.sipListener=null;this.setNon2XXAckPassedToListener(false);this.isAutomaticDialogSupportEnabled=true;this.isAutomaticDialogErrorHandlingEnabled=true;this.messageChannel=null;this.userAgentName=null;this.lastTransaction=null;this.reEntrantListener=true;this.dialogCreatingMethods.push("REFER");this.dialogCreatingMethods.push("INVITE");this.dialogCreatingMethods.push("SUBSCRIBE");if(arguments.length!=0){this.wsurl=arguments[0];var a=new Utils();this.setHostAddress(a.randomString(12)+".invalid");this.userAgentName=arguments[1];this.sipMessageFactory=new NistSipMessageFactoryImpl(this);this.defaultRouter=new DefaultRouter(this,this.stackAddress)}}SipStackImpl.prototype=new SIPTransactionStack();SipStackImpl.prototype.constructor=SipStackImpl;SipStackImpl.prototype.MAX_DATAGRAM_SIZE=8*1024;SipStackImpl.prototype.isAutomaticDialogSupportEnabledFunction=function(){return this.isAutomaticDialogSupportEnabled};SipStackImpl.prototype.isAutomaticDialogErrorHandlingEnabledFunction=function(){return this.isAutomaticDialogErrorHandlingEnabled};SipStackImpl.prototype.getEventScanner=function(){return this.eventScanner};SipStackImpl.prototype.getSipListener=function(){return this.sipListener};SipStackImpl.prototype.createSipProvider=function(d){if(d==null){console.error("SipProviderImpl:createSipProvider(): null listeningPoint argument");throw"SipProviderImpl:createSipProvider(): null listeningPoint argument"}var b=d;if(b.sipProvider!=null){console.error("SipProviderImpl:createSipProvider(): provider already attached!");throw"SipProviderImpl:createSipProvider(): provider already attached!"}var e=new SipProviderImpl(this);e.setListeningPoint(b);b.sipProvider=e;var a=null;for(var c=0;c<this.sipProviders.length;c++){if(this.sipProviders[c]==e){a=c}}if(a==null){this.sipProviders.push(e)}return e};SipStackImpl.prototype.createListeningPoint=function(){if(!this.isAlive()){this.toExit=false;this.reInitialize()}var g="ws";var d=new ListeningPointImpl(this);d.host=this.stackAddress;var c=d.makeKey(this.stackAddress,g);var e=null;for(var b=0;b<this.listeningPoints.length;b++){if(this.listeningPoints[b]==c){e=this.listeningPoints[b][1]}}if(e!=null){return e}else{var a=this.createMessageProcessor();e=new ListeningPointImpl(this);e.messageProcessor=a;a.setListeningPoint(e);var f=new Array();f[0]=c;f[1]=e;this.listeningPoints.push(f);this.messageChannel=a.createMessageChannel();return e}};SipStackImpl.prototype.createMessageProcessor=function(){var a=new WSMessageProcessor(this);this.addMessageProcessor(a);return a};SipStackImpl.prototype.reInitialize=function(){this.reInit();this.eventScanner=new EventScanner(this);this.listeningPoints=new Array();this.sipProviders=new Array();this.sipListener=null};SipStackImpl.prototype.getUrlWs=function(){return this.wsurl};SipStackImpl.prototype.getUserAgent=function(){return this.userAgentName};SipStackImpl.prototype.deleteListeningPoint=function(d){if(d==null){console.error("SipProviderImpl:deleteListeningPoint(): null listeningPoint arg");throw"SipProviderImpl:deleteListeningPoint(): null listeningPoint arg"}var e=d;this.removeMessageProcessor(e.messageProcessor);var c=e.getKey();var a=null;for(var b=0;b<this.listeningPoints.length;b++){if(this.listeningPoints[b][0]==c){a=b}}if(a!=null){this.listeningPoints.splice(a,1)}};SipStackImpl.prototype.deleteSipProvider=function(c){if(c==null){console.error("SipProviderImpl:deleteSipProvider(): null provider arg");throw"SipProviderImpl:deleteSipProvider(): null provider arg"}var d=c;if(d.getSipListener()!=null){console.error("SipProviderImpl:deleteSipProvider(): sipProvider still has an associated SipListener!");throw"SipProviderImpl:deleteSipProvider(): sipProvider still has an associated SipListener!"}d.removeListeningPoints();d.stop();var a=null;for(var b=0;b<this.sipProviders.length;b++){if(this.sipProviders[b]==c){a=b}}if(a!=null){this.sipProviders.splice(a,1)}if(this.sipProviders.length==0){this.stopStack()}};SipStackImpl.prototype.getListeningPoints=function(){return this.listeningPoints};SipStackImpl.prototype.getSipProviders=function(){if(this.sipProviders.length==1){return this.sipProviders[0]}else{return this.sipProviders}};SipStackImpl.prototype.getStackName=function(){return this.stackName};SipStackImpl.prototype.finalize=function(){this.stopStack()};SipStackImpl.prototype.stop=function(){this.stopStack();this.sipProviders=new Array();this.listeningPoints=new Array();if(this.eventScanner!=null){this.eventScanner.forceStop()}this.eventScanner=null};SipStackImpl.prototype.start=function(){if(this.eventScanner==null){this.eventScanner=new EventScanner(this)}};SipStackImpl.prototype.getSipListener=function(){return this.sipListener};SipStackImpl.prototype.setEnabledCipherSuites=function(a){this.cipherSuites=a};SipStackImpl.prototype.getEnabledCipherSuites=function(){return this.cipherSuites};SipStackImpl.prototype.setEnabledProtocols=function(a){this.enabledProtocols=a};SipStackImpl.prototype.getEnabledProtocols=function(){return this.enabledProtocols};SipStackImpl.prototype.setIsBackToBackUserAgent=function(a){this.isBackToBackUserAgent=a};SipStackImpl.prototype.isBackToBackUserAgent=function(){return this.isBackToBackUserAgent};SipStackImpl.prototype.isAutomaticDialogErrorHandlingEnabled=function(){return this.isAutomaticDialogErrorHandlingEnabled};SipStackImpl.prototype.getChannel=function(){return this.messageChannel};SipStackImpl.prototype.newSIPServerRequest=function(f,a){var g=null;var h=null;var j=f.getTransactionId();f.setMessageChannel(a);var d=null;for(var e=0;e<this.serverTransactionTable.length;e++){if(this.serverTransactionTable[e][0]==j){d=e}}if(d!=null){h=this.serverTransactionTable[d][1]}if(h==null||!h.isMessagePartOfTransaction(f)){h=null;var b=this.BRANCH_MAGIC_COOKIE_LOWER_CASE.length;var c=j.toLowerCase().substr(0,b-1);if(c!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE){for(e=0;(e<this.serverTransactionTable.length)&&(h==null);e++){g=this.serverTransactionTable[e][1];if(g.isMessagePartOfTransaction(f)){h=g}}}if(h==null){h=this.findPendingTransaction(f);if(h!=null){f.setTransaction(h);if(h!=null){return h}else{return null}}h=this.createServerTransaction(a);h.setOriginalRequest(f);f.setTransaction(h);if(f.getMethod()!="ACK"){h=this.getSipProviders().getNewServerTransaction(f)}}}if(h!=null){h.setRequestInterface(this.sipMessageFactory.newSIPServerRequest(f,h))}if(f.getMethod()=="ACK"){h=this.lastTransaction}else{this.lastTransaction=h}return h};SipStackImpl.prototype.newSIPServerResponse=function(c,j){var f=null;var g=null;var m=c.getTransactionId();var d=null;for(var e=0;e<this.clientTransactionTable.length;e++){if(this.clientTransactionTable[e][0]==m){d=e}}if(d!=null){g=this.clientTransactionTable[d][1]}var a=this.BRANCH_MAGIC_COOKIE_LOWER_CASE.length;var b=m.toLowerCase().substr(0,a-1);if(g==null||(!g.isMessagePartOfTransaction(c)&&b!=this.BRANCH_MAGIC_COOKIE_LOWER_CASE)){for(e=0;(e<this.clientTransactionTable.length)&&(g==null);e++){f=this.clientTransactionTable[e][1];if(f.isMessagePartOfTransaction(c)){g=f}}if(g==null){return this.sipMessageFactory.newSIPServerResponse(c,j)}}var h=this.sipMessageFactory.newSIPServerResponse(c,g);if(h!=null){g.setResponseInterface(h)}else{return null}return g};SipStackImpl.prototype.createServerTransaction=function(a){return new SIPServerTransaction(this,a)};SipStackImpl.prototype.removeTransaction=function(f){if(f instanceof SIPServerTransaction){var c=f.getTransactionId();var g=null;var a=null;for(var b=0;b<this.serverTransactionTable.length;b++){if(c==this.serverTransactionTable[b]){a=b;g=this.serverTransactionTable[b][1]}}this.serverTransactionTable.splice(a,1);var h=f.getMethod();this.removePendingTransaction(f);this.removeTransactionPendingAck(f);if(h.toUpperCase()=="INVITE"){this.removeFromMergeTable(f)}var e=f.getSipProvider();if(g!=null&&f.testAndSetTransactionTerminatedEvent()){var d=new TransactionTerminatedEvent(e,f);e.handleEvent(d,f)}}else{c=f.getTransactionId();var a=null;for(var b=0;b<this.clientTransactionTable.length;b++){if(this.clientTransactionTable[b][0]==c){a=b}}if(a!=null){g=this.clientTransactionTable[a][1];this.clientTransactionTable.splice(a,1)}if(g!=null&&f.testAndSetTransactionTerminatedEvent()){e=f.getSipProvider();d=new TransactionTerminatedEvent(e,f);e.handleEvent(d,f)}}};function SipListener(){}SipListener.prototype.processDialogTerminated=function(a){};SipListener.prototype.processIOException=function(a){};SipListener.prototype.processRequest=function(a){};SipListener.prototype.processResponse=function(a){};SipListener.prototype.processTimeout=function(a){};SipListener.prototype.processTransactionTerminated=function(a){};SipListener.prototype.processConnected=function(){};SipListener.prototype.processDisconnected=function(){};SipListener.prototype.processConnectionError=function(){};function SipFactory(){this.classname="SipFactory";this.sipFactory=null;this.mNameSipStackMap=new Array()}SipFactory.prototype.getInstance=function(){if(this.sipFactory==null){this.sipFactory=new SipFactory()}return this.sipFactory};SipFactory.prototype.resetFactory=function(){this.mNameSipStackMap=new Array()};SipFactory.prototype.createSipStack=function(c,b){var d=null;for(var a=0;a<this.mNameSipStackMap.length;a++){if(this.mNameSipStackMap[a][0]==c){d=this.mNameSipStackMap[a][1]}}if(d==null){var e=new Array();d=new SipStackImpl(c,b);e[0]=c;e[1]=d;this.mNameSipStackMap.push(e)}return d};SipFactory.prototype.createAddressFactory=function(){try{var b=new AddressFactoryImpl();return b}catch(a){console.error("SipFactory:createAddressFactory(): failed to create AddressFactory");throw"SipFactory:createAddressFactory(): failed to create AddressFactory"}};SipFactory.prototype.createHeaderFactory=function(){try{var a=new HeaderFactoryImpl();return a}catch(b){console.error("SipFactory:createHeaderFactory(): failed to create HeaderFactory");throw"SipFactory:createHeaderFactory(): failed to create HeaderFactory"}};SipFactory.prototype.createMessageFactory=function(c){try{var a=new MessageFactoryImpl(c);return a}catch(b){console.error("SipFactory:createMessageFactory(): failed to create MessageFactory");throw"SipFactory:createMessageFactory():failed to create MessageFactory"}};