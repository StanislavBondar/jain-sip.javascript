<html>
    <head>
        <title>WebRtcCommTestWebApp</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <script src="./jain-sip.js" type="text/javascript"></script> 
        <script src="./WebRtcComm.js" type="text/javascript"></script>     
        <script src="./WebRtcCommTestWebAppController.js" type="text/javascript" ></script>
        <script type='text/javascript'>	 
            webRtcCommTestWebAppController=new WebRtcCommTestWebAppController(this);

            function enableConnectButton() 
            {
                document.getElementById("connectButton").disabled=false;
            }
    
            function disableConnectButton() 
            {
                document.getElementById("connectButton").disabled=true;
            }

            function enableDisconnectButton() 
            {
                document.getElementById("disconnectButton").disabled=false;
            }
    
            function disableDisconnectButton() 
            {
                document.getElementById("disconnectButton").disabled=true;
            }
 
            function  enableCallButton() 
            {
                document.getElementById("callButton").disabled=false;
            }
    
            function disableCallButton() 
            {
                document.getElementById("callButton").disabled=true;
            }

            function enableEndCallButton() 
            {
                document.getElementById("endCallButton").disabled=false;
                //document.getElementById("stopVideoStreamButton").disabled=false;
                
                document.getElementById("muteLocalAudioCheckBox").checked=false;
                document.getElementById("hideLocalVideoCheckBox").checked=false;
                document.getElementById("muteRemoteAudioCheckBox").checked=false;
                document.getElementById("hideRemoteVideoCheckBox").checked=false;
                
                document.getElementById("muteLocalAudioCheckBox").disabled=false;
                document.getElementById("hideLocalVideoCheckBox").disabled=false;
                document.getElementById("muteRemoteAudioCheckBox").disabled=false;
                document.getElementById("hideRemoteVideoCheckBox").disabled=false;
            }
    
            function disableEndCallButton() 
            {
                document.getElementById("endCallButton").disabled=true;
                // document.getElementById("stopVideoStreamButton").disabled=true;
                
                document.getElementById("muteLocalAudioCheckBox").disabled=true;
                document.getElementById("hideLocalVideoCheckBox").disabled=true;
                document.getElementById("muteRemoteAudioCheckBox").disabled=true;
                document.getElementById("hideRemoteVideoCheckBox").disabled=true;
                
                document.getElementById("muteLocalAudioCheckBox").checked=false;
                document.getElementById("hideLocalVideoCheckBox").checked=false;
                document.getElementById("muteRemoteAudioCheckBox").checked=false;
                document.getElementById("hideRemoteVideoCheckBox").checked=false;
            }

            function enableAcceptCallButton() 
            {
                document.getElementById("acceptCallButton").disabled=false;
            }
    
            function disableAcceptCallButton() 
            {
                document.getElementById("acceptCallButton").disabled=true;
            }

            function enableRejectCallButton() 
            {
                document.getElementById("rejectCallButton").disabled=false;
            }
    
            function disableRejectCallButton() 
            {
                document.getElementById("rejectCallButton").disabled=true;
            }

            function enableCancelCallButton() 
            {
                document.getElementById("cancelCallButton").disabled=false;
            }
    
            function disableCancelCallButton() 
            {
                document.getElementById("cancelCallButton").disabled=true;
            }

            function disableStopVideoButton() 
            {
                document.getElementById("stopVideoButton").disabled=true;
            }

            function enableStopVideoButton() 
            {
                document.getElementById("stopVideoButton").disabled=false;
            }
            
            function showLocalVideo() 
            {
                document.getElementById("localVideo").disabled=true;
            }

            function hideLocalVideo() 
            {
                document.getElementById("localVideo").disabled=true;
            }

            function showRemoteVideo() 
            {
                document.getElementById("remoteVideo").style.visibility = "visible";
            }

            function hideRemoteVideo()
            {
                document.getElementById("remoteVideo").style.visibility = "hidden";
            }

            function playLocalVideo(localMediaStream) 
            {
                if(typeof navigator.webkitGetUserMedia != 'undefined')
                {     
                    document.getElementById("localVideo").src=webkitURL.createObjectURL(localMediaStream);
                }
                else if(typeof navigator.mozGetUserMedia != 'undefined')
                {
                    document.getElementById("localVideo").mozSrcObject=localMediaStream;
                }
                document.getElementById("localVideo").play();
            }


            function stopLocalVideo() 
            {
                document.getElementById("localVideo").pause();
                if(typeof navigator.webkitGetUserMedia != 'undefined')
                {     
                    document.getElementById("localVideo").src=null;
                }
                else if(typeof navigator.mozGetUserMedia != 'undefined')
                {
                    document.getElementById("localVideo").mozSrcObject=null;
                }
            }

            function playRemoteVideo(remoteMediaStream) 
            {
                if(typeof navigator.webkitGetUserMedia != 'undefined')
                {     
                    document.getElementById("remoteVideo").src=webkitURL.createObjectURL(remoteMediaStream);
                }
                else if(typeof navigator.mozGetUserMedia != 'undefined')
                {
                    document.getElementById("remoteVideo").mozSrcObject=remoteMediaStream;
                }
                document.getElementById("remoteVideo").play();
            }


            function stopRemoteVideo() 
            {
                document.getElementById("remoteVideo").pause();
                if(typeof navigator.webkitGetUserMedia != 'undefined')
                {     
                    document.getElementById("remoteVideo").src=undefined;
                }
                else if(typeof navigator.mozGetUserMedia != 'undefined')
                {
                    document.getElementById("remoteVideo").mozSrcObject=undefined;
                }
            }

            function playRinging(remoteMediaStream) 
            {
                document.getElementById("ringing").play();
            }


            function stopRinging() 
            {
                document.getElementById("ringing").pause();
            }
            
            function uncheckSipRegisterMode() 
            {
                document.getElementById("sipRegistrationCkeckBox").checked=false;
            }

            function checkSipRegisterMode() 
            {
                document.getElementById("sipRegistrationCkeckBox").checked=true;
            }

            function uncheckAudioMediaFlag() 
            {
                document.getElementById("audioMediaCkeckBox").checked=false;
            }

            function checkAudioMediaFlag() 
            {
                document.getElementById("audioMediaCkeckBox").checked=true;
            }

            function uncheckVideoMediaFlag() 
            {
                document.getElementById("videoMediaCkeckBox").checked=false;
            }

            function checkVideoMediaFlag() 
            {
                document.getElementById("videoMediaCkeckBox").checked=true;
            }
            function uncheckAudioMediaFlag() 
            {
                document.getElementById("audioMediaCkeckBox").checked=false;
            }

            function checkAudioMediaFlag() 
            {
                document.getElementById("audioMediaCkeckBox").checked=true;
            }

            function uncheckDataMediaFlag() 
            {
                document.getElementById("dataMediaCkeckBox").checked=false;
            }

            function checkDataMediaFlag() 
            {
                document.getElementById("dataMediaCkeckBox").checked=true;
            }
            

            function setStunServerTextInputValue(value) 
            {
                document.getElementById("stunServer").value=value;
            }

            function setSipOutboundProxyTextInputValue(value) 
            {
                document.getElementById("sipOutboundProxy").value=value;
            }

            function setSipUserAgentCapabilitiesTextInputValue(value) 
            {
                document.getElementById("sipUserAgentCapabilities").value=value;
            }
            
            function setSipDomainTextInputValue(value) 
            {
                document.getElementById("sipDomain").value=value;
            }

            function setSipDisplayNameTextInputValue(value) 
            {
                document.getElementById("sipDisplayName").value=value;
            }

            function setSipUserNameTextInputValue(value) 
            {
                document.getElementById("sipUserName").value=value;
            }

            function setSipLoginTextInputValue(value) 
            {
                document.getElementById("sipLogin").value=value;
            }

            function setSipPasswordTextInputValue(value) 
            {
                document.getElementById("sipPassword").value=value;
            }

            function setSipContactTextInputValue(value) 
            {
                document.getElementById("sipContact").value=value;
            }
            
            function setAudioCodecsFilterTextInputValue(value) 
            {
                document.getElementById("audioCodecsFilter").value=value;
            }
            
            function setVideoCodecsFilterTextInputValue(value) 
            {
                document.getElementById("videoCodecsFilter").value=value;
            }
            
            function setLocalVideoFormatTextInputValue(value) 
            {
                document.getElementById("localVideoFormat").value=value;
            }
            
            function getTextInputValue(elementId) 
            {
                var value = document.getElementById(elementId).value;
                if(value=="undefined") return undefined;
                else if(value=="") return undefined;
                else return value
            }
            
            function getStunServerTextInputValue() 
            {
                return getTextInputValue("stunServer")
            }

            function getSipOutboundProxyTextInputValue() 
            {
                return getTextInputValue("sipOutboundProxy");
            }

            function getSipUserAgentCapabilitiesTextInputValue() 
            {
                return getTextInputValue("sipUserAgentCapabilities");
            }
            
            function getSipDomainTextInputValue() 
            {
                return getTextInputValue("sipDomain");
            }

            function getSipDisplayNameTextInputValue() 
            {
                return getTextInputValue("sipDisplayName");
            }

            function getSipUserNameTextInputValue() 
            {
                return getTextInputValue("sipUserName"); 
            }

            function getSipLoginTextInputValue() 
            {
                return getTextInputValue("sipLogin");
            }

            function getSipPasswordTextInputValue() 
            {
                return getTextInputValue("sipPassword"); 
            }

            function getSipContactTextInputValue() 
            {
                return getTextInputValue("sipContact");
            }
            
            function getSipRegisterModeValue() 
            {
                return document.getElementById("sipRegistrationCkeckBox").checked;
            }
            
            function getAudioMediaValue() 
            {
                return document.getElementById("audioMediaCkeckBox").checked;
            }
            
            function getVideoMediaValue() 
            {
                return document.getElementById("videoMediaCkeckBox").checked;
            }
            
             
            function getDataMediaValue() 
            {
                return document.getElementById("dataMediaCkeckBox").checked;
            }
            
            function getAudioCodecsFilterTextInputValue() 
            {
                return getTextInputValue("audioCodecsFilter")
            }
            
            function getVideoCodecsFilterTextInputValue() 
            {
                return getTextInputValue("videoCodecsFilter")
            }
            
            function getLocalVideoFormatTextInputValue() 
            {
                return getTextInputValue("localVideoFormat")
            }
            
        </script>

    </head>
    <body onload='webRtcCommTestWebAppController.onLoadViewEventHandler();' onunload='webRtcCommTestWebAppController.onUnloadViewEventHandler();'>
        <a href="http://localhost:8080/WebRtcCommTestWebApp/?sipDomain=sip.test&sipLogin=&sipPassword=&sipUserName=alice&sipDisplayName=alice&sipContactUserName=bob">
            http://localhost:8080/WebRtcCommTestWebApp/?sipDomain=sip.test&sipLogin=&sipPassword=&sipUserName=alice&sipDisplayName=alice&sipContactUserName=bob
        </a>
        <div id="webRtcCommClientConfigurationDiv" >
            <br/>
            <label style="color:black; font-weight: bold">SIP Profile settings</label>
            <div style="border:black solid thin; width:700px " id="webRtcCommClientSipProfileConfigurationDiv"> 
                <div id='sipDisplayNameDiv'>
                    <label>SIP Display Name:</label>
                    <input id="sipDisplayName"  type="text" size="30" > 
                </div>
                <div id='sipUserNameDiv'>
                    <label>SIP User Name:</label>
                    <input id="sipUserName"  type="text" size="30"> 
                </div>
                <div id='sipLoginDiv'>
                    <label>SIP Login:</label>
                    <input id="sipLogin"   type="text" size="30"> 
                </div>
                <div id='sipPasswordDiv'>
                    <label>SIP Password:</label>
                    <input id="sipPassword"   type="text" size="30"> 
                </div>
                <div id='stunServerDiv'>
                    <label>STUN server:</label>
                    <input  id="stunServer"  type="text" size="40" >
                    <label style="color:red">Google public STUN server:stun.l.google.com:19302</label>
                </div>
                <div id='sipWsUrlDiv'>
                    <label>SIP outbound proxy WS URL:</label>
                    <input  id="sipOutboundProxy"  type="text" size="40"> 
                </div>
                <div id='sipUserAgentCapabilitiesDiv'>
                    <label>SIP User Agent Capabilities:</label>
                    <input id="sipUserAgentCapabilities"  type="text" size="30"> 
                </div> 
                <div id='sipDomainDiv'>
                    <label>SIP Domain:</label>
                    <input id="sipDomain"  type="text" size="30"> 
                </div>   
            </div> 
            <br/>
            <label style="color:black; font-weight:bold; ">Communication settings</label>
            <div style="border:black solid thin; width:1000px" id="webRtcCommClientSipCallConfigurationDiv" title="Call settings"  >
                <div id='sipContactPhoneNumberDiv'>
                    <label>SIP Contact phone number:</label>
                    <input id="sipContact"  type="text" size="30" > 
                </div>
                <div id='sipRegisterModeDiv'>
                    <label>SIP REGISTER required:</label>
                    <input  id='sipRegistrationCkeckBox' type="checkbox" checked name="sipRegistrationCkeckBox">
                </div>
                <div id='audioMediaDiv'>
                    <label>Audio media:</label>
                    <input  id='audioMediaCkeckBox' type="checkbox" checked>
                </div>
                <div id='videoMediaDiv'>
                    <label>Video media:</label>
                    <input  id='videoMediaCkeckBox' type="checkbox" checked >
                </div>
                <div id='dataMediaDiv'>
                    <label>Data media:</label>
                    <input  id='dataMediaCkeckBox' type="checkbox">
                    <label style="color:red">DATA CHANNEL NOT YET SUPPORTED</label>
                </div>
                <div id='audioCodecsFilterDiv'>
                    <label>Audio codecs filter (ordered by priority e.g. PCMU,PCMA,OPUS):</label>
                    <input id='audioCodecsFilter' type="text" size="30" >
                </div>
                <div id='videoCodecsFilterDiv'>
                    <label>Video codecs filter (ordered by priority e.g. VP8, H264):</label>
                    <input id='videoCodecsFilter' type="text" size="30" >
                </div>
                <div id='localVideoFormatDiv'>
                    <label>Local video format:</label>
                    <input id='localVideoFormat' type="text" size="100" onchange = "webRtcCommTestWebAppController.onChangeLocalVideoFormatViewEventHandler();">
                </div>
            </div> 
            <audio id="ringing" loop src="audio/ringing.wav" />
            <audio id="ringingBack" loop src="audio/ringing.wav" />
        </div>
        <br/>
        <div id='input'>
            <input id='connectButton'  type='button' disabled value='Connect' onclick = "webRtcCommTestWebAppController.onClickConnectButtonViewEventHandler();"/>
            <input id='disconnectButton'  type='button' value='Disconnect' disabled onclick = "webRtcCommTestWebAppController.onClickDisconnectButtonViewEventHandler();"/>
            <input id='callButton'  type='button' value='Call' disabled onclick = "webRtcCommTestWebAppController.onClickCallButtonViewEventHandler(getSipContactTextInputValue());"/>
            <input id='cancelCallButton'  type='button'  value='Cancel Call' disabled onclick = "webRtcCommTestWebAppController.onClickCancelCallButtonViewEventHandler();"/>
            <input id='acceptCallButton'  type='button' value='Accept Call' disabled onclick = "webRtcCommTestWebAppController.onClickAcceptCallButtonViewEventHandler();"/>
            <input id='rejectCallButton'  type='button' value='Reject Call' disabled onclick = "webRtcCommTestWebAppController.onClickRejectCallButtonViewEventHandler();"/>
            <input id='endCallButton'  type='button' value='End Call' disabled onclick = "webRtcCommTestWebAppController.onClickEndCallButtonViewEventHandler();"/>
            <label>Mute Local Audio:</label><input id='muteLocalAudioCheckBox' type="checkbox" onclick = "webRtcCommTestWebAppController.onClickMuteLocalAudioButtonViewEventHandler(this.checked);"/>
            <label>Hide Local Video:</label><input id='hideLocalVideoCheckBox' type="checkbox"  onclick = "webRtcCommTestWebAppController.onClickHideLocalVideoButtonViewEventHandler(this.checked);"/>
            <label>Mute Remote Audio:</label><input id='muteRemoteAudioCheckBox' type="checkbox" onclick = "webRtcCommTestWebAppController.onClickMuteRemoteAudioButtonViewEventHandler(this.checked);"/>
            <label>Hide Remote Video:</label><input id='hideRemoteVideoCheckBox' type="checkbox"  onclick = "webRtcCommTestWebAppController.onClickHideRemoteVideoButtonViewEventHandler(this.checked);"/>
            <input id='stopVideoStreamButton'  type='button' value='Stop video stream'  onclick = "webRtcCommTestWebAppController.onClickStopVideoStreamButtonViewEventHandler();"/>
        </div>
        <br/>
        <div id='media'>
            <div>
                <video id="localVideo" style="height: auto; width: auto"></video>  
                <video id="remoteVideo" style="height: auto; width: auto"></video>  
            </div>
        </div>
    </body>
</html>